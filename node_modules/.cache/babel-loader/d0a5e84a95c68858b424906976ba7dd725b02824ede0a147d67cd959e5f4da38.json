{"ast":null,"code":"import _objectSpread from\"C:/Users/willi/OneDrive/Desktop/projetos/caixa/meu-app-de-caixa/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/* global __app_id, __firebase_config, __initial_auth_token */import React,{useState,useEffect,useRef}from'react';import{initializeApp}from'firebase/app';import{getAuth,signInWithCustomToken,onAuthStateChanged,signOut}from'firebase/auth';import{getFirestore,collection,addDoc,onSnapshot,doc,updateDoc,deleteDoc,query,where,setDoc,getDoc}from'firebase/firestore';// URL base do seu backend Flask\n// ATENÇÃO: SUBSTITUA 'https://old-owl-williammzin-cd2d4d31.koyeb.app' PELA URL REAL DO SEU BACKEND KOYEB!\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const FLASK_BACKEND_URL='https://old-owl-williammzin-cd2d4d31.koyeb.app';// Temas padrão para o design da interface\nconst DEFAULT_THEMES={default:{gradient_from:'from-blue-50',gradient_to:'to-indigo-100',primary_button_bg:'bg-blue-600',primary_button_hover_bg:'hover:bg-blue-700',secondary_button_bg:'bg-gray-200',secondary_button_text:'text-gray-700',secondary_button_hover_bg:'hover:bg-gray-100',text_color_strong:'text-gray-800',text_color_medium:'text-gray-700',border_color:'border-blue-200',highlight_color:'text-blue-600',success_color:'bg-green-500',error_color:'bg-red-500',font_family:'font-sans',dominant_color:'bg-blue-50'// Usado para cabeçalhos de tabela, etc.\n},corporate:{gradient_from:'from-gray-100',gradient_to:'to-gray-200',primary_button_bg:'bg-purple-700',primary_button_hover_bg:'hover:bg-purple-800',secondary_button_bg:'bg-gray-300',secondary_button_text:'text-gray-800',secondary_button_hover_bg:'hover:bg-gray-400',text_color_strong:'text-gray-900',text_color_medium:'text-gray-700',border_color:'border-purple-300',highlight_color:'text-purple-700',success_color:'bg-green-600',error_color:'bg-red-600',font_family:'font-serif',dominant_color:'bg-purple-100'},vibrant:{gradient_from:'from-pink-100',gradient_to:'to-yellow-100',primary_button_bg:'bg-pink-500',primary_button_hover_bg:'hover:bg-pink-600',secondary_button_bg:'bg-yellow-200',secondary_button_text:'text-yellow-800',secondary_button_hover_bg:'hover:bg-yellow-300',text_color_strong:'text-purple-900',text_color_medium:'text-purple-700',border_color:'border-pink-300',highlight_color:'text-orange-500',success_color:'bg-lime-500',error_color:'bg-rose-500',font_family:'font-mono',dominant_color:'bg-pink-50'}};// Componente de Modal de Confirmação\nconst ConfirmModal=_ref=>{let{message,onConfirm,onCancel}=_ref;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-xl max-w-sm w-full text-center\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-lg font-semibold mb-6\",children:message}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-around\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:onConfirm,className:\"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200\",children:\"Confirmar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCancel,className:\"bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200\",children:\"Cancelar\"})]})]})});};// Componente Principal da Aplicação\nconst App=()=>{console.log(\"O componente App está sendo renderizado...\");// Estados para instâncias do Firebase\nconst[firebaseAuth,setFirebaseAuth]=useState(null);const[firestoreDb,setFirestoreDb]=useState(null);// ID da Aplicação do ambiente Canvas\nconst[appId,setAppId]=useState('local-app-id');// Estados para dados da loja\nconst[products,setProducts]=useState([]);const[sales,setSales]=useState([]);const[companies,setCompanies]=useState([]);// Apenas para o admin principal\nconst[companyUsers,setCompanyUsers]=useState([]);// Apenas para company_admin\n// Estados do carrinho e pagamento\nconst[cart,setCart]=useState([]);const[total,setTotal]=useState(0);const[paymentAmount,setPaymentAmount]=useState('');const[change,setChange]=useState(0);const[difference,setDifference]=useState(0);const[paymentMethod,setPaymentMethod]=useState('Dinheiro');// Estados para gerenciamento de produtos\nconst[newProductName,setNewProductName]=useState('');const[newProductValue,setNewProductValue]=useState('');const[newProductCost,setNewProductCost]=useState('');const[newProductId,setNewProductId]=useState('');const[editingProduct,setEditingProduct]=useState(null);const[searchTerm,setSearchTerm]=useState('');// Estados para autenticação e usuário atual\nconst[isLoggedIn,setIsLoggedIn]=useState(false);const[currentUser,setCurrentUser]=useState(null);// Armazena { username, role, company_name, design }\nconst[loginUsername,setLoginUsername]=useState('');const[loginPassword,setLoginPassword]=useState('');// Estados para registro de empresa (apenas para admin principal)\nconst[newCompanyUsername,setNewCompanyUsername]=useState('');const[newCompanyPassword,setNewCompanyPassword]=useState('');const[newCompanyName,setNewCompanyName]=useState('');const[newCompanyDesignTheme,setNewCompanyDesignTheme]=useState('default');const[newCompanyMercadoPagoAccessToken,setNewCompanyMercadoPagoAccessToken]=useState('');// Estados para gerenciamento de usuários da empresa (apenas para company_admin)\nconst[newCompanyUserUsername,setNewCompanyUserUsername]=useState('');const[newCompanyUserPassword,setNewCompanyUserPassword]=useState('');const[newCompanyUserRole,setNewCompanyUserRole]=useState('caixa');const[editingCompanyUser,setEditingCompanyUser]=useState(null);// Estados para funcionalidade Pix\nconst[pixQrCodeData,setPixQrCodeData]=useState(null);const[isLoadingPix,setIsLoadingPix]=useState(false);// Estados para controle de abas\nconst[activeTab,setActiveTab]=useState('caixa');// Estados para mensagens de feedback\nconst[message,setMessage]=useState('');const messageTimeoutRef=useRef(null);// Estados para o modal de confirmação\nconst[showConfirmModal,setShowConfirmModal]=useState(false);const[confirmModalMessage,setConfirmModalMessage]=useState('');const[confirmModalAction,setConfirmModalAction]=useState(null);const[confirmModalPayload,setConfirmModalPayload]=useState(null);// Novo estado para controlar status do Pix da venda atual\nconst[pixStatus,setPixStatus]=useState(null);// Função para exibir mensagens na interface\nconst showMessage=function(msg){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';setMessage({text:msg,type});if(messageTimeoutRef.current){clearTimeout(messageTimeoutRef.current);}messageTimeoutRef.current=setTimeout(()=>{setMessage('');},3000);};// Efeito para inicialização do Firebase e listener de autenticação\nuseEffect(()=>{console.log(\"useEffect: Inicialização do Firebase e Listener de Autenticação.\");let firebaseConfig=null;let currentAppId='local-app-id';// Tenta obter a configuração do ambiente Canvas\nif(typeof __firebase_config!=='undefined'&&typeof __app_id!=='undefined'){try{firebaseConfig=JSON.parse(__firebase_config);currentAppId=__app_id;console.log(\"Configuração do Firebase e ID do App carregados do ambiente Canvas.\");}catch(e){console.error(\"Erro ao fazer parse de __firebase_config:\",e);showMessage(\"Erro ao carregar a configuração do Firebase.\",\"error\");}}else{throw new Error(\"Firebase config não encontrada! Defina __firebase_config e __app_id no ambiente.\");}if(firebaseConfig){try{const app=initializeApp(firebaseConfig);const auth=getAuth(app);const db=getFirestore(app);setFirebaseAuth(auth);setFirestoreDb(db);setAppId(currentAppId);console.log(\"Firebase App, Auth e Firestore inicializados e definidos no estado.\");// Listener de mudança de estado de autenticação\nconst unsubscribe=onAuthStateChanged(auth,async user=>{console.log(\"Estado de autenticação do Firebase alterado. Usuário:\",user);if(user){try{const idTokenResult=await user.getIdTokenResult(true);const role=idTokenResult.claims.role;const companyName=idTokenResult.claims.company_name;const design=idTokenResult.claims.design;setCurrentUser({username:user.uid,// Usando UID como username para consistência com Flask\nrole:role,company_name:companyName,design:design});setIsLoggedIn(true);console.log(\"Usuário logado e estado currentUser atualizado:\",user.uid,role);}catch(claimsError){console.error(\"Erro ao obter custom claims do usuário:\",claimsError);showMessage(\"Erro ao recuperar detalhes do usuário. Por favor, tente fazer login novamente.\",\"error\");setIsLoggedIn(false);setCurrentUser(null);}}else{console.log(\"Nenhum usuário autenticado no Firebase.\");setIsLoggedIn(false);setCurrentUser(null);}});// Tenta fazer login com o token personalizado inicial do ambiente Canvas\nif(typeof __initial_auth_token!=='undefined'&&__initial_auth_token){signInWithCustomToken(auth,__initial_auth_token).then(()=>console.log(\"Login com token personalizado inicial bem-sucedido.\")).catch(error=>console.error(\"Erro ao fazer login com token personalizado inicial:\",error));}return()=>unsubscribe();// Limpeza do listener na desmontagem do componente\n}catch(e){console.error(\"Erro crítico ao inicializar o Firebase:\",e);showMessage(\"Erro crítico ao inicializar o Firebase. Por favor, verifique o console.\",\"error\");}}},[]);// Array de dependências vazio significa que este efeito é executado apenas uma vez na montagem\n// Efeito para listeners do Firestore (Produtos, Vendas, Usuários da Empresa, Empresas)\n// Depende de firestoreDb e currentUser para garantir que o Firebase esteja inicializado e o usuário logado\nuseEffect(()=>{console.log(\"useEffect: Listeners do Firestore acionados. firestoreDb:\",!!firestoreDb,\"currentUser:\",currentUser);if(!firestoreDb||!currentUser||!currentUser.username){console.log(\"Listeners do Firestore ignorados: DB não pronto ou currentUser não definido.\");setProducts([]);setSales([]);setCompanyUsers([]);setCompanies([]);return;}console.log(\"Tentando buscar dados do Firestore para o usuário:\",currentUser.username);let unsubscribeProducts;let unsubscribeSales;let unsubscribeCompanyUsers;let unsubscribeCompanies;// Listener de Produtos (para company_admin, gerente, caixa)\nif(['company_admin','gerente','caixa'].includes(currentUser.role)){const productsCollectionRef=collection(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/products\"));unsubscribeProducts=onSnapshot(productsCollectionRef,snapshot=>{console.log(\"Snapshot de Produtos do Firestore recebido.\");const productsData=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setProducts(productsData);console.log(\"Produtos carregados com sucesso!\");},error=>{console.error(\"Erro ao carregar produtos:\",error);showMessage(\"Erro ao carregar produtos do Firestore. Verifique as permissões.\",\"error\");});}else{setProducts([]);}// Listener de Vendas (para company_admin, gerente, caixa)\nif(['company_admin','gerente','caixa'].includes(currentUser.role)){const salesCollectionRef=collection(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\"));unsubscribeSales=onSnapshot(salesCollectionRef,snapshot=>{console.log(\"Snapshot de Vendas do Firestore recebido.\");const salesData=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setSales(salesData);console.log(\"Vendas carregadas com sucesso!\");},error=>{console.error(\"Erro ao carregar vendas:\",error);showMessage(\"Erro ao carregar vendas do Firestore. Verifique as permissões.\",\"error\");});}else{setSales([]);}// Listener de Usuários da Empresa (APENAS para company_admin)\nif(currentUser.role==='company_admin'){const companyUsersCollectionRef=collection(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/company_users\"));console.log(\"Caminho do Listener de Usuários da Empresa do Firestore:\",companyUsersCollectionRef.path);unsubscribeCompanyUsers=onSnapshot(companyUsersCollectionRef,snapshot=>{console.log(\"Snapshot de Usuários da Empresa do Firestore recebido.\");const usersData=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setCompanyUsers(usersData);console.log(\"Usuários da empresa carregados com sucesso!\",usersData);},error=>{console.error(\"Erro ao carregar usuários da empresa:\",error);showMessage(\"Erro ao carregar usuários da empresa do Firestore. Verifique as permissões.\",\"error\");});}else{setCompanyUsers([]);}// Listener para a lista de empresas (APENAS para o admin principal)\nif(currentUser.role==='admin'){const companiesCollectionRef=collection(firestoreDb,\"artifacts/\".concat(appId,\"/users\"));const q=query(companiesCollectionRef,where(\"role\",\"==\",\"company_admin\"));unsubscribeCompanies=onSnapshot(q,snapshot=>{console.log(\"Snapshot de Empresas do Firestore recebido.\");const companiesData=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setCompanies(companiesData);console.log(\"Empresas carregadas com sucesso!\");},error=>{console.error(\"Erro ao carregar empresas:\",error);showMessage(\"Erro ao carregar empresas do Firestore. Verifique as permissões.\",\"error\");});}else{setCompanies([]);}// Função de limpeza para cancelar as inscrições dos listeners\nreturn()=>{if(unsubscribeProducts)unsubscribeProducts();if(unsubscribeSales)unsubscribeSales();if(unsubscribeCompanyUsers)unsubscribeCompanyUsers();if(unsubscribeCompanies)unsubscribeCompanies();console.log(\"Listeners do Firestore para Produtos, Vendas, Usuários da Empresa e Empresas desinscritos.\");};},[firestoreDb,currentUser,appId]);// Depende de firestoreDb e currentUser\n// Efeito para calcular o total do carrinho\nuseEffect(()=>{const newTotal=cart.reduce((sum,item)=>sum+item.value*item.quantity,0);setTotal(newTotal);},[cart]);// Efeito para calcular troco/diferença de pagamento\nuseEffect(()=>{const paid=parseFloat(paymentAmount)||0;if(paid>=total){setChange(paid-total);setDifference(0);}else{setChange(0);setDifference(total-paid);}},[total,paymentAmount]);// Adiciona um produto ao carrinho\nconst addToCart=product=>{const existingItem=cart.find(item=>item.id===product.id);if(existingItem){setCart(cart.map(item=>item.id===product.id?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity+1}):item));}else{setCart([...cart,_objectSpread(_objectSpread({},product),{},{quantity:1})]);}showMessage(\"\".concat(product.name,\" adicionado ao carrinho!\"));};// Remove um produto do carrinho\nconst removeFromCart=productId=>{setCart(cart.filter(item=>item.id!==productId));showMessage(\"Item removido do carrinho.\",\"info\");};// Aumenta a quantidade de um item no carrinho\nconst increaseQuantity=productId=>{setCart(cart.map(item=>item.id===productId?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity+1}):item));};// Diminui a quantidade de um item no carrinho\nconst decreaseQuantity=productId=>{setCart(cart.map(item=>item.id===productId&&item.quantity>1?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity-1}):item).filter(item=>item.quantity>0));// Remove se a quantidade se tornar 0\n};// Finaliza uma venda (dinheiro, cartão ou Pix)\nconst finalizeSale=async()=>{if(cart.length===0){showMessage(\"O carrinho está vazio!\",\"error\");return;}if(!firestoreDb||!currentUser||!firebaseAuth){showMessage(\"Erro: Serviço de banco de dados ou autenticação não disponível.\",\"error\");return;}// Calcula o custo total dos produtos vendidos (CPV)\nconst costOfGoodsSold=cart.reduce((sum,item)=>sum+(item.cost||0)*item.quantity,0);// Prepara os dados básicos da venda\nconst baseSaleData={items:cart.map(item=>({productId:item.id,name:item.name,value:item.value,cost:item.cost||0,quantity:item.quantity})),total:total,costOfGoodsSold:costOfGoodsSold,profit:total-costOfGoodsSold,paymentMethod:paymentMethod,paymentAmount:parseFloat(paymentAmount)||0,change:change,timestamp:new Date(),userId:currentUser.username};let saleId=null;// Para armazenar o ID da venda gerado\ntry{// Lógica para pagamento Pix\nif(paymentMethod==='Pix'){setIsLoadingPix(true);setPixQrCodeData(null);// Limpa dados Pix anteriores\n// 1. Gera um ID de venda único ANTES de qualquer chamada ao backend\nsaleId=doc(collection(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\"))).id;// 2. Cria o documento de venda no Firestore com status 'pending'\n// Isso garante que o documento exista para ser atualizado pelo webhook\nconst pixSaleData=_objectSpread(_objectSpread({},baseSaleData),{},{status:'pending',// Status inicial para Pix\npayment_id:null,// Será preenchido após a resposta do MP\nsale_id_frontend:saleId// Salva o ID gerado no frontend\n});await setDoc(doc(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\"),saleId),pixSaleData);showMessage(\"Iniciando pagamento Pix. Aguardando QR Code...\",\"info\");// Obtém o ID Token do usuário Firebase logado\nconst idToken=await firebaseAuth.currentUser.getIdToken();const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/pix/generate\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)},body:JSON.stringify({amount:total.toFixed(2),description:\"Pagamento de Venda\",company_username:currentUser.username,sale_id:saleId})});const data=await response.json();if(response.ok){// Adiciona o prefixo data:image/png;base64, se não estiver presente\nif(data.qr_code_base64&&!data.qr_code_base64.startsWith('data:image/png;base64,')){data.qr_code_base64='data:image/png;base64,'+data.qr_code_base64;}setPixQrCodeData(data);showMessage(\"QR Code Pix gerado com sucesso! Aguardando pagamento...\",\"success\");// 3. Atualiza o documento de venda no Firestore com o payment_id do Mercado Pago\n// Isso é crucial para o webhook encontrar e atualizar\nawait updateDoc(doc(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\"),saleId),{payment_id:data.payment_id// Salva o ID de pagamento do Mercado Pago\n});// Não limpa o carrinho aqui, pois a venda ainda está pendente.\n// O carrinho será limpo quando o webhook confirmar o pagamento.\n}else{// Se a geração do Pix falhar, remove a venda pendente criada\nif(saleId){await deleteDoc(doc(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\"),saleId));}showMessage(\"Erro ao gerar Pix: \".concat(data.error||'Erro desconhecido'),\"error\");}}else{// Lógica para Dinheiro e Cartão (não-Pix)\n// Adiciona a venda diretamente ao Firestore com status 'completed'\nconst finalSaleData=_objectSpread(_objectSpread({},baseSaleData),{},{status:'completed'// Status final para Dinheiro/Cartão\n});await addDoc(collection(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\")),finalSaleData);showMessage(\"Venda finalizada com sucesso!\");}// Limpa o carrinho e redefine os estados APENAS se a venda não for Pix ou se o Pix foi gerado com sucesso\nif(paymentMethod!=='Pix'||paymentMethod==='Pix'&&pixQrCodeData){setCart([]);setPaymentAmount('');setChange(0);setDifference(0);setPaymentMethod('Dinheiro');setPixQrCodeData(null);}}catch(e){console.error(\"Erro ao finalizar venda ou gerar Pix:\",e);showMessage(\"Erro ao finalizar venda ou gerar Pix.\",\"error\");// Se a venda foi criada mas o Pix falhou, tenta removê-la\nif(saleId&&paymentMethod==='Pix'){try{await deleteDoc(doc(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\"),saleId));}catch(deleteError){console.error(\"Erro ao remover venda pendente após falha na geração do Pix:\",deleteError);}}}finally{setIsLoadingPix(false);}};// Funções de Gerenciamento de Produtos\nconst handleAddProduct=async()=>{if(!newProductName||!newProductValue||!newProductId||newProductCost===''){showMessage(\"Preencha todos os campos do produto!\",\"error\");return;}if(isNaN(parseFloat(newProductValue))||isNaN(parseFloat(newProductCost))){showMessage(\"Valor e custo do produto devem ser números!\",\"error\");return;}if(!firestoreDb||!currentUser){showMessage(\"Erro: Banco de dados ou usuário não disponível.\",\"error\");return;}const productData={name:newProductName,value:parseFloat(newProductValue),cost:parseFloat(newProductCost)};try{// Referência ao documento com o ID fornecido pelo usuário\nconst productDocRef=doc(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/products\"),newProductId);const docSnap=await getDoc(productDocRef);// Verifica se o documento já existe\nif(docSnap.exists()){showMessage(\"ID do produto já existe! Escolha um ID único.\",\"error\");return;}// Usa setDoc para criar um documento com o ID fornecido pelo usuário\nawait setDoc(productDocRef,productData);showMessage(\"Produto adicionado com sucesso!\");setNewProductName('');setNewProductValue('');setNewProductCost('');setNewProductId('');}catch(e){console.error(\"Erro ao adicionar produto: \",e);showMessage(\"Erro ao adicionar produto.\",\"error\");}};const handleEditProduct=product=>{setEditingProduct(product);setNewProductName(product.name);setNewProductValue(product.value.toString());setNewProductCost(product.cost?product.cost.toString():'');setNewProductId(product.id);// Mantém o ID para exibição, mas não é editável\n};const handleUpdateProduct=async()=>{if(!editingProduct||!newProductName||!newProductValue||newProductCost===''){showMessage(\"Preencha todos os campos para atualizar!\",\"error\");return;}if(isNaN(parseFloat(newProductValue))||isNaN(parseFloat(newProductCost))){showMessage(\"Valor e custo do produto devem ser números!\",\"error\");return;}if(!firestoreDb||!currentUser){showMessage(\"Erro: Banco de dados ou usuário não disponível.\",\"error\");return;}const productRef=doc(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/products\"),editingProduct.id);try{await updateDoc(productRef,{name:newProductName,value:parseFloat(newProductValue),cost:parseFloat(newProductCost)});showMessage(\"Produto atualizado com sucesso!\");setEditingProduct(null);setNewProductName('');setNewProductValue('');setNewProductCost('');setNewProductId('');}catch(e){console.error(\"Erro ao atualizar produto: \",e);showMessage(\"Erro ao atualizar produto.\",\"error\");}};const handleDeleteProduct=async productId=>{if(!firestoreDb||!currentUser){showMessage(\"Erro: Banco de dados ou usuário não disponível.\",\"error\");setShowConfirmModal(false);return;}setConfirmModalMessage(\"Tem certeza que deseja excluir o produto com ID: \".concat(productId,\"?\"));setConfirmModalAction(()=>async()=>{try{const docRef=doc(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/products\"),productId);await deleteDoc(docRef);showMessage(\"Produto excluído com sucesso!\");}catch(e){console.error(\"Erro ao excluir produto:\",e);if(e.code==='permission-denied'){showMessage(\"Erro de permissão: Você não está autorizado a excluir este produto. Verifique as permissões.\",\"error\");}else{showMessage(\"Erro ao excluir produto.\",\"error\");}}finally{setShowConfirmModal(false);}});setConfirmModalPayload(productId);setShowConfirmModal(true);};const cancelEdit=()=>{setEditingProduct(null);setNewProductName('');setNewProductValue('');setNewProductCost('');setNewProductId('');};// Calcula o relatório de vendas semanal\nconst getWeeklySales=()=>{const oneWeekAgo=new Date();oneWeekAgo.setDate(oneWeekAgo.getDate()-7);const weeklySales=sales.filter(sale=>{// Garante que o timestamp existe e é um Firestore Timestamp\nif(sale.timestamp&&typeof sale.timestamp.toDate==='function'){const saleDate=sale.timestamp.toDate();return saleDate>=oneWeekAgo;}return false;});const salesByDay={};weeklySales.forEach(sale=>{const saleDate=sale.timestamp.toDate().toLocaleDateString('pt-BR');// Soma o lucro em vez do total\nif(!salesByDay[saleDate]){salesByDay[saleDate]=0;}salesByDay[saleDate]+=sale.profit||sale.total-(sale.costOfGoodsSold||0);// Garante que o lucro seja calculado se não salvo\n});// Ordena por data para exibição\nconst sortedSales=Object.entries(salesByDay).sort((_ref2,_ref3)=>{let[dateA]=_ref2;let[dateB]=_ref3;const[dayA,monthA,yearA]=dateA.split('/').map(Number);const[dayB,monthB,yearB]=dateB.split('/').map(Number);const dateObjA=new Date(yearA,monthA-1,dayA);const dateObjB=new Date(yearB,monthB-1,dayB);return dateObjA-dateObjB;});return sortedSales;};// --- Funções de Autenticação do Backend Flask ---\nconst handleLogin=async e=>{e.preventDefault();console.log(\"Tentando login...\");if(!firebaseAuth){showMessage(\"A autenticação do Firebase não foi inicializada.\",\"error\");return;}try{const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/login\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:loginUsername,password:loginPassword})});const data=await response.json();console.log(\"Dados da resposta de login:\",data);if(response.ok){const firebaseToken=data.firebase_token;if(firebaseToken){try{await signInWithCustomToken(firebaseAuth,firebaseToken);showMessage(\"Login bem-sucedido! Bem-vindo(a), \".concat(data.username,\".\"),'success');// O estado currentUser será atualizado pelo listener onAuthStateChanged\nsetLoginPassword('');// Redireciona para a aba apropriada após o login\nif(data.role==='admin'){setActiveTab('gerenciar_empresas');}else{setActiveTab('caixa');}}catch(firebaseError){console.error(\"Erro ao autenticar com o token personalizado do Firebase:\",firebaseError);showMessage(\"Erro ao conectar ao Firebase: \".concat(firebaseError.message),'error');setIsLoggedIn(false);setCurrentUser(null);}}else{showMessage(\"Erro: Token do Firebase não recebido do backend.\",\"error\");console.error(\"Token do Firebase ausente na resposta do Flask. Dados completos:\",data);}}else{showMessage(\"Erro de login: \".concat(data.error||'Credenciais inválidas'),'error');}}catch(error){console.error('Erro ao conectar ao backend para login:',error);showMessage('Erro ao conectar ao servidor. Verifique se o backend está em execução.','error');}};const handleLogout=async()=>{console.log(\"Tentando logout...\");if(!firebaseAuth){showMessage(\"A autenticação do Firebase não foi inicializada.\",\"error\");return;}// Redefine os estados que controlam os listeners ANTES de fazer logout do Firebase Auth\nsetIsLoggedIn(false);setCurrentUser(null);setLoginUsername('');setLoginPassword('');setCart([]);setProducts([]);setSales([]);setCompanies([]);setCompanyUsers([]);setPixQrCodeData(null);// Limpa dados do Pix ao sair\ntry{await signOut(firebaseAuth);// Faz logout do Firebase Auth\nshowMessage(\"Você foi desconectado(a).\",\"info\");setActiveTab('caixa');// Retorna para a aba padrão após o logout\nconsole.log(\"Logout bem-sucedido.\");}catch(error){console.error(\"Erro ao fazer logout do Firebase:\",error);showMessage(\"Erro ao desconectar.\",\"error\");}};// --- Funções de Gerenciamento de Empresas (para o admin principal) ---\nconst handleRegisterCompany=async e=>{e.preventDefault();if(!newCompanyUsername||!newCompanyPassword||!newCompanyName){showMessage(\"Preencha todos os campos para registrar a empresa!\",\"error\");return;}console.log(\"Tentando registrar empresa...\");try{const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/register_company\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:newCompanyUsername,password:newCompanyPassword,company_name:newCompanyName,design_theme:newCompanyDesignTheme,mercado_pago_access_token:newCompanyMercadoPagoAccessToken})});const data=await response.json();console.log(\"Dados da resposta de registro de empresa:\",data);if(response.ok){showMessage(\"Empresa \\\"\".concat(data.company_name,\"\\\" (Usu\\xE1rio: \").concat(data.username,\") registrada com sucesso!\"),'success');setNewCompanyUsername('');setNewCompanyPassword('');setNewCompanyName('');setNewCompanyDesignTheme('default');setNewCompanyMercadoPagoAccessToken('');}else{showMessage(\"Erro ao registrar empresa: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(error){console.error('Erro ao conectar ao backend para registrar empresa:',error);showMessage('Erro ao conectar ao servidor para registrar empresa.','error');}};// Função para excluir uma empresa (login)\nconst handleDeleteCompany=async companyIdToDelete=>{if(!firebaseAuth||!firebaseAuth.currentUser){showMessage(\"Erro: Usuário não autenticado.\",\"error\");setShowConfirmModal(false);return;}setConfirmModalMessage(\"Tem certeza que deseja excluir a empresa \".concat(companyIdToDelete,\" e TODOS os seus dados (produtos, vendas, etc.)? Esta a\\xE7\\xE3o \\xE9 irrevers\\xEDvel!\"));setConfirmModalAction(()=>async()=>{console.log(\"Tentando excluir empresa:\",companyIdToDelete);try{const idToken=await firebaseAuth.currentUser.getIdToken();const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/delete_company\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)},body:JSON.stringify({company_username:companyIdToDelete})});const data=await response.json();console.log(\"Dados da resposta de exclusão de empresa:\",data);if(response.ok){showMessage(\"Empresa \\\"\".concat(companyIdToDelete,\"\\\" exclu\\xEDda com sucesso!\"),'success');}else{showMessage(\"Erro ao excluir empresa: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(error){console.error('Erro ao conectar ao backend para excluir empresa:',error);showMessage('Erro ao conectar ao servidor para excluir empresa.','error');}finally{setShowConfirmModal(false);}});setConfirmModalPayload(companyIdToDelete);setShowConfirmModal(true);};// --- Funções de Gerenciamento de Usuários da Empresa (para company_admin) ---\nconst handleAddCompanyUser=async e=>{e.preventDefault();if(!newCompanyUserUsername||!newCompanyUserPassword||!newCompanyUserRole){showMessage(\"Preencha todos os campos para adicionar o usuário!\",\"error\");return;}if(!currentUser||!currentUser.username||!firebaseAuth||!firebaseAuth.currentUser){showMessage(\"Erro: Administrador da empresa não identificado ou não autenticado.\",\"error\");return;}console.log(\"Tentando adicionar usuário da empresa...\");try{const idToken=await firebaseAuth.currentUser.getIdToken();const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/company_users/add\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)},body:JSON.stringify({company_id:currentUser.username,username:newCompanyUserUsername,password:newCompanyUserPassword,role:newCompanyUserRole})});const data=await response.json();console.log(\"Dados da resposta de adição de usuário da empresa:\",data);if(response.ok){showMessage(\"Usu\\xE1rio \\\"\".concat(data.username,\"\\\" (\").concat(data.role,\") adicionado com sucesso!\"),'success');setNewCompanyUserUsername('');setNewCompanyUserPassword('');setNewCompanyUserRole('caixa');}else{showMessage(\"Erro ao adicionar usu\\xE1rio: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(e){console.error(\"Erro ao adicionar usuário da empresa: \",e);showMessage(\"Erro ao conectar ao servidor para adicionar usuário.\",\"error\");}};const handleEditCompanyUser=user=>{setEditingCompanyUser(user);setNewCompanyUserUsername(user.username);setNewCompanyUserRole(user.role);setNewCompanyUserPassword('');// Não carrega a senha por segurança\n};const handleUpdateCompanyUser=async e=>{e.preventDefault();if(!editingCompanyUser||!newCompanyUserUsername||!newCompanyUserRole){showMessage(\"Preencha todos os campos para atualizar o usuário!\",\"error\");return;}if(!currentUser||!currentUser.username||!firebaseAuth||!firebaseAuth.currentUser){showMessage(\"Erro: Administrador da empresa não identificado ou não autenticado.\",\"error\");return;}console.log(\"Tentando atualizar usuário da empresa:\",editingCompanyUser.id);try{const idToken=await firebaseAuth.currentUser.getIdToken();const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/company_users/update\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)},body:JSON.stringify({company_id:currentUser.username,user_id:editingCompanyUser.id,// O ID do documento do usuário no Firestore (que é o firebase_uid)\nusername:newCompanyUserUsername,password:newCompanyUserPassword||null,// Envia null se a senha não for alterada\nrole:newCompanyUserRole})});const data=await response.json();console.log(\"Dados da resposta de atualização de usuário da empresa:\",data);if(response.ok){showMessage(\"Usu\\xE1rio \\\"\".concat(data.username,\"\\\" atualizado com sucesso!\"),'success');setEditingCompanyUser(null);setNewCompanyUserUsername('');setNewCompanyUserPassword('');setNewCompanyUserRole('caixa');}else{showMessage(\"Erro ao atualizar usu\\xE1rio: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(e){console.error(\"Erro ao atualizar usuário da empresa: \",e);showMessage(\"Erro ao conectar ao servidor para atualizar usuário.\",\"error\");}};const handleDeleteCompanyUser=async userIdToDelete=>{if(!currentUser||!currentUser.username||!firebaseAuth||!firebaseAuth.currentUser){showMessage(\"Erro: Administrador da empresa não identificado ou não autenticado.\",\"error\");setShowConfirmModal(false);return;}setConfirmModalMessage(\"Tem certeza que deseja excluir o usu\\xE1rio \".concat(userIdToDelete,\"? Esta a\\xE7\\xE3o \\xE9 irrevers\\xEDvel!\"));setConfirmModalAction(()=>async()=>{console.log(\"Tentando excluir usuário da empresa:\",userIdToDelete);try{const idToken=await firebaseAuth.currentUser.getIdToken();const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/company_users/delete\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)},body:JSON.stringify({company_id:currentUser.username,user_id:userIdToDelete// O ID do documento do usuário no Firestore (que é o firebase_uid)\n})});const data=await response.json();console.log(\"Dados da resposta de exclusão de usuário da empresa:\",data);if(response.ok){showMessage(\"Usu\\xE1rio \\\"\".concat(userIdToDelete,\"\\\" exclu\\xEDdo com sucesso!\"),'success');}else{showMessage(\"Erro ao excluir usu\\xE1rio: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(e){console.error(\"Erro ao excluir usuário da empresa:\",e);showMessage(\"Erro ao conectar ao servidor para excluir usuário.\",\"error\");}finally{setShowConfirmModal(false);}});setConfirmModalPayload(userIdToDelete);setShowConfirmModal(true);};const cancelEditCompanyUser=()=>{setEditingCompanyUser(null);setNewCompanyUserUsername('');setNewCompanyUserPassword('');setNewCompanyUserRole('caixa');};// Função para copiar a chave Pix para a área de transferência\nconst copyPixKeyToClipboard=key=>{// Usa document.execCommand('copy') para compatibilidade em iframes\nconst el=document.createElement('textarea');el.value=key;document.body.appendChild(el);el.select();try{document.execCommand('copy');showMessage(\"Chave Pix copiada!\",\"success\");}catch(err){console.error('Erro ao copiar chave Pix:',err);showMessage(\"Falha ao copiar chave Pix.\",\"error\");}document.body.removeChild(el);};// Função para cancelar pagamento Pix\nconst handleCancelPixPayment=async paymentId=>{if(!currentUser||!currentUser.username||!firebaseAuth||!firebaseAuth.currentUser){showMessage(\"Erro: Usuário da empresa não identificado para cancelar Pix.\",\"error\");setShowConfirmModal(false);return;}setConfirmModalMessage(\"Tem certeza que deseja cancelar o pagamento Pix com ID \".concat(paymentId,\"?\"));setConfirmModalAction(()=>async()=>{console.log(\"Tentando cancelar pagamento Pix:\",paymentId);try{const idToken=await firebaseAuth.currentUser.getIdToken();const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/pix/cancel\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)},body:JSON.stringify({payment_id:paymentId,company_username:currentUser.username})});const data=await response.json();console.log(\"Dados da resposta de cancelamento de Pix:\",data);if(response.ok){showMessage(\"Pagamento Pix \".concat(paymentId,\" cancelado com sucesso!\"),'success');// Opcional: Atualizar o status da venda no Firestore no frontend, se necessário\n// Ou confiar no webhook do Mercado Pago para fazer isso\n}else{showMessage(\"Erro ao cancelar Pix: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(error){console.error('Erro ao conectar ao servidor para cancelar Pix:',error);showMessage('Erro ao conectar ao servidor para cancelar Pix.',\"error\");}finally{setShowConfirmModal(false);}});setConfirmModalPayload(paymentId);setShowConfirmModal(true);};// Filtra produtos com base no termo de pesquisa\nconst filteredProducts=products.filter(product=>product.name.toLowerCase().includes(searchTerm.toLowerCase())||product.id.toLowerCase().includes(searchTerm.toLowerCase()));// Função auxiliar para obter classes Tailwind de forma segura com base no tema\nconst getThemeClasses=element=>{const theme=(currentUser===null||currentUser===void 0?void 0:currentUser.design)||DEFAULT_THEMES.default;const getColorClass=(prop,defaultColor)=>{const color=theme[prop];if(color&&typeof color==='string'&&color.includes('-')){return color;// Já é uma classe Tailwind completa como 'bg-blue-500'\n}// Fallback para uma classe de cor Tailwind padrão\nreturn defaultColor;};switch(element){case'gradient_bg':return\"bg-gradient-to-br \".concat(getColorClass('gradient_from','from-blue-50'),\" \").concat(getColorClass('gradient_to','to-indigo-100'));case'primary_button_bg':return getColorClass('primary_button_bg','bg-blue-600');case'primary_button_hover_bg':return getColorClass('primary_button_hover_bg','hover:bg-blue-700');case'secondary_button_bg':return getColorClass('secondary_button_bg','bg-gray-200');case'secondary_button_text':return getColorClass('secondary_button_text','text-gray-700');case'secondary_button_hover_bg':return getColorClass('secondary_button_hover_bg','hover:bg-gray-100');case'text_color_strong':return getColorClass('text_color_strong','text-gray-800');case'text_color_medium':return getColorClass('text_color_medium','text-gray-700');case'border_color':return getColorClass('border_color','border-blue-200');case'highlight_color':return getColorClass('highlight_color','text-blue-600');case'success_color':return getColorClass('success_color','bg-green-500');case'error_color':return getColorClass('error_color','bg-red-500');case'font_family':return theme.font_family||'font-sans';case'dominant_color_bg':return getColorClass('dominant_color','bg-blue-50');default:return'';}};// Efeito para escutar atualizações do status Pix da venda pendente\nuseEffect(()=>{if(firestoreDb&&currentUser&&pixQrCodeData&&pixQrCodeData.sale_id_frontend// O sale_id gerado no frontend\n){// Referência ao documento da venda Pix pendente\nconst saleDocRef=doc(firestoreDb,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\"),pixQrCodeData.sale_id_frontend);// Listener para o documento da venda Pix\nconst unsubscribe=onSnapshot(saleDocRef,docSnap=>{if(docSnap.exists()){const saleData=docSnap.data();if(saleData.status!==pixStatus){setPixStatus(saleData.status);// Notifica o usuário sobre a mudança de status\nif(saleData.status==='approved'){showMessage('Pagamento Pix aprovado! Venda finalizada.','success');// Limpa carrinho e estados relacionados\nsetCart([]);setPaymentAmount('');setChange(0);setDifference(0);setPaymentMethod('Dinheiro');setPixQrCodeData(null);setPixStatus(null);}else if(saleData.status==='cancelled'){showMessage('Pagamento Pix cancelado.','error');setPixQrCodeData(null);setPixStatus(null);}else if(saleData.status==='pending'){showMessage('Aguardando pagamento Pix...','info');}}}});return()=>unsubscribe();}// eslint-disable-next-line react-hooks/exhaustive-deps\n},[firestoreDb,currentUser,pixQrCodeData]);// Renderiza a tela de login se o usuário não estiver logado\nif(!isLoggedIn){return/*#__PURE__*/_jsxs(\"div\",{className:\"relative min-h-screen flex flex-col items-center justify-center overflow-hidden bg-gray-800\",children:[/*#__PURE__*/_jsx(\"video\",{autoPlay:true,loop:true,muted:true,playsInline:true,className:\"absolute z-0 w-full h-full object-cover\",src:\"https://videos.pexels.com/video-files/3752548/3752548-hd_1920_1080_24fps.mp4\",onError:e=>console.error(\"Erro ao carregar o vídeo de fundo da tela de login:\",e),children:\"Seu navegador n\\xE3o suporta a tag de v\\xEDdeo.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-10 w-full h-full bg-black opacity-50\"}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed top-4 right-4 p-3 rounded-lg shadow-lg text-white z-50 transition-opacity duration-300 \".concat(message.type==='success'?getThemeClasses('success_color'):getThemeClasses('error_color')),children:message.text}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative z-20 bg-white p-8 rounded-2xl shadow-xl w-full max-w-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-6 text-center\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLogin,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"loginUsername\",children:\"Nome de Usu\\xE1rio:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",id:\"loginUsername\",type:\"text\",placeholder:\"Nome de Usu\\xE1rio\",value:loginUsername,onChange:e=>setLoginUsername(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"loginPassword\",children:\"Senha:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline\",id:\"loginPassword\",type:\"password\",placeholder:\"********\",value:loginPassword,onChange:e=>setLoginPassword(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition-colors duration-200\",type:\"submit\",children:\"Entrar\"})})]})]})]});}// Renderiza a aplicação principal se o usuário estiver logado\nconst currentDesign=(currentUser===null||currentUser===void 0?void 0:currentUser.design)||DEFAULT_THEMES.default;// Garante que currentDesign não seja nulo\n// Determina se o vídeo de fundo da aba \"Gerenciar Empresas\" deve estar ativo\nconst showCompanyManagementVideo=isLoggedIn&&activeTab==='gerenciar_empresas'&&(currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin';// Define o estilo de fundo dinamicamente (cores/gradiente)\nconst backgroundClasses=currentDesign.dominant_color?\"\".concat(currentDesign.dominant_color):\"\".concat(currentDesign.gradient_from||'from-blue-50',\" \").concat(currentDesign.gradient_to||'to-indigo-100');return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen p-4 \".concat(getThemeClasses('font_family'),\" flex flex-col items-center relative\"),children:[showCompanyManagementVideo?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"video\",{autoPlay:true,loop:true,muted:true,playsInline:true,className:\"absolute z-0 w-full h-full object-cover top-0 left-0\",src:\"https://videos.pexels.com/video-files/30163656/12934691_1920_1080_30fps.mp4\",onError:e=>console.error(\"Erro ao carregar o vídeo de fundo de Gerenciar Empresas:\",e),children:\"Seu navegador n\\xE3o suporta a tag de v\\xEDdeo para o fundo de gerenciamento de empresas.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-10 w-full h-full bg-black opacity-50 top-0 left-0\"})]}):/*#__PURE__*/// Fundo de cor/gradiente para as outras abas\n_jsx(\"div\",{className:\"absolute z-0 w-full h-full top-0 left-0 \".concat(backgroundClasses)}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative z-20 w-full flex flex-col items-center\",children:[currentUser&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-4 left-4 bg-white p-2 rounded-lg shadow-md text-sm text-gray-700\",children:[\"Usu\\xE1rio Logado: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:currentUser.username}),\" (Fun\\xE7\\xE3o: \",currentUser.role,\")\",currentUser.company_name&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2\",children:[\"Empresa: \",currentUser.company_name]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"ml-4 bg-red-500 hover:bg-red-600 text-white text-xs px-2 py-1 rounded-full transition-colors duration-200\",children:\"Sair\"})]}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed top-4 right-4 p-3 rounded-lg shadow-lg text-white z-50 transition-opacity duration-300 \".concat(message.type==='success'?getThemeClasses('success_color'):getThemeClasses('error_color')),children:message.text}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-extrabold \".concat(getThemeClasses('text_color_strong'),\" mb-8 mt-4 rounded-xl p-3 bg-white shadow-lg\"),children:\"Gerenciador de Caixa\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4 mb-8 bg-white p-2 rounded-full shadow-md\",children:[(currentUser.role==='company_admin'||currentUser.role==='gerente'||currentUser.role==='caixa')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('caixa'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='caixa'?\"\".concat(getThemeClasses('primary_button_bg'),\" text-white shadow-lg\"):\"\".concat(getThemeClasses('secondary_button_bg'),\" \").concat(getThemeClasses('secondary_button_text'),\" \").concat(getThemeClasses('secondary_button_hover_bg'))),children:\"Caixa\"}),(currentUser.role==='company_admin'||currentUser.role==='gerente')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('produtos'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='produtos'?\"\".concat(getThemeClasses('primary_button_bg'),\" text-white shadow-lg\"):\"\".concat(getThemeClasses('secondary_button_bg'),\" \").concat(getThemeClasses('secondary_button_text'),\" \").concat(getThemeClasses('secondary_button_hover_bg'))),children:\"Produtos\"}),(currentUser.role==='company_admin'||currentUser.role==='gerente')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('relatorios'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='relatorios'?\"\".concat(getThemeClasses('primary_button_bg'),\" text-white shadow-lg\"):\"\".concat(getThemeClasses('secondary_button_bg'),\" \").concat(getThemeClasses('secondary_button_text'),\" \").concat(getThemeClasses('secondary_button_hover_bg'))),children:\"Relat\\xF3rios\"}),currentUser.role==='company_admin'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('gerenciar_usuarios'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='gerenciar_usuarios'?\"\".concat(getThemeClasses('primary_button_bg'),\" text-white shadow-lg\"):\"\".concat(getThemeClasses('secondary_button_bg'),\" \").concat(getThemeClasses('secondary_button_text'),\" \").concat(getThemeClasses('secondary_button_hover_bg'))),children:\"Gerenciar Usu\\xE1rios\"}),currentUser.role==='admin'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('gerenciar_empresas'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='gerenciar_empresas'?\"\".concat(getThemeClasses('primary_button_bg'),\" text-white shadow-lg\"):\"\".concat(getThemeClasses('secondary_button_bg'),\" \").concat(getThemeClasses('secondary_button_text'),\" \").concat(getThemeClasses('secondary_button_hover_bg'))),children:\"Gerenciar Empresas\"})]}),activeTab==='caixa'&&(currentUser.role==='company_admin'||currentUser.role==='gerente'||currentUser.role==='caixa')&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8 w-full max-w-7xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-1 bg-white p-6 rounded-2xl shadow-xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mb-4 pb-2 border-b-2 \").concat(getThemeClasses('border_color')),children:\"Produtos Dispon\\xEDveis\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Pesquisar produto por nome ou ID...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:filteredProducts.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhum produto encontrado ou registrado.\"}):filteredProducts.map(product=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center bg-gray-50 p-3 mb-2 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold \".concat(getThemeClasses('text_color_strong')),children:[product.name,\" (ID: \",product.id,\")\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"\".concat(getThemeClasses('highlight_color'),\" font-bold\"),children:[\"R$ \",product.value.toFixed(2)]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addToCart(product),className:\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Adicionar\"})]},product.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 bg-white p-6 rounded-2xl shadow-xl flex flex-col\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mb-4 pb-2 border-b-2 \").concat(getThemeClasses('border_color')),children:\"Carrinho de Compras\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-grow max-h-80 overflow-y-auto mb-4\",children:cart.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"O carrinho est\\xE1 vazio.\"}):cart.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center bg-gray-50 p-3 mb-2 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold \".concat(getThemeClasses('text_color_strong')),children:item.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"R$ \",item.value.toFixed(2),\" x \",item.quantity]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>decreaseQuantity(item.id),className:\"bg-red-400 hover:bg-red-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold\",children:\"-\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-lg\",children:item.quantity}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>increaseQuantity(item.id),className:\"bg-green-400 hover:bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold\",children:\"+\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFromCart(item.id),className:\"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-full text-sm shadow-md\",children:\"Remover\"})]})]},item.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-auto pt-4 border-t-2 \".concat(getThemeClasses('border_color')),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center text-2xl font-bold \".concat(getThemeClasses('text_color_strong'),\" mb-4\"),children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"R$ \",total.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"paymentMethod\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" text-lg font-semibold mb-2\"),children:\"M\\xE9todo de Pagamento:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"paymentMethod\",value:paymentMethod,onChange:e=>{setPaymentMethod(e.target.value);setPixQrCodeData(null);// Limpa dados do Pix ao mudar o método\n},className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Dinheiro\",children:\"Dinheiro\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cartao\",children:\"Cart\\xE3o\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Pix\",children:\"Pix\"})]})]}),paymentMethod==='Dinheiro'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"paymentAmount\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" text-lg font-semibold mb-2\"),children:\"Valor Pago:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"paymentAmount\",value:paymentAmount,onChange:e=>setPaymentAmount(e.target.value),placeholder:\"R$ 0.00\",step:\"0.01\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg\"})]}),paymentMethod==='Pix'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200 text-yellow-800\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:\"Funcionalidade Pix:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Para gerar o QR Code Pix, o aplicativo far\\xE1 uma requisi\\xE7\\xE3o ao seu backend Flask.\"}),pixStatus&&/*#__PURE__*/_jsxs(\"div\",{className:\"my-2\",children:[pixStatus==='pending'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-600 font-semibold\",children:\"Status: Aguardando pagamento...\"}),pixStatus==='approved'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 font-semibold\",children:\"Status: Pagamento aprovado!\"}),pixStatus==='cancelled'&&/*#__PURE__*/_jsx(\"span\",{className:\"text-red-600 font-semibold\",children:\"Status: Pagamento cancelado.\"})]}),isLoadingPix?/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center py-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500\"}),/*#__PURE__*/_jsx(\"p\",{className:\"ml-3\",children:\"Gerando QR Code...\"})]}):pixQrCodeData?/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:pixQrCodeData.qr_code_base64||\"https://placehold.co/150x150/E0F2F7/000000?text=QR+Code+Pix\",alt:\"QR Code Pix\",className:\"mx-auto rounded-lg shadow-md w-64 h-64\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-sm text-gray-700\",children:\"Chave \\\"Copia e Cola\\\":\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center mt-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",readOnly:true,value:pixQrCodeData.copy_paste_key,className:\"flex-grow p-2 border border-gray-300 rounded-l-lg text-sm bg-gray-100\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>copyPixKeyToClipboard(pixQrCodeData.copy_paste_key),className:\"bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-r-lg text-sm\",children:\"Copiar\"})]}),pixQrCodeData.payment_id&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleCancelPixPayment(pixQrCodeData.payment_id),className:\"mt-4 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm shadow-md\",children:\"Cancelar Pagamento Pix\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-xs text-gray-600\",children:\"* Em um cen\\xE1rio real, a venda seria finalizada ap\\xF3s a confirma\\xE7\\xE3o do pagamento Pix via webhook.\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://placehold.co/150x150/E0F2F7/000000?text=QR+Code+Pix\",alt:\"Placeholder QR Code Pix\",className:\"mx-auto rounded-lg shadow-md w-64 h-64\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-xs text-gray-600\",children:\"Clique em \\\"Finalizar Venda\\\" para gerar o QR Code.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center text-xl \".concat(getThemeClasses('text_color_medium'),\" mb-2\"),children:[/*#__PURE__*/_jsx(\"span\",{children:\"Diferen\\xE7a:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-red-600\",children:[\"R$ \",difference.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center text-xl \".concat(getThemeClasses('text_color_medium'),\" mb-4\"),children:[/*#__PURE__*/_jsx(\"span\",{children:\"Troco:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-green-600\",children:[\"R$ \",change.toFixed(2)]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:finalizeSale,className:\"w-full \".concat(getThemeClasses('primary_button_bg'),\" \").concat(getThemeClasses('primary_button_hover_bg'),\" text-white text-xl font-bold py-4 rounded-xl transition-all duration-300 shadow-lg transform hover:scale-105\"),children:\"Finalizar Venda\"})]})]})]}),activeTab==='produtos'&&(currentUser.role==='company_admin'||currentUser.role==='gerente')&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mb-6 pb-3 border-b-2 \").concat(getThemeClasses('border_color')),children:editingProduct?'Editar Produto':'Adicionar Novo Produto'}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newProductId\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"ID do Produto:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newProductId\",value:newProductId,onChange:e=>setNewProductId(e.target.value),placeholder:\"Ex: PROD001\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",disabled:!!editingProduct// Desabilita a entrada de ID ao editar\n})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newProductName\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Nome do Produto:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newProductName\",value:newProductName,onChange:e=>setNewProductName(e.target.value),placeholder:\"Ex: Refrigerante\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newProductValue\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Valor (R$):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"newProductValue\",value:newProductValue,onChange:e=>setNewProductValue(e.target.value),placeholder:\"Ex: 5.50\",step:\"0.01\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newProductCost\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Custo (R$):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"newProductCost\",value:newProductCost,onChange:e=>setNewProductCost(e.target.value),placeholder:\"Ex: 2.00\",step:\"0.01\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end space-x-4\",children:editingProduct?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleUpdateProduct,className:\"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Atualizar Produto\"}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelEdit,className:\"bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Cancelar\"})]}):/*#__PURE__*/_jsx(\"button\",{onClick:handleAddProduct,className:\"\".concat(getThemeClasses('primary_button_bg'),\" \").concat(getThemeClasses('primary_button_hover_bg'),\" text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\"),children:\"Adicionar Produto\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mt-10 mb-4 pb-2 border-b-2 \").concat(getThemeClasses('border_color')),children:\"Lista de Produtos\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:products.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhum produto registrado.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-3\",children:products.map(product=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold \".concat(getThemeClasses('text_color_strong'),\" text-lg\"),children:[\"Produto: \",product.name,\" (ID: \",product.id,\")\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"\".concat(getThemeClasses('highlight_color'),\" font-bold text-xl\"),children:[\"R$ \",product.value.toFixed(2)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[\"Custo: R$ \",product.cost?product.cost.toFixed(2):'0.00']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEditProduct(product),className:\"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteProduct(product.id),className:\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Excluir\"})]})]},product.id))})})]}),activeTab==='relatorios'&&(currentUser.role==='company_admin'||currentUser.role==='gerente')&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mb-6 pb-3 border-b-2 \").concat(getThemeClasses('border_color')),children:\"Relat\\xF3rio de Lucro Semanal\"}),sales.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhuma venda registrada ainda.\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"max-h-96 overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"\".concat(getThemeClasses('primary_button_bg'),\" text-white\"),children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Data\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Lucro Total\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:getWeeklySales().map(_ref4=>{let[date,profit]=_ref4;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 \".concat(getThemeClasses('text_color_strong')),children:date}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4 text-green-600 font-bold\",children:[\"R$ \",profit.toFixed(2)]})]},date);})})]}),getWeeklySales().length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mt-4\",children:\"Nenhuma venda na \\xFAltima semana.\"})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mt-10 mb-4 pb-2 border-b-2 \").concat(getThemeClasses('border_color')),children:\"Todas as Vendas\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:sales.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhuma venda registrada ainda.\"}):/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white rounded-lg shadow-md\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"\".concat(getThemeClasses('primary_button_bg'),\" text-white\"),children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Data/Hora\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Itens\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Custo\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Lucro\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"M\\xE9todo\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Status\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"A\\xE7\\xF5es\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:sales.map(sale=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 \".concat(getThemeClasses('text_color_strong')),children:sale.timestamp&&typeof sale.timestamp.toDate==='function'?sale.timestamp.toDate().toLocaleString('pt-BR'):'N/A'}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 \".concat(getThemeClasses('text_color_medium')),children:sale.items.map(item=>/*#__PURE__*/_jsxs(\"p\",{children:[item.name,\" (x\",item.quantity,\")\"]},item.productId))}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4 text-green-600 font-bold\",children:[\"R$ \",sale.total.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4 text-gray-600\",children:[\"R$ \",(sale.costOfGoodsSold||0).toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4 text-purple-600 font-bold\",children:[\"R$ $\",(sale.profit||sale.total-(sale.costOfGoodsSold||0)).toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 \".concat(getThemeClasses('text_color_medium')),children:sale.paymentMethod}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 \".concat(getThemeClasses('text_color_medium')),children:sale.paymentMethod==='Pix'&&sale.status==='pending'?/*#__PURE__*/_jsx(\"span\",{className:\"text-yellow-600 font-semibold\",children:\"Pendente\"}):sale.paymentMethod==='Pix'&&sale.status==='approved'?/*#__PURE__*/_jsx(\"span\",{className:\"text-green-600 font-semibold\",children:\"Aprovado\"}):sale.paymentMethod==='Pix'&&sale.status==='cancelled'?/*#__PURE__*/_jsx(\"span\",{className:\"text-red-600 font-semibold\",children:\"Cancelado\"}):/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"N/A\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4\",children:sale.paymentMethod==='Pix'&&sale.status==='pending'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleCancelPixPayment(sale.payment_id),className:\"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-full text-sm shadow-md\",children:\"Cancelar Pix\"})})]},sale.id))})]})})]}),activeTab==='gerenciar_usuarios'&&currentUser.role==='company_admin'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mb-6 pb-3 border-b-2 \").concat(getThemeClasses('border_color')),children:editingCompanyUser?'Editar Usuário da Empresa':'Adicionar Novo Usuário da Empresa'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:editingCompanyUser?handleUpdateCompanyUser:handleAddCompanyUser,className:\"space-y-4 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyUserUsername\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Nome de Usu\\xE1rio:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newCompanyUserUsername\",value:newCompanyUserUsername,onChange:e=>setNewCompanyUserUsername(e.target.value),placeholder:\"Ex: caixa01\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true,disabled:!!editingCompanyUser// Desabilita a edição do nome de usuário\n})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyUserPassword\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Senha:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"newCompanyUserPassword\",value:newCompanyUserPassword,onChange:e=>setNewCompanyUserPassword(e.target.value),placeholder:editingCompanyUser?\"Deixe em branco para manter a senha atual\":\"********\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:!editingCompanyUser// A senha é obrigatória apenas ao adicionar\n})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyUserRole\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Fun\\xE7\\xE3o:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"newCompanyUserRole\",value:newCompanyUserRole,onChange:e=>setNewCompanyUserRole(e.target.value),className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"caixa\",children:\"Caixa\"}),/*#__PURE__*/_jsx(\"option\",{value:\"gerente\",children:\"Gerente\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end space-x-4\",children:editingCompanyUser?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Atualizar Usu\\xE1rio\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:cancelEditCompanyUser,className:\"bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Cancelar\"})]}):/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"\".concat(getThemeClasses('primary_button_bg'),\" \").concat(getThemeClasses('primary_button_hover_bg'),\" text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\"),children:\"Adicionar Usu\\xE1rio\"})})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mt-10 mb-4 pb-2 border-b-2 \").concat(getThemeClasses('border_color')),children:\"Usu\\xE1rios da Empresa\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:companyUsers.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhum usu\\xE1rio registrado para esta empresa.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-3\",children:companyUsers.map(user=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold \".concat(getThemeClasses('text_color_strong'),\" text-lg\"),children:[\"Usu\\xE1rio: \",user.username]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[\"Fun\\xE7\\xE3o: \",user.role]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEditCompanyUser(user),className:\"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteCompanyUser(user.id),className:\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Excluir\"})]})]},user.id))})})]}),activeTab==='gerenciar_empresas'&&currentUser.role==='admin'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mb-6 pb-3 border-b-2 \").concat(getThemeClasses('border_color')),children:\"Registrar Nova Empresa\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleRegisterCompany,className:\"space-y-4 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyUsername\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Nome de Usu\\xE1rio da Empresa (ID):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newCompanyUsername\",value:newCompanyUsername,onChange:e=>setNewCompanyUsername(e.target.value),placeholder:\"Ex: empresa_abc\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyPassword\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Senha da Empresa:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"newCompanyPassword\",value:newCompanyPassword,onChange:e=>setNewCompanyPassword(e.target.value),placeholder:\"********\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyName\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Nome Completo da Empresa:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newCompanyName\",value:newCompanyName,onChange:e=>setNewCompanyName(e.target.value),placeholder:\"Ex: ABC Com\\xE9rcio e Servi\\xE7os Ltda.\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyDesignTheme\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Tema de Design (Cores/Fontes):\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"newCompanyDesignTheme\",value:newCompanyDesignTheme,onChange:e=>setNewCompanyDesignTheme(e.target.value),className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"default\",children:\"Padr\\xE3o\"}),/*#__PURE__*/_jsx(\"option\",{value:\"corporate\",children:\"Corporativo\"}),/*#__PURE__*/_jsx(\"option\",{value:\"vibrant\",children:\"Vibrante\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyMercadoPagoAccessToken\",className:\"block \".concat(getThemeClasses('text_color_medium'),\" font-semibold mb-2\"),children:\"Mercado Pago Access Token:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newCompanyMercadoPagoAccessToken\",value:newCompanyMercadoPagoAccessToken,onChange:e=>setNewCompanyMercadoPagoAccessToken(e.target.value),placeholder:\"Token MP (ex: APP_USR-xxxxxxxxxxxx)\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:handleRegisterCompany,className:\"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Registrar Empresa\"})})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold \".concat(getThemeClasses('text_color_medium'),\" mt-10 mb-4 pb-2 border-b-2 \").concat(getThemeClasses('border_color')),children:\"Empresas Registradas\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:companies.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhuma empresa registrada ainda.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-3\",children:companies.map(company=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold \".concat(getThemeClasses('text_color_strong'),\" text-lg\"),children:[\"Nome: \",company.company_name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[\"Usu\\xE1rio (ID): \",company.id]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[\"Tema: \",company.design_theme]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-3\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteCompany(company.id),className:\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Excluir Empresa\"})})]},company.id))})})]})]}),showConfirmModal&&/*#__PURE__*/_jsx(ConfirmModal,{message:confirmModalMessage,onConfirm:()=>{if(confirmModalAction){confirmModalAction(confirmModalPayload);}},onCancel:()=>setShowConfirmModal(false)})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","initializeApp","getAuth","signInWithCustomToken","onAuthStateChanged","signOut","getFirestore","collection","addDoc","onSnapshot","doc","updateDoc","deleteDoc","query","where","setDoc","getDoc","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","FLASK_BACKEND_URL","DEFAULT_THEMES","default","gradient_from","gradient_to","primary_button_bg","primary_button_hover_bg","secondary_button_bg","secondary_button_text","secondary_button_hover_bg","text_color_strong","text_color_medium","border_color","highlight_color","success_color","error_color","font_family","dominant_color","corporate","vibrant","ConfirmModal","_ref","message","onConfirm","onCancel","className","children","onClick","App","console","log","firebaseAuth","setFirebaseAuth","firestoreDb","setFirestoreDb","appId","setAppId","products","setProducts","sales","setSales","companies","setCompanies","companyUsers","setCompanyUsers","cart","setCart","total","setTotal","paymentAmount","setPaymentAmount","change","setChange","difference","setDifference","paymentMethod","setPaymentMethod","newProductName","setNewProductName","newProductValue","setNewProductValue","newProductCost","setNewProductCost","newProductId","setNewProductId","editingProduct","setEditingProduct","searchTerm","setSearchTerm","isLoggedIn","setIsLoggedIn","currentUser","setCurrentUser","loginUsername","setLoginUsername","loginPassword","setLoginPassword","newCompanyUsername","setNewCompanyUsername","newCompanyPassword","setNewCompanyPassword","newCompanyName","setNewCompanyName","newCompanyDesignTheme","setNewCompanyDesignTheme","newCompanyMercadoPagoAccessToken","setNewCompanyMercadoPagoAccessToken","newCompanyUserUsername","setNewCompanyUserUsername","newCompanyUserPassword","setNewCompanyUserPassword","newCompanyUserRole","setNewCompanyUserRole","editingCompanyUser","setEditingCompanyUser","pixQrCodeData","setPixQrCodeData","isLoadingPix","setIsLoadingPix","activeTab","setActiveTab","setMessage","messageTimeoutRef","showConfirmModal","setShowConfirmModal","confirmModalMessage","setConfirmModalMessage","confirmModalAction","setConfirmModalAction","confirmModalPayload","setConfirmModalPayload","pixStatus","setPixStatus","showMessage","msg","type","arguments","length","undefined","text","current","clearTimeout","setTimeout","firebaseConfig","currentAppId","__firebase_config","__app_id","JSON","parse","e","error","Error","app","auth","db","unsubscribe","user","idTokenResult","getIdTokenResult","role","claims","companyName","company_name","design","username","uid","claimsError","__initial_auth_token","then","catch","unsubscribeProducts","unsubscribeSales","unsubscribeCompanyUsers","unsubscribeCompanies","includes","productsCollectionRef","concat","snapshot","productsData","docs","map","_objectSpread","id","data","salesCollectionRef","salesData","companyUsersCollectionRef","path","usersData","companiesCollectionRef","q","companiesData","newTotal","reduce","sum","item","value","quantity","paid","parseFloat","addToCart","product","existingItem","find","name","removeFromCart","productId","filter","increaseQuantity","decreaseQuantity","finalizeSale","costOfGoodsSold","cost","baseSaleData","items","profit","timestamp","Date","userId","saleId","pixSaleData","status","payment_id","sale_id_frontend","idToken","getIdToken","response","fetch","method","headers","body","stringify","amount","toFixed","description","company_username","sale_id","json","ok","qr_code_base64","startsWith","finalSaleData","deleteError","handleAddProduct","isNaN","productData","productDocRef","docSnap","exists","handleEditProduct","toString","handleUpdateProduct","productRef","handleDeleteProduct","docRef","code","cancelEdit","getWeeklySales","oneWeekAgo","setDate","getDate","weeklySales","sale","toDate","saleDate","salesByDay","forEach","toLocaleDateString","sortedSales","Object","entries","sort","_ref2","_ref3","dateA","dateB","dayA","monthA","yearA","split","Number","dayB","monthB","yearB","dateObjA","dateObjB","handleLogin","preventDefault","password","firebaseToken","firebase_token","firebaseError","handleLogout","handleRegisterCompany","design_theme","mercado_pago_access_token","handleDeleteCompany","companyIdToDelete","handleAddCompanyUser","company_id","handleEditCompanyUser","handleUpdateCompanyUser","user_id","handleDeleteCompanyUser","userIdToDelete","cancelEditCompanyUser","copyPixKeyToClipboard","key","el","document","createElement","appendChild","select","execCommand","err","removeChild","handleCancelPixPayment","paymentId","filteredProducts","toLowerCase","getThemeClasses","element","theme","getColorClass","prop","defaultColor","color","saleDocRef","saleData","autoPlay","loop","muted","playsInline","src","onError","onSubmit","htmlFor","placeholder","onChange","target","required","currentDesign","showCompanyManagementVideo","backgroundClasses","step","alt","readOnly","copy_paste_key","disabled","_ref4","date","toLocaleString","company"],"sources":["C:/Users/willi/OneDrive/Desktop/projetos/caixa/meu-app-de-caixa/src/App.js"],"sourcesContent":["/* global __app_id, __firebase_config, __initial_auth_token */\nimport React, { useState, useEffect, useRef } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, signInWithCustomToken, onAuthStateChanged, signOut } from 'firebase/auth';\nimport { getFirestore, collection, addDoc, onSnapshot, doc, updateDoc, deleteDoc, query, where, setDoc, getDoc } from 'firebase/firestore';\n\n// URL base do seu backend Flask\n// ATENÇÃO: SUBSTITUA 'https://old-owl-williammzin-cd2d4d31.koyeb.app' PELA URL REAL DO SEU BACKEND KOYEB!\nconst FLASK_BACKEND_URL = 'https://old-owl-williammzin-cd2d4d31.koyeb.app';\n\n// Temas padrão para o design da interface\nconst DEFAULT_THEMES = {\n    default: {\n        gradient_from: 'from-blue-50',\n        gradient_to: 'to-indigo-100',\n        primary_button_bg: 'bg-blue-600',\n        primary_button_hover_bg: 'hover:bg-blue-700',\n        secondary_button_bg: 'bg-gray-200',\n        secondary_button_text: 'text-gray-700',\n        secondary_button_hover_bg: 'hover:bg-gray-100',\n        text_color_strong: 'text-gray-800',\n        text_color_medium: 'text-gray-700',\n        border_color: 'border-blue-200',\n        highlight_color: 'text-blue-600',\n        success_color: 'bg-green-500',\n        error_color: 'bg-red-500',\n        font_family: 'font-sans',\n        dominant_color: 'bg-blue-50' // Usado para cabeçalhos de tabela, etc.\n    },\n    corporate: {\n        gradient_from: 'from-gray-100',\n        gradient_to: 'to-gray-200',\n        primary_button_bg: 'bg-purple-700',\n        primary_button_hover_bg: 'hover:bg-purple-800',\n        secondary_button_bg: 'bg-gray-300',\n        secondary_button_text: 'text-gray-800',\n        secondary_button_hover_bg: 'hover:bg-gray-400',\n        text_color_strong: 'text-gray-900',\n        text_color_medium: 'text-gray-700',\n        border_color: 'border-purple-300',\n        highlight_color: 'text-purple-700',\n        success_color: 'bg-green-600',\n        error_color: 'bg-red-600',\n        font_family: 'font-serif',\n        dominant_color: 'bg-purple-100'\n    },\n    vibrant: {\n        gradient_from: 'from-pink-100',\n        gradient_to: 'to-yellow-100',\n        primary_button_bg: 'bg-pink-500',\n        primary_button_hover_bg: 'hover:bg-pink-600',\n        secondary_button_bg: 'bg-yellow-200',\n        secondary_button_text: 'text-yellow-800',\n        secondary_button_hover_bg: 'hover:bg-yellow-300',\n        text_color_strong: 'text-purple-900',\n        text_color_medium: 'text-purple-700',\n        border_color: 'border-pink-300',\n        highlight_color: 'text-orange-500',\n        success_color: 'bg-lime-500',\n        error_color: 'bg-rose-500',\n        font_family: 'font-mono',\n        dominant_color: 'bg-pink-50'\n    }\n};\n\n// Componente de Modal de Confirmação\nconst ConfirmModal = ({ message, onConfirm, onCancel }) => {\n    return (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n            <div className=\"bg-white p-6 rounded-lg shadow-xl max-w-sm w-full text-center\">\n                <p className=\"text-lg font-semibold mb-6\">{message}</p>\n                <div className=\"flex justify-around\">\n                    <button\n                        onClick={onConfirm}\n                        className=\"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200\"\n                    >\n                        Confirmar\n                    </button>\n                    <button\n                        onClick={onCancel}\n                        className=\"bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200\"\n                    >\n                        Cancelar\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n};\n\n// Componente Principal da Aplicação\nconst App = () => {\n    console.log(\"O componente App está sendo renderizado...\");\n\n    // Estados para instâncias do Firebase\n    const [firebaseAuth, setFirebaseAuth] = useState(null);\n    const [firestoreDb, setFirestoreDb] = useState(null);\n\n    // ID da Aplicação do ambiente Canvas\n    const [appId, setAppId] = useState('local-app-id');\n\n    // Estados para dados da loja\n    const [products, setProducts] = useState([]);\n    const [sales, setSales] = useState([]);\n    const [companies, setCompanies] = useState([]); // Apenas para o admin principal\n    const [companyUsers, setCompanyUsers] = useState([]); // Apenas para company_admin\n\n    // Estados do carrinho e pagamento\n    const [cart, setCart] = useState([]);\n    const [total, setTotal] = useState(0);\n    const [paymentAmount, setPaymentAmount] = useState('');\n    const [change, setChange] = useState(0);\n    const [difference, setDifference] = useState(0);\n    const [paymentMethod, setPaymentMethod] = useState('Dinheiro');\n\n    // Estados para gerenciamento de produtos\n    const [newProductName, setNewProductName] = useState('');\n    const [newProductValue, setNewProductValue] = useState('');\n    const [newProductCost, setNewProductCost] = useState('');\n    const [newProductId, setNewProductId] = useState('');\n    const [editingProduct, setEditingProduct] = useState(null);\n    const [searchTerm, setSearchTerm] = useState('');\n\n    // Estados para autenticação e usuário atual\n    const [isLoggedIn, setIsLoggedIn] = useState(false);\n    const [currentUser, setCurrentUser] = useState(null); // Armazena { username, role, company_name, design }\n    const [loginUsername, setLoginUsername] = useState('');\n    const [loginPassword, setLoginPassword] = useState('');\n\n    // Estados para registro de empresa (apenas para admin principal)\n    const [newCompanyUsername, setNewCompanyUsername] = useState('');\n    const [newCompanyPassword, setNewCompanyPassword] = useState('');\n    const [newCompanyName, setNewCompanyName] = useState('');\n    const [newCompanyDesignTheme, setNewCompanyDesignTheme] = useState('default');\n    const [newCompanyMercadoPagoAccessToken, setNewCompanyMercadoPagoAccessToken] = useState('');\n\n    // Estados para gerenciamento de usuários da empresa (apenas para company_admin)\n    const [newCompanyUserUsername, setNewCompanyUserUsername] = useState('');\n    const [newCompanyUserPassword, setNewCompanyUserPassword] = useState('');\n    const [newCompanyUserRole, setNewCompanyUserRole] = useState('caixa');\n    const [editingCompanyUser, setEditingCompanyUser] = useState(null);\n\n    // Estados para funcionalidade Pix\n    const [pixQrCodeData, setPixQrCodeData] = useState(null);\n    const [isLoadingPix, setIsLoadingPix] = useState(false);\n\n    // Estados para controle de abas\n    const [activeTab, setActiveTab] = useState('caixa');\n\n    // Estados para mensagens de feedback\n    const [message, setMessage] = useState('');\n    const messageTimeoutRef = useRef(null);\n\n    // Estados para o modal de confirmação\n    const [showConfirmModal, setShowConfirmModal] = useState(false);\n    const [confirmModalMessage, setConfirmModalMessage] = useState('');\n    const [confirmModalAction, setConfirmModalAction] = useState(null);\n    const [confirmModalPayload, setConfirmModalPayload] = useState(null);\n\n    // Novo estado para controlar status do Pix da venda atual\n    const [pixStatus, setPixStatus] = useState(null);\n\n    // Função para exibir mensagens na interface\n    const showMessage = (msg, type = 'success') => {\n        setMessage({ text: msg, type });\n        if (messageTimeoutRef.current) {\n            clearTimeout(messageTimeoutRef.current);\n        }\n        messageTimeoutRef.current = setTimeout(() => {\n            setMessage('');\n        }, 3000);\n    };\n\n    // Efeito para inicialização do Firebase e listener de autenticação\n    useEffect(() => {\n        console.log(\"useEffect: Inicialização do Firebase e Listener de Autenticação.\");\n        let firebaseConfig = null;\n        let currentAppId = 'local-app-id';\n\n        // Tenta obter a configuração do ambiente Canvas\n        if (typeof __firebase_config !== 'undefined' && typeof __app_id !== 'undefined') {\n            try {\n                firebaseConfig = JSON.parse(__firebase_config);\n                currentAppId = __app_id;\n                console.log(\"Configuração do Firebase e ID do App carregados do ambiente Canvas.\");\n            } catch (e) {\n                console.error(\"Erro ao fazer parse de __firebase_config:\", e);\n                showMessage(\"Erro ao carregar a configuração do Firebase.\", \"error\");\n            }\n        } else {\n            throw new Error(\"Firebase config não encontrada! Defina __firebase_config e __app_id no ambiente.\");\n        }\n\n        if (firebaseConfig) {\n            try {\n                const app = initializeApp(firebaseConfig);\n                const auth = getAuth(app);\n                const db = getFirestore(app);\n\n                setFirebaseAuth(auth);\n                setFirestoreDb(db);\n                setAppId(currentAppId);\n\n                console.log(\"Firebase App, Auth e Firestore inicializados e definidos no estado.\");\n\n                // Listener de mudança de estado de autenticação\n                const unsubscribe = onAuthStateChanged(auth, async (user) => {\n                    console.log(\"Estado de autenticação do Firebase alterado. Usuário:\", user);\n                    if (user) {\n                        try {\n                            const idTokenResult = await user.getIdTokenResult(true);\n                            const role = idTokenResult.claims.role;\n                            const companyName = idTokenResult.claims.company_name;\n                            const design = idTokenResult.claims.design;\n\n                            setCurrentUser({\n                                username: user.uid, // Usando UID como username para consistência com Flask\n                                role: role,\n                                company_name: companyName,\n                                design: design\n                            });\n                            setIsLoggedIn(true);\n                            console.log(\"Usuário logado e estado currentUser atualizado:\", user.uid, role);\n                        } catch (claimsError) {\n                            console.error(\"Erro ao obter custom claims do usuário:\", claimsError);\n                            showMessage(\"Erro ao recuperar detalhes do usuário. Por favor, tente fazer login novamente.\", \"error\");\n                            setIsLoggedIn(false);\n                            setCurrentUser(null);\n                        }\n                    } else {\n                        console.log(\"Nenhum usuário autenticado no Firebase.\");\n                        setIsLoggedIn(false);\n                        setCurrentUser(null);\n                    }\n                });\n\n                // Tenta fazer login com o token personalizado inicial do ambiente Canvas\n                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {\n                    signInWithCustomToken(auth, __initial_auth_token)\n                        .then(() => console.log(\"Login com token personalizado inicial bem-sucedido.\"))\n                        .catch(error => console.error(\"Erro ao fazer login com token personalizado inicial:\", error));\n                }\n\n                return () => unsubscribe(); // Limpeza do listener na desmontagem do componente\n            } catch (e) {\n                console.error(\"Erro crítico ao inicializar o Firebase:\", e);\n                showMessage(\"Erro crítico ao inicializar o Firebase. Por favor, verifique o console.\", \"error\");\n            }\n        }\n    }, []); // Array de dependências vazio significa que este efeito é executado apenas uma vez na montagem\n\n    // Efeito para listeners do Firestore (Produtos, Vendas, Usuários da Empresa, Empresas)\n    // Depende de firestoreDb e currentUser para garantir que o Firebase esteja inicializado e o usuário logado\n    useEffect(() => {\n        console.log(\"useEffect: Listeners do Firestore acionados. firestoreDb:\", !!firestoreDb, \"currentUser:\", currentUser);\n\n        if (!firestoreDb || !currentUser || !currentUser.username) {\n            console.log(\"Listeners do Firestore ignorados: DB não pronto ou currentUser não definido.\");\n            setProducts([]);\n            setSales([]);\n            setCompanyUsers([]);\n            setCompanies([]);\n            return;\n        }\n\n        console.log(\"Tentando buscar dados do Firestore para o usuário:\", currentUser.username);\n\n        let unsubscribeProducts;\n        let unsubscribeSales;\n        let unsubscribeCompanyUsers;\n        let unsubscribeCompanies;\n\n        // Listener de Produtos (para company_admin, gerente, caixa)\n        if (['company_admin', 'gerente', 'caixa'].includes(currentUser.role)) {\n            const productsCollectionRef = collection(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/products`);\n            unsubscribeProducts = onSnapshot(productsCollectionRef, (snapshot) => {\n                console.log(\"Snapshot de Produtos do Firestore recebido.\");\n                const productsData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n                setProducts(productsData);\n                console.log(\"Produtos carregados com sucesso!\");\n            }, (error) => {\n                console.error(\"Erro ao carregar produtos:\", error);\n                showMessage(\"Erro ao carregar produtos do Firestore. Verifique as permissões.\", \"error\");\n            });\n        } else {\n            setProducts([]);\n        }\n\n        // Listener de Vendas (para company_admin, gerente, caixa)\n        if (['company_admin', 'gerente', 'caixa'].includes(currentUser.role)) {\n            const salesCollectionRef = collection(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/sales`);\n            unsubscribeSales = onSnapshot(salesCollectionRef, (snapshot) => {\n                console.log(\"Snapshot de Vendas do Firestore recebido.\");\n                const salesData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n                setSales(salesData);\n                console.log(\"Vendas carregadas com sucesso!\");\n            }, (error) => {\n                console.error(\"Erro ao carregar vendas:\", error);\n                showMessage(\"Erro ao carregar vendas do Firestore. Verifique as permissões.\", \"error\");\n            });\n        } else {\n            setSales([]);\n        }\n\n        // Listener de Usuários da Empresa (APENAS para company_admin)\n        if (currentUser.role === 'company_admin') {\n            const companyUsersCollectionRef = collection(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/company_users`);\n            console.log(\"Caminho do Listener de Usuários da Empresa do Firestore:\", companyUsersCollectionRef.path);\n            unsubscribeCompanyUsers = onSnapshot(companyUsersCollectionRef, (snapshot) => {\n                console.log(\"Snapshot de Usuários da Empresa do Firestore recebido.\");\n                const usersData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n                setCompanyUsers(usersData);\n                console.log(\"Usuários da empresa carregados com sucesso!\", usersData);\n            }, (error) => {\n                console.error(\"Erro ao carregar usuários da empresa:\", error);\n                showMessage(\"Erro ao carregar usuários da empresa do Firestore. Verifique as permissões.\", \"error\");\n            });\n        } else {\n            setCompanyUsers([]);\n        }\n\n        // Listener para a lista de empresas (APENAS para o admin principal)\n        if (currentUser.role === 'admin') {\n            const companiesCollectionRef = collection(firestoreDb, `artifacts/${appId}/users`);\n            const q = query(companiesCollectionRef, where(\"role\", \"==\", \"company_admin\"));\n\n            unsubscribeCompanies = onSnapshot(q, (snapshot) => {\n                console.log(\"Snapshot de Empresas do Firestore recebido.\");\n                const companiesData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n                setCompanies(companiesData);\n                console.log(\"Empresas carregadas com sucesso!\");\n            }, (error) => {\n                console.error(\"Erro ao carregar empresas:\", error);\n                showMessage(\"Erro ao carregar empresas do Firestore. Verifique as permissões.\", \"error\");\n            });\n        } else {\n            setCompanies([]);\n        }\n\n        // Função de limpeza para cancelar as inscrições dos listeners\n        return () => {\n            if (unsubscribeProducts) unsubscribeProducts();\n            if (unsubscribeSales) unsubscribeSales();\n            if (unsubscribeCompanyUsers) unsubscribeCompanyUsers();\n            if (unsubscribeCompanies) unsubscribeCompanies();\n            console.log(\"Listeners do Firestore para Produtos, Vendas, Usuários da Empresa e Empresas desinscritos.\");\n        };\n    }, [firestoreDb, currentUser, appId]); // Depende de firestoreDb e currentUser\n\n    // Efeito para calcular o total do carrinho\n    useEffect(() => {\n        const newTotal = cart.reduce((sum, item) => sum + (item.value * item.quantity), 0);\n        setTotal(newTotal);\n    }, [cart]);\n\n    // Efeito para calcular troco/diferença de pagamento\n    useEffect(() => {\n        const paid = parseFloat(paymentAmount) || 0;\n        if (paid >= total) {\n            setChange(paid - total);\n            setDifference(0);\n        } else {\n            setChange(0);\n            setDifference(total - paid);\n        }\n    }, [total, paymentAmount]);\n\n    // Adiciona um produto ao carrinho\n    const addToCart = (product) => {\n        const existingItem = cart.find(item => item.id === product.id);\n        if (existingItem) {\n            setCart(cart.map(item =>\n                item.id === product.id ? { ...item, quantity: item.quantity + 1 } : item\n            ));\n        } else {\n            setCart([...cart, { ...product, quantity: 1 }]);\n        }\n        showMessage(`${product.name} adicionado ao carrinho!`);\n    };\n\n    // Remove um produto do carrinho\n    const removeFromCart = (productId) => {\n        setCart(cart.filter(item => item.id !== productId));\n        showMessage(\"Item removido do carrinho.\", \"info\");\n    };\n\n    // Aumenta a quantidade de um item no carrinho\n    const increaseQuantity = (productId) => {\n        setCart(cart.map(item =>\n            item.id === productId ? { ...item, quantity: item.quantity + 1 } : item\n        ));\n    };\n\n    // Diminui a quantidade de um item no carrinho\n    const decreaseQuantity = (productId) => {\n        setCart(cart.map(item =>\n            item.id === productId && item.quantity > 1 ? { ...item, quantity: item.quantity - 1 } : item\n        ).filter(item => item.quantity > 0)); // Remove se a quantidade se tornar 0\n    };\n\n    // Finaliza uma venda (dinheiro, cartão ou Pix)\n    const finalizeSale = async () => {\n        if (cart.length === 0) {\n            showMessage(\"O carrinho está vazio!\", \"error\");\n            return;\n        }\n        if (!firestoreDb || !currentUser || !firebaseAuth) {\n            showMessage(\"Erro: Serviço de banco de dados ou autenticação não disponível.\", \"error\");\n            return;\n        }\n\n        // Calcula o custo total dos produtos vendidos (CPV)\n        const costOfGoodsSold = cart.reduce((sum, item) => sum + ((item.cost || 0) * item.quantity), 0);\n\n        // Prepara os dados básicos da venda\n        const baseSaleData = {\n            items: cart.map(item => ({\n                productId: item.id,\n                name: item.name,\n                value: item.value,\n                cost: item.cost || 0,\n                quantity: item.quantity\n            })),\n            total: total,\n            costOfGoodsSold: costOfGoodsSold,\n            profit: total - costOfGoodsSold,\n            paymentMethod: paymentMethod,\n            paymentAmount: parseFloat(paymentAmount) || 0,\n            change: change,\n            timestamp: new Date(),\n            userId: currentUser.username\n        };\n\n        let saleId = null; // Para armazenar o ID da venda gerado\n\n        try {\n            // Lógica para pagamento Pix\n            if (paymentMethod === 'Pix') {\n                setIsLoadingPix(true);\n                setPixQrCodeData(null); // Limpa dados Pix anteriores\n\n                // 1. Gera um ID de venda único ANTES de qualquer chamada ao backend\n                saleId = doc(collection(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/sales`)).id;\n\n                // 2. Cria o documento de venda no Firestore com status 'pending'\n                // Isso garante que o documento exista para ser atualizado pelo webhook\n                const pixSaleData = {\n                    ...baseSaleData,\n                    status: 'pending', // Status inicial para Pix\n                    payment_id: null, // Será preenchido após a resposta do MP\n                    sale_id_frontend: saleId // Salva o ID gerado no frontend\n                };\n                await setDoc(doc(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/sales`, saleId), pixSaleData);\n                showMessage(\"Iniciando pagamento Pix. Aguardando QR Code...\", \"info\");\n\n                // Obtém o ID Token do usuário Firebase logado\n                const idToken = await firebaseAuth.currentUser.getIdToken();\n\n                const response = await fetch(`${FLASK_BACKEND_URL}/pix/generate`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${idToken}`\n                    },\n                    body: JSON.stringify({\n                        amount: total.toFixed(2),\n                        description: \"Pagamento de Venda\",\n                        company_username: currentUser.username,\n                        sale_id: saleId,\n                    }),\n                });\n\n                const data = await response.json();\n\n                if (response.ok) {\n                    // Adiciona o prefixo data:image/png;base64, se não estiver presente\n                    if (data.qr_code_base64 && !data.qr_code_base64.startsWith('data:image/png;base64,')) {\n                        data.qr_code_base64 = 'data:image/png;base64,' + data.qr_code_base64;\n                    }\n                    setPixQrCodeData(data);\n                    showMessage(\"QR Code Pix gerado com sucesso! Aguardando pagamento...\", \"success\");\n\n                    // 3. Atualiza o documento de venda no Firestore com o payment_id do Mercado Pago\n                    // Isso é crucial para o webhook encontrar e atualizar\n                    await updateDoc(doc(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/sales`, saleId), {\n                        payment_id: data.payment_id // Salva o ID de pagamento do Mercado Pago\n                    });\n\n                    // Não limpa o carrinho aqui, pois a venda ainda está pendente.\n                    // O carrinho será limpo quando o webhook confirmar o pagamento.\n\n                } else {\n                    // Se a geração do Pix falhar, remove a venda pendente criada\n                    if (saleId) {\n                        await deleteDoc(doc(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/sales`, saleId));\n                    }\n                    showMessage(`Erro ao gerar Pix: ${data.error || 'Erro desconhecido'}`, \"error\");\n                }\n            } else {\n                // Lógica para Dinheiro e Cartão (não-Pix)\n                // Adiciona a venda diretamente ao Firestore com status 'completed'\n                const finalSaleData = {\n                    ...baseSaleData,\n                    status: 'completed' // Status final para Dinheiro/Cartão\n                };\n                await addDoc(collection(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/sales`), finalSaleData);\n                showMessage(\"Venda finalizada com sucesso!\");\n            }\n\n            // Limpa o carrinho e redefine os estados APENAS se a venda não for Pix ou se o Pix foi gerado com sucesso\n            if (paymentMethod !== 'Pix' || (paymentMethod === 'Pix' && pixQrCodeData)) {\n                setCart([]);\n                setPaymentAmount('');\n                setChange(0);\n                setDifference(0);\n                setPaymentMethod('Dinheiro');\n                setPixQrCodeData(null);\n            }\n\n        } catch (e) {\n            console.error(\"Erro ao finalizar venda ou gerar Pix:\", e);\n            showMessage(\"Erro ao finalizar venda ou gerar Pix.\", \"error\");\n            // Se a venda foi criada mas o Pix falhou, tenta removê-la\n            if (saleId && paymentMethod === 'Pix') {\n                try {\n                    await deleteDoc(doc(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/sales`, saleId));\n                } catch (deleteError) {\n                    console.error(\"Erro ao remover venda pendente após falha na geração do Pix:\", deleteError);\n                }\n            }\n        } finally {\n            setIsLoadingPix(false);\n        }\n    };\n\n    // Funções de Gerenciamento de Produtos\n    const handleAddProduct = async () => {\n        if (!newProductName || !newProductValue || !newProductId || newProductCost === '') {\n            showMessage(\"Preencha todos os campos do produto!\", \"error\");\n            return;\n        }\n        if (isNaN(parseFloat(newProductValue)) || isNaN(parseFloat(newProductCost))) {\n            showMessage(\"Valor e custo do produto devem ser números!\", \"error\");\n            return;\n        }\n        if (!firestoreDb || !currentUser) {\n            showMessage(\"Erro: Banco de dados ou usuário não disponível.\", \"error\");\n            return;\n        }\n\n        const productData = {\n            name: newProductName,\n            value: parseFloat(newProductValue),\n            cost: parseFloat(newProductCost)\n        };\n\n        try {\n            // Referência ao documento com o ID fornecido pelo usuário\n            const productDocRef = doc(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/products`, newProductId);\n            const docSnap = await getDoc(productDocRef); // Verifica se o documento já existe\n\n            if (docSnap.exists()) {\n                showMessage(\"ID do produto já existe! Escolha um ID único.\", \"error\");\n                return;\n            }\n\n            // Usa setDoc para criar um documento com o ID fornecido pelo usuário\n            await setDoc(productDocRef, productData);\n            showMessage(\"Produto adicionado com sucesso!\");\n            setNewProductName('');\n            setNewProductValue('');\n            setNewProductCost('');\n            setNewProductId('');\n        } catch (e) {\n            console.error(\"Erro ao adicionar produto: \", e);\n            showMessage(\"Erro ao adicionar produto.\", \"error\");\n        }\n    };\n\n    const handleEditProduct = (product) => {\n        setEditingProduct(product);\n        setNewProductName(product.name);\n        setNewProductValue(product.value.toString());\n        setNewProductCost(product.cost ? product.cost.toString() : '');\n        setNewProductId(product.id); // Mantém o ID para exibição, mas não é editável\n    };\n\n    const handleUpdateProduct = async () => {\n        if (!editingProduct || !newProductName || !newProductValue || newProductCost === '') {\n            showMessage(\"Preencha todos os campos para atualizar!\", \"error\");\n            return;\n        }\n        if (isNaN(parseFloat(newProductValue)) || isNaN(parseFloat(newProductCost))) {\n            showMessage(\"Valor e custo do produto devem ser números!\", \"error\");\n            return;\n        }\n        if (!firestoreDb || !currentUser) {\n            showMessage(\"Erro: Banco de dados ou usuário não disponível.\", \"error\");\n            return;\n        }\n\n        const productRef = doc(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/products`, editingProduct.id);\n        try {\n            await updateDoc(productRef, {\n                name: newProductName,\n                value: parseFloat(newProductValue),\n                cost: parseFloat(newProductCost)\n            });\n            showMessage(\"Produto atualizado com sucesso!\");\n            setEditingProduct(null);\n            setNewProductName('');\n            setNewProductValue('');\n            setNewProductCost('');\n            setNewProductId('');\n        } catch (e) {\n            console.error(\"Erro ao atualizar produto: \", e);\n            showMessage(\"Erro ao atualizar produto.\", \"error\");\n        }\n    };\n\n    const handleDeleteProduct = async (productId) => {\n        if (!firestoreDb || !currentUser) {\n            showMessage(\"Erro: Banco de dados ou usuário não disponível.\", \"error\");\n            setShowConfirmModal(false);\n            return;\n        }\n        setConfirmModalMessage(`Tem certeza que deseja excluir o produto com ID: ${productId}?`);\n        setConfirmModalAction(() => async () => {\n            try {\n                const docRef = doc(firestoreDb, `artifacts/${appId}/users/${currentUser.username}/products`, productId);\n                await deleteDoc(docRef);\n                showMessage(\"Produto excluído com sucesso!\");\n            } catch (e) {\n                console.error(\"Erro ao excluir produto:\", e);\n                if (e.code === 'permission-denied') {\n                    showMessage(\"Erro de permissão: Você não está autorizado a excluir este produto. Verifique as permissões.\", \"error\");\n                } else {\n                    showMessage(\"Erro ao excluir produto.\", \"error\");\n                }\n            } finally {\n                setShowConfirmModal(false);\n            }\n        });\n        setConfirmModalPayload(productId);\n        setShowConfirmModal(true);\n    };\n\n    const cancelEdit = () => {\n        setEditingProduct(null);\n        setNewProductName('');\n        setNewProductValue('');\n        setNewProductCost('');\n        setNewProductId('');\n    };\n\n    // Calcula o relatório de vendas semanal\n    const getWeeklySales = () => {\n        const oneWeekAgo = new Date();\n        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\n\n        const weeklySales = sales.filter(sale => {\n            // Garante que o timestamp existe e é um Firestore Timestamp\n            if (sale.timestamp && typeof sale.timestamp.toDate === 'function') {\n                const saleDate = sale.timestamp.toDate();\n                return saleDate >= oneWeekAgo;\n            }\n            return false;\n        });\n\n        const salesByDay = {};\n        weeklySales.forEach(sale => {\n            const saleDate = sale.timestamp.toDate().toLocaleDateString('pt-BR');\n            // Soma o lucro em vez do total\n            if (!salesByDay[saleDate]) {\n                salesByDay[saleDate] = 0;\n            }\n            salesByDay[saleDate] += sale.profit || (sale.total - (sale.costOfGoodsSold || 0)); // Garante que o lucro seja calculado se não salvo\n        });\n\n        // Ordena por data para exibição\n        const sortedSales = Object.entries(salesByDay).sort(([dateA], [dateB]) => {\n            const [dayA, monthA, yearA] = dateA.split('/').map(Number);\n            const [dayB, monthB, yearB] = dateB.split('/').map(Number);\n            const dateObjA = new Date(yearA, monthA - 1, dayA);\n            const dateObjB = new Date(yearB, monthB - 1, dayB);\n            return dateObjA - dateObjB;\n        });\n\n        return sortedSales;\n    };\n\n    // --- Funções de Autenticação do Backend Flask ---\n    const handleLogin = async (e) => {\n        e.preventDefault();\n        console.log(\"Tentando login...\");\n        if (!firebaseAuth) {\n            showMessage(\"A autenticação do Firebase não foi inicializada.\", \"error\");\n            return;\n        }\n        try {\n            const response = await fetch(`${FLASK_BACKEND_URL}/login`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ username: loginUsername, password: loginPassword }),\n            });\n\n            const data = await response.json();\n            console.log(\"Dados da resposta de login:\", data);\n\n            if (response.ok) {\n                const firebaseToken = data.firebase_token;\n                if (firebaseToken) {\n                    try {\n                        await signInWithCustomToken(firebaseAuth, firebaseToken);\n                        showMessage(`Login bem-sucedido! Bem-vindo(a), ${data.username}.`, 'success');\n                        // O estado currentUser será atualizado pelo listener onAuthStateChanged\n                        setLoginPassword('');\n                        // Redireciona para a aba apropriada após o login\n                        if (data.role === 'admin') {\n                            setActiveTab('gerenciar_empresas');\n                        } else {\n                            setActiveTab('caixa');\n                        }\n                    } catch (firebaseError) {\n                        console.error(\"Erro ao autenticar com o token personalizado do Firebase:\", firebaseError);\n                        showMessage(`Erro ao conectar ao Firebase: ${firebaseError.message}`, 'error');\n                        setIsLoggedIn(false);\n                        setCurrentUser(null);\n                    }\n                } else {\n                    showMessage(\"Erro: Token do Firebase não recebido do backend.\", \"error\");\n                    console.error(\"Token do Firebase ausente na resposta do Flask. Dados completos:\", data);\n                }\n            } else {\n                showMessage(`Erro de login: ${data.error || 'Credenciais inválidas'}`, 'error');\n            }\n        } catch (error) {\n            console.error('Erro ao conectar ao backend para login:', error);\n            showMessage('Erro ao conectar ao servidor. Verifique se o backend está em execução.', 'error');\n        }\n    };\n\n    const handleLogout = async () => {\n        console.log(\"Tentando logout...\");\n        if (!firebaseAuth) {\n            showMessage(\"A autenticação do Firebase não foi inicializada.\", \"error\");\n            return;\n        }\n        // Redefine os estados que controlam os listeners ANTES de fazer logout do Firebase Auth\n        setIsLoggedIn(false);\n        setCurrentUser(null);\n        setLoginUsername('');\n        setLoginPassword('');\n        setCart([]);\n        setProducts([]);\n        setSales([]);\n        setCompanies([]);\n        setCompanyUsers([]);\n        setPixQrCodeData(null); // Limpa dados do Pix ao sair\n\n        try {\n            await signOut(firebaseAuth); // Faz logout do Firebase Auth\n            showMessage(\"Você foi desconectado(a).\", \"info\");\n            setActiveTab('caixa'); // Retorna para a aba padrão após o logout\n            console.log(\"Logout bem-sucedido.\");\n        } catch (error) {\n            console.error(\"Erro ao fazer logout do Firebase:\", error);\n            showMessage(\"Erro ao desconectar.\", \"error\");\n        }\n    };\n\n    // --- Funções de Gerenciamento de Empresas (para o admin principal) ---\n    const handleRegisterCompany = async (e) => {\n        e.preventDefault();\n        if (!newCompanyUsername || !newCompanyPassword || !newCompanyName) {\n            showMessage(\"Preencha todos os campos para registrar a empresa!\", \"error\");\n            return;\n        }\n        console.log(\"Tentando registrar empresa...\");\n\n        try {\n            const response = await fetch(`${FLASK_BACKEND_URL}/register_company`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    username: newCompanyUsername,\n                    password: newCompanyPassword,\n                    company_name: newCompanyName,\n                    design_theme: newCompanyDesignTheme,\n                    mercado_pago_access_token: newCompanyMercadoPagoAccessToken,\n                }),\n            });\n\n            const data = await response.json();\n            console.log(\"Dados da resposta de registro de empresa:\", data);\n\n            if (response.ok) {\n                showMessage(`Empresa \"${data.company_name}\" (Usuário: ${data.username}) registrada com sucesso!`, 'success');\n                setNewCompanyUsername('');\n                setNewCompanyPassword('');\n                setNewCompanyName('');\n                setNewCompanyDesignTheme('default');\n                setNewCompanyMercadoPagoAccessToken('');\n            } else {\n                showMessage(`Erro ao registrar empresa: ${data.error || 'Erro desconhecido'}`, \"error\");\n            }\n        } catch (error) {\n            console.error('Erro ao conectar ao backend para registrar empresa:', error);\n            showMessage('Erro ao conectar ao servidor para registrar empresa.', 'error');\n        }\n    };\n\n    // Função para excluir uma empresa (login)\n    const handleDeleteCompany = async (companyIdToDelete) => {\n        if (!firebaseAuth || !firebaseAuth.currentUser) {\n            showMessage(\"Erro: Usuário não autenticado.\", \"error\");\n            setShowConfirmModal(false);\n            return;\n        }\n        setConfirmModalMessage(`Tem certeza que deseja excluir a empresa ${companyIdToDelete} e TODOS os seus dados (produtos, vendas, etc.)? Esta ação é irreversível!`);\n        setConfirmModalAction(() => async () => {\n            console.log(\"Tentando excluir empresa:\", companyIdToDelete);\n            try {\n                const idToken = await firebaseAuth.currentUser.getIdToken();\n                const response = await fetch(`${FLASK_BACKEND_URL}/delete_company`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${idToken}`\n                    },\n                    body: JSON.stringify({ company_username: companyIdToDelete }),\n                });\n\n                const data = await response.json();\n                console.log(\"Dados da resposta de exclusão de empresa:\", data);\n\n                if (response.ok) {\n                    showMessage(`Empresa \"${companyIdToDelete}\" excluída com sucesso!`, 'success');\n                } else {\n                    showMessage(`Erro ao excluir empresa: ${data.error || 'Erro desconhecido'}`, \"error\");\n                }\n            } catch (error) {\n                console.error('Erro ao conectar ao backend para excluir empresa:', error);\n                showMessage('Erro ao conectar ao servidor para excluir empresa.', 'error');\n            } finally {\n                setShowConfirmModal(false);\n            }\n        });\n        setConfirmModalPayload(companyIdToDelete);\n        setShowConfirmModal(true);\n    };\n\n    // --- Funções de Gerenciamento de Usuários da Empresa (para company_admin) ---\n    const handleAddCompanyUser = async (e) => {\n        e.preventDefault();\n        if (!newCompanyUserUsername || !newCompanyUserPassword || !newCompanyUserRole) {\n            showMessage(\"Preencha todos os campos para adicionar o usuário!\", \"error\");\n            return;\n        }\n        if (!currentUser || !currentUser.username || !firebaseAuth || !firebaseAuth.currentUser) {\n            showMessage(\"Erro: Administrador da empresa não identificado ou não autenticado.\", \"error\");\n            return;\n        }\n        console.log(\"Tentando adicionar usuário da empresa...\");\n\n        try {\n            const idToken = await firebaseAuth.currentUser.getIdToken();\n            const response = await fetch(`${FLASK_BACKEND_URL}/company_users/add`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${idToken}`\n                },\n                body: JSON.stringify({\n                    company_id: currentUser.username,\n                    username: newCompanyUserUsername,\n                    password: newCompanyUserPassword,\n                    role: newCompanyUserRole\n                }),\n            });\n\n            const data = await response.json();\n            console.log(\"Dados da resposta de adição de usuário da empresa:\", data);\n\n            if (response.ok) {\n                showMessage(`Usuário \"${data.username}\" (${data.role}) adicionado com sucesso!`, 'success');\n                setNewCompanyUserUsername('');\n                setNewCompanyUserPassword('');\n                setNewCompanyUserRole('caixa');\n            } else {\n                showMessage(`Erro ao adicionar usuário: ${data.error || 'Erro desconhecido'}`, \"error\");\n            }\n        } catch (e) {\n            console.error(\"Erro ao adicionar usuário da empresa: \", e);\n            showMessage(\"Erro ao conectar ao servidor para adicionar usuário.\", \"error\");\n        }\n    };\n\n    const handleEditCompanyUser = (user) => {\n        setEditingCompanyUser(user);\n        setNewCompanyUserUsername(user.username);\n        setNewCompanyUserRole(user.role);\n        setNewCompanyUserPassword(''); // Não carrega a senha por segurança\n    };\n\n    const handleUpdateCompanyUser = async (e) => {\n        e.preventDefault();\n        if (!editingCompanyUser || !newCompanyUserUsername || !newCompanyUserRole) {\n            showMessage(\"Preencha todos os campos para atualizar o usuário!\", \"error\");\n            return;\n        }\n        if (!currentUser || !currentUser.username || !firebaseAuth || !firebaseAuth.currentUser) {\n            showMessage(\"Erro: Administrador da empresa não identificado ou não autenticado.\", \"error\");\n            return;\n        }\n        console.log(\"Tentando atualizar usuário da empresa:\", editingCompanyUser.id);\n\n        try {\n            const idToken = await firebaseAuth.currentUser.getIdToken();\n            const response = await fetch(`${FLASK_BACKEND_URL}/company_users/update`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${idToken}`\n                },\n                body: JSON.stringify({\n                    company_id: currentUser.username,\n                    user_id: editingCompanyUser.id, // O ID do documento do usuário no Firestore (que é o firebase_uid)\n                    username: newCompanyUserUsername,\n                    password: newCompanyUserPassword || null, // Envia null se a senha não for alterada\n                    role: newCompanyUserRole\n                }),\n            });\n\n            const data = await response.json();\n            console.log(\"Dados da resposta de atualização de usuário da empresa:\", data);\n\n            if (response.ok) {\n                showMessage(`Usuário \"${data.username}\" atualizado com sucesso!`, 'success');\n                setEditingCompanyUser(null);\n                setNewCompanyUserUsername('');\n                setNewCompanyUserPassword('');\n                setNewCompanyUserRole('caixa');\n            } else {\n                showMessage(`Erro ao atualizar usuário: ${data.error || 'Erro desconhecido'}`, \"error\");\n            }\n        } catch (e) {\n            console.error(\"Erro ao atualizar usuário da empresa: \", e);\n            showMessage(\"Erro ao conectar ao servidor para atualizar usuário.\", \"error\");\n        }\n    };\n\n    const handleDeleteCompanyUser = async (userIdToDelete) => {\n        if (!currentUser || !currentUser.username || !firebaseAuth || !firebaseAuth.currentUser) {\n            showMessage(\"Erro: Administrador da empresa não identificado ou não autenticado.\", \"error\");\n            setShowConfirmModal(false);\n            return;\n        }\n        setConfirmModalMessage(`Tem certeza que deseja excluir o usuário ${userIdToDelete}? Esta ação é irreversível!`);\n        setConfirmModalAction(() => async () => {\n            console.log(\"Tentando excluir usuário da empresa:\", userIdToDelete);\n            try {\n                const idToken = await firebaseAuth.currentUser.getIdToken();\n                const response = await fetch(`${FLASK_BACKEND_URL}/company_users/delete`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${idToken}`\n                    },\n                    body: JSON.stringify({\n                        company_id: currentUser.username,\n                        user_id: userIdToDelete // O ID do documento do usuário no Firestore (que é o firebase_uid)\n                    }),\n                });\n\n                const data = await response.json();\n                console.log(\"Dados da resposta de exclusão de usuário da empresa:\", data);\n\n                if (response.ok) {\n                    showMessage(`Usuário \"${userIdToDelete}\" excluído com sucesso!`, 'success');\n                } else {\n                    showMessage(`Erro ao excluir usuário: ${data.error || 'Erro desconhecido'}`, \"error\");\n                }\n            } catch (e) {\n                console.error(\"Erro ao excluir usuário da empresa:\", e);\n                showMessage(\"Erro ao conectar ao servidor para excluir usuário.\", \"error\");\n            } finally {\n                setShowConfirmModal(false);\n            }\n        });\n        setConfirmModalPayload(userIdToDelete);\n        setShowConfirmModal(true);\n    };\n\n    const cancelEditCompanyUser = () => {\n        setEditingCompanyUser(null);\n        setNewCompanyUserUsername('');\n        setNewCompanyUserPassword('');\n        setNewCompanyUserRole('caixa');\n    };\n\n    // Função para copiar a chave Pix para a área de transferência\n    const copyPixKeyToClipboard = (key) => {\n        // Usa document.execCommand('copy') para compatibilidade em iframes\n        const el = document.createElement('textarea');\n        el.value = key;\n        document.body.appendChild(el);\n        el.select();\n        try {\n            document.execCommand('copy');\n            showMessage(\"Chave Pix copiada!\", \"success\");\n        } catch (err) {\n            console.error('Erro ao copiar chave Pix:', err);\n            showMessage(\"Falha ao copiar chave Pix.\", \"error\");\n        }\n        document.body.removeChild(el);\n    };\n\n    // Função para cancelar pagamento Pix\n    const handleCancelPixPayment = async (paymentId) => {\n        if (!currentUser || !currentUser.username || !firebaseAuth || !firebaseAuth.currentUser) {\n            showMessage(\"Erro: Usuário da empresa não identificado para cancelar Pix.\", \"error\");\n            setShowConfirmModal(false);\n            return;\n        }\n        setConfirmModalMessage(`Tem certeza que deseja cancelar o pagamento Pix com ID ${paymentId}?`);\n        setConfirmModalAction(() => async () => {\n            console.log(\"Tentando cancelar pagamento Pix:\", paymentId);\n\n            try {\n                const idToken = await firebaseAuth.currentUser.getIdToken();\n                const response = await fetch(`${FLASK_BACKEND_URL}/pix/cancel`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Authorization': `Bearer ${idToken}`\n                    },\n                    body: JSON.stringify({\n                        payment_id: paymentId,\n                        company_username: currentUser.username\n                    }),\n                });\n\n                const data = await response.json();\n                console.log(\"Dados da resposta de cancelamento de Pix:\", data);\n\n                if (response.ok) {\n                    showMessage(`Pagamento Pix ${paymentId} cancelado com sucesso!`, 'success');\n                    // Opcional: Atualizar o status da venda no Firestore no frontend, se necessário\n                    // Ou confiar no webhook do Mercado Pago para fazer isso\n                } else {\n                    showMessage(`Erro ao cancelar Pix: ${data.error || 'Erro desconhecido'}`, \"error\");\n                }\n            } catch (error) {\n                console.error('Erro ao conectar ao servidor para cancelar Pix:', error);\n                showMessage('Erro ao conectar ao servidor para cancelar Pix.', \"error\");\n            } finally {\n                setShowConfirmModal(false);\n            }\n        });\n        setConfirmModalPayload(paymentId);\n        setShowConfirmModal(true);\n    };\n\n    // Filtra produtos com base no termo de pesquisa\n    const filteredProducts = products.filter(product =>\n        product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        product.id.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n\n    // Função auxiliar para obter classes Tailwind de forma segura com base no tema\n    const getThemeClasses = (element) => {\n        const theme = currentUser?.design || DEFAULT_THEMES.default;\n\n        const getColorClass = (prop, defaultColor) => {\n            const color = theme[prop];\n            if (color && typeof color === 'string' && color.includes('-')) {\n                return color; // Já é uma classe Tailwind completa como 'bg-blue-500'\n            }\n            // Fallback para uma classe de cor Tailwind padrão\n            return defaultColor;\n        };\n\n        switch (element) {\n            case 'gradient_bg': return `bg-gradient-to-br ${getColorClass('gradient_from', 'from-blue-50')} ${getColorClass('gradient_to', 'to-indigo-100')}`;\n            case 'primary_button_bg': return getColorClass('primary_button_bg', 'bg-blue-600');\n            case 'primary_button_hover_bg': return getColorClass('primary_button_hover_bg', 'hover:bg-blue-700');\n            case 'secondary_button_bg': return getColorClass('secondary_button_bg', 'bg-gray-200');\n            case 'secondary_button_text': return getColorClass('secondary_button_text', 'text-gray-700');\n            case 'secondary_button_hover_bg': return getColorClass('secondary_button_hover_bg', 'hover:bg-gray-100');\n            case 'text_color_strong': return getColorClass('text_color_strong', 'text-gray-800');\n            case 'text_color_medium': return getColorClass('text_color_medium', 'text-gray-700');\n            case 'border_color': return getColorClass('border_color', 'border-blue-200');\n            case 'highlight_color': return getColorClass('highlight_color', 'text-blue-600');\n            case 'success_color': return getColorClass('success_color', 'bg-green-500');\n            case 'error_color': return getColorClass('error_color', 'bg-red-500');\n            case 'font_family': return theme.font_family || 'font-sans';\n            case 'dominant_color_bg': return getColorClass('dominant_color', 'bg-blue-50');\n            default: return '';\n        }\n    };\n\n    // Efeito para escutar atualizações do status Pix da venda pendente\n    useEffect(() => {\n        if (\n            firestoreDb &&\n            currentUser &&\n            pixQrCodeData &&\n            pixQrCodeData.sale_id_frontend // O sale_id gerado no frontend\n        ) {\n            // Referência ao documento da venda Pix pendente\n            const saleDocRef = doc(\n                firestoreDb,\n                `artifacts/${appId}/users/${currentUser.username}/sales`,\n                pixQrCodeData.sale_id_frontend\n            );\n            // Listener para o documento da venda Pix\n            const unsubscribe = onSnapshot(saleDocRef, (docSnap) => {\n                if (docSnap.exists()) {\n                    const saleData = docSnap.data();\n                    if (saleData.status !== pixStatus) {\n                        setPixStatus(saleData.status);\n                        // Notifica o usuário sobre a mudança de status\n                        if (saleData.status === 'approved') {\n                            showMessage('Pagamento Pix aprovado! Venda finalizada.', 'success');\n                            // Limpa carrinho e estados relacionados\n                            setCart([]);\n                            setPaymentAmount('');\n                            setChange(0);\n                            setDifference(0);\n                            setPaymentMethod('Dinheiro');\n                            setPixQrCodeData(null);\n                            setPixStatus(null);\n                        } else if (saleData.status === 'cancelled') {\n                            showMessage('Pagamento Pix cancelado.', 'error');\n                            setPixQrCodeData(null);\n                            setPixStatus(null);\n                        } else if (saleData.status === 'pending') {\n                            showMessage('Aguardando pagamento Pix...', 'info');\n                        }\n                    }\n                }\n            });\n            return () => unsubscribe();\n        }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [firestoreDb, currentUser, pixQrCodeData]);\n\n    // Renderiza a tela de login se o usuário não estiver logado\n    if (!isLoggedIn) {\n        return (\n            <div className=\"relative min-h-screen flex flex-col items-center justify-center overflow-hidden bg-gray-800\">\n                {/* Vídeo de fundo para a tela de login */}\n                <video\n                    autoPlay\n                    loop={true}\n                    muted\n                    playsInline\n                    className=\"absolute z-0 w-full h-full object-cover\"\n                    src=\"https://videos.pexels.com/video-files/3752548/3752548-hd_1920_1080_24fps.mp4\"\n                    onError={(e) => console.error(\"Erro ao carregar o vídeo de fundo da tela de login:\", e)}\n                >\n                    Seu navegador não suporta a tag de vídeo.\n                </video>\n\n                {/* Overlay para legibilidade */}\n                <div className=\"absolute z-10 w-full h-full bg-black opacity-50\"></div>\n\n                {message && (\n                    <div className={`fixed top-4 right-4 p-3 rounded-lg shadow-lg text-white z-50 transition-opacity duration-300 ${message.type === 'success' ? getThemeClasses('success_color') : getThemeClasses('error_color')}`}>\n                        {message.text}\n                    </div>\n                )}\n                <div className=\"relative z-20 bg-white p-8 rounded-2xl shadow-xl w-full max-w-md\">\n                    <h2 className=\"text-3xl font-bold text-gray-800 mb-6 text-center\">\n                        Login\n                    </h2>\n                    <form onSubmit={handleLogin}>\n                        <div className=\"mb-4\">\n                            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"loginUsername\">\n                                Nome de Usuário:\n                            </label>\n                            <input\n                                className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                                id=\"loginUsername\"\n                                type=\"text\"\n                                placeholder=\"Nome de Usuário\"\n                                value={loginUsername}\n                                onChange={(e) => setLoginUsername(e.target.value)}\n                                required\n                            />\n                        </div>\n                        <div className=\"mb-6\">\n                            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"loginPassword\">\n                                Senha:\n                            </label>\n                            <input\n                                className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline\"\n                                id=\"loginPassword\"\n                                type=\"password\"\n                                placeholder=\"********\"\n                                value={loginPassword}\n                                onChange={(e) => setLoginPassword(e.target.value)}\n                                required\n                            />\n                        </div>\n                        <div className=\"flex items-center justify-center\">\n                            <button\n                                className=\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition-colors duration-200\"\n                                type=\"submit\"\n                            >\n                                Entrar\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        );\n    }\n\n    // Renderiza a aplicação principal se o usuário estiver logado\n    const currentDesign = currentUser?.design || DEFAULT_THEMES.default; // Garante que currentDesign não seja nulo\n\n    // Determina se o vídeo de fundo da aba \"Gerenciar Empresas\" deve estar ativo\n    const showCompanyManagementVideo = isLoggedIn && activeTab === 'gerenciar_empresas' && currentUser?.role === 'admin';\n\n    // Define o estilo de fundo dinamicamente (cores/gradiente)\n    const backgroundClasses = currentDesign.dominant_color\n        ? `${currentDesign.dominant_color}`\n        : `${currentDesign.gradient_from || 'from-blue-50'} ${currentDesign.gradient_to || 'to-indigo-100'}`;\n\n    return (\n        <div\n            className={`min-h-screen p-4 ${getThemeClasses('font_family')} flex flex-col items-center relative`}\n        >\n            {/* Fundo de vídeo para a aba \"Gerenciar Empresas\" */}\n            {showCompanyManagementVideo ? (\n                <>\n                    <video\n                        autoPlay\n                        loop={true}\n                        muted\n                        playsInline\n                        className=\"absolute z-0 w-full h-full object-cover top-0 left-0\"\n                        src=\"https://videos.pexels.com/video-files/30163656/12934691_1920_1080_30fps.mp4\"\n                        onError={(e) => console.error(\"Erro ao carregar o vídeo de fundo de Gerenciar Empresas:\", e)}\n                    >\n                        Seu navegador não suporta a tag de vídeo para o fundo de gerenciamento de empresas.\n                    </video>\n                    <div className=\"absolute z-10 w-full h-full bg-black opacity-50 top-0 left-0\"></div>\n                </>\n            ) : (\n                // Fundo de cor/gradiente para as outras abas\n                <div className={`absolute z-0 w-full h-full top-0 left-0 ${backgroundClasses}`}></div>\n            )}\n\n            {/* Todo o conteúdo da aplicação com um z-index maior para ficar acima do fundo */}\n            <div className=\"relative z-20 w-full flex flex-col items-center\">\n                {/* Exibição do ID do Usuário */}\n                {currentUser && (\n                    <div className=\"absolute top-4 left-4 bg-white p-2 rounded-lg shadow-md text-sm text-gray-700\">\n                        Usuário Logado: <span className=\"font-semibold\">{currentUser.username}</span> (Função: {currentUser.role})\n                        {currentUser.company_name && (\n                            <span className=\"ml-2\">Empresa: {currentUser.company_name}</span>\n                        )}\n                        <button\n                            onClick={handleLogout}\n                            className=\"ml-4 bg-red-500 hover:bg-red-600 text-white text-xs px-2 py-1 rounded-full transition-colors duration-200\"\n                        >\n                            Sair\n                        </button>\n                    </div>\n                )}\n\n                {/* Caixa de Mensagens */}\n                {message && (\n                    <div className={`fixed top-4 right-4 p-3 rounded-lg shadow-lg text-white z-50 transition-opacity duration-300 ${message.type === 'success' ? getThemeClasses('success_color') : getThemeClasses('error_color')}`}>\n                        {message.text}\n                    </div>\n                )}\n\n                <h1 className={`text-4xl font-extrabold ${getThemeClasses('text_color_strong')} mb-8 mt-4 rounded-xl p-3 bg-white shadow-lg`}>\n                    Gerenciador de Caixa\n                </h1>\n\n                {/* Abas de Navegação */}\n                <div className=\"flex space-x-4 mb-8 bg-white p-2 rounded-full shadow-md\">\n                    {/* Aba Caixa - Visível para company_admin, gerente, caixa */}\n                    {(currentUser.role === 'company_admin' || currentUser.role === 'gerente' || currentUser.role === 'caixa') && (\n                        <button\n                            onClick={() => setActiveTab('caixa')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'caixa' ? `${getThemeClasses('primary_button_bg')} text-white shadow-lg` : `${getThemeClasses('secondary_button_bg')} ${getThemeClasses('secondary_button_text')} ${getThemeClasses('secondary_button_hover_bg')}`}`}\n                        >\n                            Caixa\n                        </button>\n                    )}\n                    {/* Aba Produtos - Visível para company_admin e gerente */}\n                    {(currentUser.role === 'company_admin' || currentUser.role === 'gerente') && (\n                        <button\n                            onClick={() => setActiveTab('produtos')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'produtos' ? `${getThemeClasses('primary_button_bg')} text-white shadow-lg` : `${getThemeClasses('secondary_button_bg')} ${getThemeClasses('secondary_button_text')} ${getThemeClasses('secondary_button_hover_bg')}`}`}\n                        >\n                            Produtos\n                        </button>\n                    )}\n                    {/* Aba Relatórios - Visível para company_admin e gerente */}\n                    {(currentUser.role === 'company_admin' || currentUser.role === 'gerente') && (\n                        <button\n                            onClick={() => setActiveTab('relatorios')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'relatorios' ? `${getThemeClasses('primary_button_bg')} text-white shadow-lg` : `${getThemeClasses('secondary_button_bg')} ${getThemeClasses('secondary_button_text')} ${getThemeClasses('secondary_button_hover_bg')}`}`}\n                        >\n                            Relatórios\n                        </button>\n                    )}\n                    {/* Aba Gerenciar Usuários - Visível APENAS para company_admin */}\n                    {currentUser.role === 'company_admin' && (\n                        <button\n                            onClick={() => setActiveTab('gerenciar_usuarios')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'gerenciar_usuarios' ? `${getThemeClasses('primary_button_bg')} text-white shadow-lg` : `${getThemeClasses('secondary_button_bg')} ${getThemeClasses('secondary_button_text')} ${getThemeClasses('secondary_button_hover_bg')}`}`}\n                        >\n                            Gerenciar Usuários\n                        </button>\n                    )}\n                    {/* Aba Gerenciar Empresas - Visível APENAS para o admin principal */}\n                    {currentUser.role === 'admin' && (\n                        <button\n                            onClick={() => setActiveTab('gerenciar_empresas')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'gerenciar_empresas' ? `${getThemeClasses('primary_button_bg')} text-white shadow-lg` : `${getThemeClasses('secondary_button_bg')} ${getThemeClasses('secondary_button_text')} ${getThemeClasses('secondary_button_hover_bg')}`}`}\n                        >\n                            Gerenciar Empresas\n                        </button>\n                    )}\n                </div>\n\n                {/* Conteúdo da Aba Caixa (Visível para company_admin, gerente, caixa) */}\n                {(activeTab === 'caixa' && (currentUser.role === 'company_admin' || currentUser.role === 'gerente' || currentUser.role === 'caixa')) && (\n                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8 w-full max-w-7xl\">\n                        {/* Lista de Produtos */}\n                        <div className=\"lg:col-span-1 bg-white p-6 rounded-2xl shadow-xl\">\n                            <h2 className={`text-2xl font-bold ${getThemeClasses('text_color_medium')} mb-4 pb-2 border-b-2 ${getThemeClasses('border_color')}`}>\n                                Produtos Disponíveis\n                            </h2>\n                            {/* Barra de Pesquisa */}\n                            <div className=\"mb-4\">\n                                <input\n                                    type=\"text\"\n                                    placeholder=\"Pesquisar produto por nome ou ID...\"\n                                    value={searchTerm}\n                                    onChange={(e) => setSearchTerm(e.target.value)}\n                                    className=\"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                            <div className=\"max-h-96 overflow-y-auto\">\n                                {filteredProducts.length === 0 ? (\n                                    <p className=\"text-gray-500\">Nenhum produto encontrado ou registrado.</p>\n                                ) : (\n                                    filteredProducts.map(product => (\n                                        <div key={product.id} className=\"flex justify-between items-center bg-gray-50 p-3 mb-2 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${getThemeClasses('text_color_strong')}`}>{product.name} (ID: {product.id})</p>\n                                                <p className={`${getThemeClasses('highlight_color')} font-bold`}>R$ {product.value.toFixed(2)}</p>\n                                            </div>\n                                            <button\n                                                onClick={() => addToCart(product)}\n                                                className={`bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md`}\n                                            >\n                                                Adicionar\n                                            </button>\n                                        </div>\n                                    ))\n                                )}\n                            </div>\n                        </div>\n\n                        {/* Carrinho e Pagamento */}\n                        <div className=\"lg:col-span-2 bg-white p-6 rounded-2xl shadow-xl flex flex-col\">\n                            <h2 className={`text-2xl font-bold ${getThemeClasses('text_color_medium')} mb-4 pb-2 border-b-2 ${getThemeClasses('border_color')}`}>\n                                Carrinho de Compras\n                            </h2>\n                            <div className=\"flex-grow max-h-80 overflow-y-auto mb-4\">\n                                {cart.length === 0 ? (\n                                    <p className=\"text-gray-500\">O carrinho está vazio.</p>\n                                ) : (\n                                    cart.map(item => (\n                                        <div key={item.id} className=\"flex justify-between items-center bg-gray-50 p-3 mb-2 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${getThemeClasses('text_color_strong')}`}>{item.name}</p>\n                                                <p className=\"text-gray-600\">R$ {item.value.toFixed(2)} x {item.quantity}</p>\n                                            </div>\n                                            <div className=\"flex items-center space-x-2\">\n                                                <button\n                                                    onClick={() => decreaseQuantity(item.id)}\n                                                    className=\"bg-red-400 hover:bg-red-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold\"\n                                                >\n                                                    -\n                                                </button>\n                                                <span className=\"font-bold text-lg\">{item.quantity}</span>\n                                                <button\n                                                    onClick={() => increaseQuantity(item.id)}\n                                                    className=\"bg-green-400 hover:bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold\"\n                                                >\n                                                    +\n                                                </button>\n                                                <button\n                                                    onClick={() => removeFromCart(item.id)}\n                                                    className=\"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-full text-sm shadow-md\"\n                                                >\n                                                    Remover\n                                                </button>\n                                            </div>\n                                        </div>\n                                    ))\n                                )}\n                            </div>\n\n                            <div className={`mt-auto pt-4 border-t-2 ${getThemeClasses('border_color')}`}>\n                                <div className={`flex justify-between items-center text-2xl font-bold ${getThemeClasses('text_color_strong')} mb-4`}>\n                                    <span>Total:</span>\n                                    <span>R$ {total.toFixed(2)}</span>\n                                </div>\n\n                                <div className=\"mb-4\">\n                                    <label htmlFor=\"paymentMethod\" className={`block ${getThemeClasses('text_color_medium')} text-lg font-semibold mb-2`}>Método de Pagamento:</label>\n                                    <select\n                                        id=\"paymentMethod\"\n                                        value={paymentMethod}\n                                        onChange={(e) => {\n                                            setPaymentMethod(e.target.value);\n                                            setPixQrCodeData(null); // Limpa dados do Pix ao mudar o método\n                                        }}\n                                        className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg\"\n                                    >\n                                        <option value=\"Dinheiro\">Dinheiro</option>\n                                        <option value=\"Cartao\">Cartão</option>\n                                        <option value=\"Pix\">Pix</option>\n                                    </select>\n                                </div>\n\n                                {paymentMethod === 'Dinheiro' && (\n                                    <div className=\"mb-4\">\n                                        <label htmlFor=\"paymentAmount\" className={`block ${getThemeClasses('text_color_medium')} text-lg font-semibold mb-2`}>Valor Pago:</label>\n                                        <input\n                                            type=\"number\"\n                                            id=\"paymentAmount\"\n                                            value={paymentAmount}\n                                            onChange={(e) => setPaymentAmount(e.target.value)}\n                                            placeholder=\"R$ 0.00\"\n                                            step=\"0.01\"\n                                            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg\"\n                                        />\n                                    </div>\n                                )}\n\n                                {paymentMethod === 'Pix' && (\n                                    <div className=\"mb-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200 text-yellow-800\">\n                                        <p className=\"font-semibold\">Funcionalidade Pix:</p>\n                                        <p className=\"text-sm\">\n                                            Para gerar o QR Code Pix, o aplicativo fará uma requisição ao seu backend Flask.\n                                        </p>\n                                        {/* Mostra status do Pix se houver */}\n                                        {pixStatus && (\n                                            <div className=\"my-2\">\n                                                {pixStatus === 'pending' && (\n                                                    <span className=\"text-yellow-600 font-semibold\">Status: Aguardando pagamento...</span>\n                                                )}\n                                                {pixStatus === 'approved' && (\n                                                    <span className=\"text-green-600 font-semibold\">Status: Pagamento aprovado!</span>\n                                                )}\n                                                {pixStatus === 'cancelled' && (\n                                                    <span className=\"text-red-600 font-semibold\">Status: Pagamento cancelado.</span>\n                                                )}\n                                            </div>\n                                        )}\n                                        {isLoadingPix ? (\n                                            <div className=\"flex justify-center items-center py-4\">\n                                                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500\"></div>\n                                                <p className=\"ml-3\">Gerando QR Code...</p>\n                                            </div>\n                                        ) : pixQrCodeData ? (\n                                            <div className=\"mt-3 text-center\">\n                                                {/* Imagem do QR Code (usando base64 do backend) */}\n                                                <img\n                                                    src={pixQrCodeData.qr_code_base64 || `https://placehold.co/150x150/E0F2F7/000000?text=QR+Code+Pix`}\n                                                    alt=\"QR Code Pix\"\n                                                    className=\"mx-auto rounded-lg shadow-md w-64 h-64\"\n                                                />\n                                                <p className=\"mt-2 text-sm text-gray-700\">\n                                                    Chave \"Copia e Cola\":\n                                                </p>\n                                                <div className=\"flex items-center justify-center mt-1\">\n                                                    <input\n                                                        type=\"text\"\n                                                        readOnly\n                                                        value={pixQrCodeData.copy_paste_key}\n                                                        className=\"flex-grow p-2 border border-gray-300 rounded-l-lg text-sm bg-gray-100\"\n                                                    />\n                                                    <button\n                                                        onClick={() => copyPixKeyToClipboard(pixQrCodeData.copy_paste_key)}\n                                                        className=\"bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-r-lg text-sm\"\n                                                    >\n                                                        Copiar\n                                                    </button>\n                                                </div>\n                                                {/* Botão para Cancelar Pagamento Pix */}\n                                                {pixQrCodeData.payment_id && (\n                                                    <button\n                                                        onClick={() => handleCancelPixPayment(pixQrCodeData.payment_id)}\n                                                        className=\"mt-4 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm shadow-md\"\n                                                    >\n                                                        Cancelar Pagamento Pix\n                                                    </button>\n                                                )}\n                                                <p className=\"mt-2 text-xs text-gray-600\">\n                                                    * Em um cenário real, a venda seria finalizada após a confirmação do pagamento Pix via webhook.\n                                                </p>\n                                            </div>\n                                        ) : (\n                                            <div className=\"mt-3 text-center\">\n                                                {/* Placeholder para QR Code antes da geração */}\n                                                <img\n                                                    src=\"https://placehold.co/150x150/E0F2F7/000000?text=QR+Code+Pix\"\n                                                    alt=\"Placeholder QR Code Pix\"\n                                                    className=\"mx-auto rounded-lg shadow-md w-64 h-64\"\n                                                />\n                                                <p className=\"mt-2 text-xs text-gray-600\">\n                                                    Clique em \"Finalizar Venda\" para gerar o QR Code.\n                                                </p>\n                                            </div>\n                                        )}\n                                    </div>\n                                )}\n\n                                <div className={`flex justify-between items-center text-xl ${getThemeClasses('text_color_medium')} mb-2`}>\n                                    <span>Diferença:</span>\n                                    <span className=\"font-bold text-red-600\">R$ {difference.toFixed(2)}</span>\n                                </div>\n                                <div className={`flex justify-between items-center text-xl ${getThemeClasses('text_color_medium')} mb-4`}>\n                                    <span>Troco:</span>\n                                    <span className=\"font-bold text-green-600\">R$ {change.toFixed(2)}</span>\n                                </div>\n\n                                <button\n                                    onClick={finalizeSale}\n                                    className={`w-full ${getThemeClasses('primary_button_bg')} ${getThemeClasses('primary_button_hover_bg')} text-white text-xl font-bold py-4 rounded-xl transition-all duration-300 shadow-lg transform hover:scale-105`}\n                                >\n                                    Finalizar Venda\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                )}\n\n                {/* Conteúdo da Aba Produtos (Visível para company_admin e gerente) */}\n                {(activeTab === 'produtos' && (currentUser.role === 'company_admin' || currentUser.role === 'gerente')) && (\n                    <div className=\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\">\n                        <h2 className={`text-3xl font-bold ${getThemeClasses('text_color_medium')} mb-6 pb-3 border-b-2 ${getThemeClasses('border_color')}`}>\n                            {editingProduct ? 'Editar Produto' : 'Adicionar Novo Produto'}\n                        </h2>\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n                            <div>\n                                <label htmlFor=\"newProductId\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>ID do Produto:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newProductId\"\n                                    value={newProductId}\n                                    onChange={(e) => setNewProductId(e.target.value)}\n                                    placeholder=\"Ex: PROD001\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    disabled={!!editingProduct} // Desabilita a entrada de ID ao editar\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newProductName\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Nome do Produto:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newProductName\"\n                                    value={newProductName}\n                                    onChange={(e) => setNewProductName(e.target.value)}\n                                    placeholder=\"Ex: Refrigerante\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newProductValue\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Valor (R$):</label>\n                                <input\n                                    type=\"number\"\n                                    id=\"newProductValue\"\n                                    value={newProductValue}\n                                    onChange={(e) => setNewProductValue(e.target.value)}\n                                    placeholder=\"Ex: 5.50\"\n                                    step=\"0.01\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                            {/* Campo para Custo do Produto */}\n                            <div>\n                                <label htmlFor=\"newProductCost\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Custo (R$):</label>\n                                <input\n                                    type=\"number\"\n                                    id=\"newProductCost\"\n                                    value={newProductCost}\n                                    onChange={(e) => setNewProductCost(e.target.value)}\n                                    placeholder=\"Ex: 2.00\"\n                                    step=\"0.01\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                        </div>\n                        <div className=\"flex justify-end space-x-4\">\n                            {editingProduct ? (\n                                <>\n                                    <button\n                                        onClick={handleUpdateProduct}\n                                        className={`bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                    >\n                                        Atualizar Produto\n                                    </button>\n                                    <button\n                                        onClick={cancelEdit}\n                                        className={`bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                    >\n                                        Cancelar\n                                    </button>\n                                </>\n                            ) : (\n                                <button\n                                    onClick={handleAddProduct}\n                                    className={`${getThemeClasses('primary_button_bg')} ${getThemeClasses('primary_button_hover_bg')} text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                >\n                                    Adicionar Produto\n                                </button>\n                            )}\n                        </div>\n\n                        <h3 className={`text-2xl font-bold ${getThemeClasses('text_color_medium')} mt-10 mb-4 pb-2 border-b-2 ${getThemeClasses('border_color')}`}>\n                            Lista de Produtos\n                        </h3>\n                        <div className=\"max-h-96 overflow-y-auto\">\n                            {products.length === 0 ? (\n                                <p className=\"text-gray-500\">Nenhum produto registrado.</p>\n                            ) : (\n                                <ul className=\"space-y-3\">\n                                    {products.map(product => (\n                                        <li key={product.id} className=\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${getThemeClasses('text_color_strong')} text-lg`}>Produto: {product.name} (ID: {product.id})</p>\n                                                <p className={`${getThemeClasses('highlight_color')} font-bold text-xl`}>R$ {product.value.toFixed(2)}</p>\n                                                <p className=\"text-gray-600 text-sm\">Custo: R$ {product.cost ? product.cost.toFixed(2) : '0.00'}</p>\n                                            </div>\n                                            <div className=\"flex space-x-3\">\n                                                <button\n                                                    onClick={() => handleEditProduct(product)}\n                                                    className=\"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Editar\n                                                </button>\n                                                <button\n                                                    onClick={() => handleDeleteProduct(product.id)}\n                                                    className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Excluir\n                                                </button>\n                                            </div>\n                                        </li>\n                                    ))}\n                                </ul>\n                            )}\n                        </div>\n                    </div>\n                )}\n\n                {/* Conteúdo da Aba Relatórios (Visível para company_admin e gerente) */}\n                {(activeTab === 'relatorios' && (currentUser.role === 'company_admin' || currentUser.role === 'gerente')) && (\n                    <div className=\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\">\n                        <h2 className={`text-3xl font-bold ${getThemeClasses('text_color_medium')} mb-6 pb-3 border-b-2 ${getThemeClasses('border_color')}`}>\n                            Relatório de Lucro Semanal\n                        </h2>\n                        {sales.length === 0 ? (\n                            <p className=\"text-gray-500\">Nenhuma venda registrada ainda.</p>\n                        ) : (\n                            <div className=\"max-h-96 overflow-y-auto\">\n                                <table className=\"min-w-full bg-white rounded-lg shadow-md\">\n                                    <thead className={`${getThemeClasses('primary_button_bg')} text-white`}>\n                                        <tr>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Data</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Lucro Total</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody className=\"divide-y divide-gray-200\">\n                                        {getWeeklySales().map(([date, profit]) => (\n                                            <tr key={date} className=\"hover:bg-gray-50\">\n                                                <td className={`py-3 px-4 ${getThemeClasses('text_color_strong')}`}>\n                                                    {date}\n                                                </td>\n                                                <td className=\"py-3 px-4 text-green-600 font-bold\">R$ {profit.toFixed(2)}</td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                                {getWeeklySales().length === 0 && (\n                                    <p className=\"text-gray-500 mt-4\">Nenhuma venda na última semana.</p>\n                                )}\n                            </div>\n                        )}\n\n                        <h3 className={`text-2xl font-bold ${getThemeClasses('text_color_medium')} mt-10 mb-4 pb-2 border-b-2 ${getThemeClasses('border_color')}`}>\n                            Todas as Vendas\n                        </h3>\n                        <div className=\"max-h-96 overflow-y-auto\">\n                            {sales.length === 0 ? (\n                                <p className=\"text-gray-500\">Nenhuma venda registrada ainda.</p>\n                            ) : (\n                                <table className=\"min-w-full bg-white rounded-lg shadow-md\">\n                                    <thead className={`${getThemeClasses('primary_button_bg')} text-white`}>\n                                        <tr>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Data/Hora</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Itens</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Total</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Custo</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Lucro</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Método</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Status</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Ações</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody className=\"divide-y divide-gray-200\">\n                                        {sales.map(sale => (\n                                            <tr key={sale.id} className=\"hover:bg-gray-50\">\n                                                <td className={`py-3 px-4 ${getThemeClasses('text_color_strong')}`}>\n                                                    {sale.timestamp && typeof sale.timestamp.toDate === 'function' ? sale.timestamp.toDate().toLocaleString('pt-BR') : 'N/A'}\n                                                </td>\n                                                <td className={`py-3 px-4 ${getThemeClasses('text_color_medium')}`}>\n                                                    {sale.items.map(item => (\n                                                        <p key={item.productId}>{item.name} (x{item.quantity})</p>\n                                                    ))}\n                                                </td>\n                                                <td className=\"py-3 px-4 text-green-600 font-bold\">R$ {sale.total.toFixed(2)}</td>\n                                                <td className=\"py-3 px-4 text-gray-600\">R$ {(sale.costOfGoodsSold || 0).toFixed(2)}</td>\n                                                <td className=\"py-3 px-4 text-purple-600 font-bold\">R$ ${(sale.profit || (sale.total - (sale.costOfGoodsSold || 0))).toFixed(2)}</td>\n                                                <td className={`py-3 px-4 ${getThemeClasses('text_color_medium')}`}>{sale.paymentMethod}</td>\n                                                <td className={`py-3 px-4 ${getThemeClasses('text_color_medium')}`}>\n                                                    {sale.paymentMethod === 'Pix' && sale.status === 'pending' ? (\n                                                        <span className=\"text-yellow-600 font-semibold\">Pendente</span>\n                                                    ) : sale.paymentMethod === 'Pix' && sale.status === 'approved' ? (\n                                                        <span className=\"text-green-600 font-semibold\">Aprovado</span>\n                                                    ) : sale.paymentMethod === 'Pix' && sale.status === 'cancelled' ? (\n                                                        <span className=\"text-red-600 font-semibold\">Cancelado</span>\n                                                    ) : (\n                                                        <span className=\"text-gray-600\">N/A</span>\n                                                    )}\n                                                </td>\n                                                <td className=\"py-3 px-4\">\n                                                    {sale.paymentMethod === 'Pix' && sale.status === 'pending' && (\n                                                        <button\n                                                            onClick={() => handleCancelPixPayment(sale.payment_id)}\n                                                            className=\"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-full text-sm shadow-md\"\n                                                        >\n                                                            Cancelar Pix\n                                                        </button>\n                                                    )}\n                                                </td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                            )}\n                        </div>\n                    </div>\n                )}\n\n                {/* Conteúdo da Aba Gerenciar Usuários (Visível APENAS para company_admin) */}\n                {activeTab === 'gerenciar_usuarios' && currentUser.role === 'company_admin' && (\n                    <div className=\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\">\n                        <h2 className={`text-3xl font-bold ${getThemeClasses('text_color_medium')} mb-6 pb-3 border-b-2 ${getThemeClasses('border_color')}`}>\n                            {editingCompanyUser ? 'Editar Usuário da Empresa' : 'Adicionar Novo Usuário da Empresa'}\n                        </h2>\n                        <form onSubmit={editingCompanyUser ? handleUpdateCompanyUser : handleAddCompanyUser} className=\"space-y-4 mb-8\">\n                            <div>\n                                <label htmlFor=\"newCompanyUserUsername\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Nome de Usuário:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newCompanyUserUsername\"\n                                    value={newCompanyUserUsername}\n                                    onChange={(e) => setNewCompanyUserUsername(e.target.value)}\n                                    placeholder=\"Ex: caixa01\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                    disabled={!!editingCompanyUser} // Desabilita a edição do nome de usuário\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyUserPassword\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Senha:</label>\n                                <input\n                                    type=\"password\"\n                                    id=\"newCompanyUserPassword\"\n                                    value={newCompanyUserPassword}\n                                    onChange={(e) => setNewCompanyUserPassword(e.target.value)}\n                                    placeholder={editingCompanyUser ? \"Deixe em branco para manter a senha atual\" : \"********\"}\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required={!editingCompanyUser} // A senha é obrigatória apenas ao adicionar\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyUserRole\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Função:</label>\n                                <select\n                                    id=\"newCompanyUserRole\"\n                                    value={newCompanyUserRole}\n                                    onChange={(e) => setNewCompanyUserRole(e.target.value)}\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                >\n                                    <option value=\"caixa\">Caixa</option>\n                                    <option value=\"gerente\">Gerente</option>\n                                    {/* company_admin não pode criar outro company_admin */}\n                                </select>\n                            </div>\n                            <div className=\"flex justify-end space-x-4\">\n                                {editingCompanyUser ? (\n                                    <>\n                                        <button\n                                            type=\"submit\"\n                                            className={`bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                        >\n                                            Atualizar Usuário\n                                        </button>\n                                        <button\n                                            type=\"button\"\n                                            onClick={cancelEditCompanyUser}\n                                            className={`bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                        >\n                                            Cancelar\n                                        </button>\n                                    </>\n                                ) : (\n                                    <button\n                                        type=\"submit\"\n                                        className={`${getThemeClasses('primary_button_bg')} ${getThemeClasses('primary_button_hover_bg')} text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                >\n                                        Adicionar Usuário\n                                    </button>\n                                )}\n                            </div>\n                        </form>\n\n                        <h3 className={`text-2xl font-bold ${getThemeClasses('text_color_medium')} mt-10 mb-4 pb-2 border-b-2 ${getThemeClasses('border_color')}`}>\n                            Usuários da Empresa\n                        </h3>\n                        <div className=\"max-h-96 overflow-y-auto\">\n                            {companyUsers.length === 0 ? (\n                                <p className=\"text-gray-500\">Nenhum usuário registrado para esta empresa.</p>\n                            ) : (\n                                <ul className=\"space-y-3\">\n                                    {companyUsers.map(user => (\n                                        <li key={user.id} className=\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${getThemeClasses('text_color_strong')} text-lg`}>Usuário: {user.username}</p>\n                                                <p className=\"text-gray-600 text-sm\">Função: {user.role}</p>\n                                                {/* Opcional: Exibir firebase_uid para depuração */}\n                                                {/* <p className=\"text-gray-400 text-xs\">UID: {user.firebase_uid}</p> */}\n                                            </div>\n                                            <div className=\"flex space-x-3\">\n                                                <button\n                                                    onClick={() => handleEditCompanyUser(user)}\n                                                    className=\"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Editar\n                                                </button>\n                                                <button\n                                                    onClick={() => handleDeleteCompanyUser(user.id)}\n                                                    className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Excluir\n                                                </button>\n                                            </div>\n                                        </li>\n                                    ))}\n                                </ul>\n                            )}\n                        </div>\n                    </div>\n                )}\n\n                {/* Conteúdo da Aba Gerenciar Empresas (Visível APENAS para o admin principal) */}\n                {activeTab === 'gerenciar_empresas' && currentUser.role === 'admin' && (\n                    <div className=\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\">\n                        <h2 className={`text-3xl font-bold ${getThemeClasses('text_color_medium')} mb-6 pb-3 border-b-2 ${getThemeClasses('border_color')}`}>\n                            Registrar Nova Empresa\n                        </h2>\n                        <form onSubmit={handleRegisterCompany} className=\"space-y-4 mb-8\">\n                            <div>\n                                <label htmlFor=\"newCompanyUsername\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Nome de Usuário da Empresa (ID):</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newCompanyUsername\"\n                                    value={newCompanyUsername}\n                                    onChange={(e) => setNewCompanyUsername(e.target.value)}\n                                    placeholder=\"Ex: empresa_abc\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyPassword\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Senha da Empresa:</label>\n                                <input\n                                    type=\"password\"\n                                    id=\"newCompanyPassword\"\n                                    value={newCompanyPassword}\n                                    onChange={(e) => setNewCompanyPassword(e.target.value)}\n                                    placeholder=\"********\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyName\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Nome Completo da Empresa:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newCompanyName\"\n                                    value={newCompanyName}\n                                    onChange={(e) => setNewCompanyName(e.target.value)}\n                                    placeholder=\"Ex: ABC Comércio e Serviços Ltda.\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyDesignTheme\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Tema de Design (Cores/Fontes):</label>\n                                <select\n                                    id=\"newCompanyDesignTheme\"\n                                    value={newCompanyDesignTheme}\n                                    onChange={(e) => setNewCompanyDesignTheme(e.target.value)}\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                >\n                                    <option value=\"default\">Padrão</option>\n                                    <option value=\"corporate\">Corporativo</option>\n                                    <option value=\"vibrant\">Vibrante</option>\n                                </select>\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyMercadoPagoAccessToken\" className={`block ${getThemeClasses('text_color_medium')} font-semibold mb-2`}>Mercado Pago Access Token:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newCompanyMercadoPagoAccessToken\"\n                                    value={newCompanyMercadoPagoAccessToken}\n                                    onChange={(e) => setNewCompanyMercadoPagoAccessToken(e.target.value)}\n                                    placeholder=\"Token MP (ex: APP_USR-xxxxxxxxxxxx)\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                            <div className=\"flex justify-end\">\n                                <button\n                                    type=\"submit\"\n                                    onClick={handleRegisterCompany}\n                                    className={`bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                >\n                                    Registrar Empresa\n                                </button>\n                            </div>\n                        </form>\n\n                        <h3 className={`text-2xl font-bold ${getThemeClasses('text_color_medium')} mt-10 mb-4 pb-2 border-b-2 ${getThemeClasses('border_color')}`}>\n                            Empresas Registradas\n                        </h3>\n                        <div className=\"max-h-96 overflow-y-auto\">\n                            {companies.length === 0 ? (\n                                <p className=\"text-gray-500\">Nenhuma empresa registrada ainda.</p>\n                            ) : (\n                                <ul className=\"space-y-3\">\n                                    {companies.map(company => (\n                                        <li key={company.id} className=\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${getThemeClasses('text_color_strong')} text-lg`}>Nome: {company.company_name}</p>\n                                                <p className=\"text-gray-600 text-sm\">Usuário (ID): {company.id}</p>\n                                                <p className=\"text-gray-600 text-sm\">Tema: {company.design_theme}</p>\n                                            </div>\n                                            <div className=\"flex space-x-3\">\n                                                <button\n                                                    onClick={() => handleDeleteCompany(company.id)}\n                                                    className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Excluir Empresa\n                                                </button>\n                                            </div>\n                                        </li>\n                                    ))}\n                                </ul>\n                            )}\n                        </div>\n                    </div>\n                )}\n            </div>\n            {showConfirmModal && (\n                <ConfirmModal\n                    message={confirmModalMessage}\n                    onConfirm={() => {\n                        if (confirmModalAction) {\n                            confirmModalAction(confirmModalPayload);\n                        }\n                    }}\n                    onCancel={() => setShowConfirmModal(false)}\n                />\n            )}\n        </div>\n    );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}