{"ast":null,"code":"import _objectSpread from\"C:/Users/willi/OneDrive/Desktop/projetos/caixa/meu-app-de-caixa/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";/* global __app_id, __initial_auth_token */import React,{useState,useEffect,useRef}from'react';import{initializeApp}from'firebase/app';import{getAuth,signInWithCustomToken,onAuthStateChanged}from'firebase/auth';import{getFirestore,collection,addDoc,getDocs,onSnapshot,doc,updateDoc,deleteDoc,query,where,setDoc,getDoc}from'firebase/firestore';// Adicionado setDoc e getDoc\n// Removido: import { getStorage, ref, uploadBytes, getDownloadURL } from 'firebase/storage'; // Importa o Firebase Storage\n// Firebase configuration and initialization\n// Your specific Firebase project configuration is now hardcoded here for local development.\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const firebaseConfig={apiKey:\"AIzaSyDNIJRlw0mJP349owctGbO58VZWGa0LtQs\",authDomain:\"caixa-1bd0c.firebaseapp.com\",projectId:\"caixa-1bd0c\",storageBucket:\"caixa-1bd0c.firebaseastorage.app\",messagingSenderId:\"651091159828\",appId:\"1:651091159828:web:1043424c00f4e71bf97001\",measurementId:\"G-4NJ0F95DVJ\"};const app=initializeApp(firebaseConfig);const db=getFirestore(app);const auth=getAuth(app);// Removido: const storage = getStorage(app); // Inicializa o Firebase Storage\n// Global variables for app ID and initial auth token (from Canvas environment)\nconst appId=typeof __app_id!=='undefined'?__app_id:'local-app-id';const initialAuthToken=typeof __initial_auth_token!=='undefined'?initialAuthToken:null;// URL base do seu backend Flask\nconst FLASK_BACKEND_URL='http://127.0.0.1:5000';// Main App Component\nconst App=()=>{const[products,setProducts]=useState([]);const[cart,setCart]=useState([]);const[total,setTotal]=useState(0);const[paymentAmount,setPaymentAmount]=useState('');const[change,setChange]=useState(0);const[difference,setDifference]=useState(0);const[paymentMethod,setPaymentMethod]=useState('Dinheiro');const[sales,setSales]=useState([]);// Atualizado: 'caixa', 'produtos', 'relatorios', 'gerenciar_empresas', 'gerenciar_usuarios'\nconst[activeTab,setActiveTab]=useState('caixa');const[newProductName,setNewProductName]=useState('');const[newProductValue,setNewProductValue]=useState('');const[newProductCost,setNewProductCost]=useState('');const[newProductId,setNewProductId]=useState('');const[editingProduct,setEditingProduct]=useState(null);const[message,setMessage]=useState('');// Estados para autenticação via Flask backend\nconst[isLoggedIn,setIsLoggedIn]=useState(false);const[currentUser,setCurrentUser]=useState(null);// Armazena { username, role, company_name, design }\nconst[loginUsername,setLoginUsername]=useState('');const[loginPassword,setLoginPassword]=useState('');// Estados para Gerenciar Empresas (para o admin principal)\nconst[newCompanyUsername,setNewCompanyUsername]=useState('');const[newCompanyPassword,setNewCompanyPassword]=useState('');const[newCompanyName,setNewCompanyName]=useState('');const[newCompanyDesignTheme,setNewCompanyDesignTheme]=useState('default');const[newCompanyMercadoPagoAccessToken,setNewCompanyMercadoPagoAccessToken]=useState('');const[companies,setCompanies]=useState([]);// Estados para a funcionalidade Pix\nconst[pixQrCodeData,setPixQrCodeData]=useState(null);const[isLoadingPix,setIsLoadingPix]=useState(false);// Estado para o termo de pesquisa de produtos\nconst[searchTerm,setSearchTerm]=useState('');// NOVOS ESTADOS para Gerenciar Usuários da Empresa (para company_admin)\nconst[companyUsers,setCompanyUsers]=useState([]);// Lista de usuários da empresa\nconst[newCompanyUserUsername,setNewCompanyUserUsername]=useState('');const[newCompanyUserPassword,setNewCompanyUserPassword]=useState('');const[newCompanyUserRole,setNewCompanyUserRole]=useState('caixa');// 'caixa', 'gerente'\nconst[editingCompanyUser,setEditingCompanyUser]=useState(null);const messageTimeoutRef=useRef(null);// Function to display messages\nconst showMessage=function(msg){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'success';setMessage({text:msg,type});if(messageTimeoutRef.current){clearTimeout(messageTimeoutRef.current);}messageTimeoutRef.current=setTimeout(()=>{setMessage('');},3000);};// Firebase Authentication (agora usa o token personalizado do Flask)\nuseEffect(()=>{const unsubscribe=onAuthStateChanged(auth,user=>{if(user&&isLoggedIn&&currentUser&&user.uid===currentUser.username){console.log(\"Firebase Auth state changed: User is logged in with UID:\",user.uid);}else if(!user&&isLoggedIn){console.warn(\"Firebase Auth state changed: User logged in via Flask, but Firebase Auth is not.\");}else if(user&&!isLoggedIn){console.warn(\"Firebase Auth state changed: User logged in via Firebase, but not via Flask. (No auto-logout)\");}});return()=>unsubscribe();},[isLoggedIn,currentUser]);// Firestore Listeners for Products, Sales, and Company Users (dependem do currentUser do Flask)\nuseEffect(()=>{if(!isLoggedIn||!currentUser||!currentUser.username){setProducts([]);setSales([]);setCompanyUsers([]);// Limpa usuários da empresa também\nreturn;}console.log(\"Attempting to fetch Firestore data for user:\",currentUser.username);// Products Listener (para company_admin e gerente)\nlet unsubscribeProducts;if(currentUser.role==='company_admin'||currentUser.role==='gerente'){const productsCollectionRef=collection(db,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/products\"));unsubscribeProducts=onSnapshot(productsCollectionRef,snapshot=>{const productsData=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setProducts(productsData);console.log(\"Produtos carregados com sucesso!\");},error=>{console.error(\"Erro ao carregar produtos:\",error);showMessage(\"Erro ao carregar produtos do Firestore. Verifique as permissões.\",\"error\");});}else{setProducts([]);// Limpa se não tiver permissão\n}// Sales Listener (para company_admin e gerente)\nlet unsubscribeSales;if(currentUser.role==='company_admin'||currentUser.role==='gerente'){const salesCollectionRef=collection(db,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\"));unsubscribeSales=onSnapshot(salesCollectionRef,snapshot=>{const salesData=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setSales(salesData);console.log(\"Vendas carregadas com sucesso!\");},error=>{console.error(\"Erro ao carregar vendas:\",error);showMessage(\"Erro ao carregar vendas do Firestore. Verifique as permissões.\",\"error\");});}else{setSales([]);// Limpa se não tiver permissão\n}// Company Users Listener (APENAS para company_admin)\nlet unsubscribeCompanyUsers;if(currentUser.role==='company_admin'){const companyUsersCollectionRef=collection(db,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/company_users\"));console.log(\"Firestore Company Users Listener Path:\",companyUsersCollectionRef.path);// NOVO LOG\nunsubscribeCompanyUsers=onSnapshot(companyUsersCollectionRef,snapshot=>{const usersData=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setCompanyUsers(usersData);console.log(\"Usuários da empresa carregados com sucesso!\",usersData);// NOVO LOG\n},error=>{console.error(\"Erro ao carregar usuários da empresa:\",error);showMessage(\"Erro ao carregar usuários da empresa do Firestore. Verifique as permissões.\",\"error\");});}else{setCompanyUsers([]);// Limpa se não tiver permissão\n}return()=>{if(unsubscribeProducts)unsubscribeProducts();if(unsubscribeSales)unsubscribeSales();if(unsubscribeCompanyUsers)unsubscribeCompanyUsers();console.log(\"Firestore listeners for Products, Sales, and Company Users unsubscribed.\");};},[isLoggedIn,currentUser,appId]);// Listener para carregar a lista de empresas (apenas para admin principal)\nuseEffect(()=>{if(!isLoggedIn||!currentUser||currentUser.role!=='admin'){setCompanies([]);return;}const companiesCollectionRef=collection(db,\"artifacts/\".concat(appId,\"/users\"));const q=query(companiesCollectionRef,where(\"role\",\"==\",\"company_admin\"));const unsubscribeCompanies=onSnapshot(q,snapshot=>{const companiesData=snapshot.docs.map(doc=>_objectSpread({id:doc.id},doc.data()));setCompanies(companiesData);console.log(\"Empresas carregadas com sucesso!\");},error=>{console.error(\"Erro ao carregar empresas:\",error);showMessage(\"Erro ao carregar empresas do Firestore. Verifique as permissões.\",\"error\");});return()=>{unsubscribeCompanies();console.log(\"Firestore listener for Companies unsubscribed.\");};},[isLoggedIn,currentUser,appId]);// Calculate total whenever cart changes\nuseEffect(()=>{const newTotal=cart.reduce((sum,item)=>sum+item.value*item.quantity,0);setTotal(newTotal);},[cart]);// Calculate change/difference whenever total or payment amount changes\nuseEffect(()=>{const paid=parseFloat(paymentAmount)||0;if(paid>=total){setChange(paid-total);setDifference(0);}else{setChange(0);setDifference(total-paid);}},[total,paymentAmount]);// Add product to cart\nconst addToCart=product=>{const existingItem=cart.find(item=>item.id===product.id);if(existingItem){setCart(cart.map(item=>item.id===product.id?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity+1}):item));}else{setCart([...cart,_objectSpread(_objectSpread({},product),{},{quantity:1})]);}showMessage(\"\".concat(product.name,\" adicionado ao carrinho!\"));};// Remove product from cart\nconst removeFromCart=productId=>{setCart(cart.filter(item=>item.id!==productId));showMessage(\"Item removido do carrinho.\",\"info\");};// Increase quantity in cart\nconst increaseQuantity=productId=>{setCart(cart.map(item=>item.id===productId?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity+1}):item));};// Decrease quantity in cart\nconst decreaseQuantity=productId=>{setCart(cart.map(item=>item.id===productId&&item.quantity>1?_objectSpread(_objectSpread({},item),{},{quantity:item.quantity-1}):item).filter(item=>item.quantity>0));// Remove if quantity becomes 0\n};// Finalize sale\nconst finalizeSale=async()=>{if(cart.length===0){showMessage(\"O carrinho está vazio!\",\"error\");return;}if(paymentMethod==='Dinheiro'){if(parseFloat(paymentAmount)<total){showMessage(\"Valor pago insuficiente!\",\"error\");return;}}else if(paymentMethod==='Pix'){setIsLoadingPix(true);setPixQrCodeData(null);// Limpa dados Pix anteriores\ntry{// Certifica-se de que currentUser e currentUser.username existem\nif(!currentUser||!currentUser.username){showMessage(\"Erro: Usuário da empresa não identificado para gerar Pix.\",\"error\");setIsLoadingPix(false);return;}const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/pix/generate\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({amount:total.toFixed(2),description:\"Pagamento de Venda\",company_username:currentUser.username// Envia o username da empresa logada\n})});const data=await response.json();console.log(\"Dados Pix recebidos do backend:\",data);// Log para inspecionar os dados\nif(response.ok){// Adiciona o prefixo data:image/png;base64, se ainda não tiver\nif(data.qr_code_base64&&!data.qr_code_base64.startsWith('data:image/png;base64,')){data.qr_code_base64='data:image/png;base64,'+data.qr_code_base64;}setPixQrCodeData(data);showMessage(\"QR Code Pix gerado com sucesso!\",\"success\");// Não finaliza a venda no Firestore aqui, espera a confirmação do pagamento Pix\n// Em um app real, você teria um webhook para confirmar o pagamento\n}else{showMessage(\"Erro ao gerar Pix: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(error){console.error('Erro ao gerar Pix:',error);showMessage('Erro ao conectar ao servidor para gerar Pix.','error');}finally{setIsLoadingPix(false);}return;// Retorna para que a venda não seja finalizada no Firestore ainda\n}// Lógica para finalizar a venda no Firestore (para Dinheiro e Cartão)\n// NOVO: Calcular o custo total dos produtos vendidos (CPV)\nconst costOfGoodsSold=cart.reduce((sum,item)=>sum+(item.cost||0)*item.quantity,0);const saleData={items:cart.map(item=>({productId:item.id,name:item.name,value:item.value,cost:item.cost||0,// Garante que o custo seja salvo\nquantity:item.quantity})),total:total,costOfGoodsSold:costOfGoodsSold,// NOVO: Salva o CPV\nprofit:total-costOfGoodsSold,// NOVO: Salva o lucro por venda\npaymentMethod:paymentMethod,paymentAmount:parseFloat(paymentAmount)||0,change:change,timestamp:new Date(),userId:currentUser.username// Usa o username do Flask como userId para o Firestore\n};try{await addDoc(collection(db,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/sales\")),saleData);showMessage(\"Venda finalizada com sucesso!\");setCart([]);setPaymentAmount('');setChange(0);setDifference(0);setPaymentMethod('Dinheiro');setPixQrCodeData(null);// Limpa dados Pix se a venda for finalizada por outro método\n}catch(e){console.error(\"Erro ao adicionar documento: \",e);showMessage(\"Erro ao finalizar venda.\",\"error\");}};// Product Management Functions\nconst handleAddProduct=async()=>{if(!newProductName||!newProductValue||!newProductId||newProductCost===''){// NOVO: Validação para newProductCost\nshowMessage(\"Preencha todos os campos do produto!\",\"error\");return;}if(isNaN(parseFloat(newProductValue))||isNaN(parseFloat(newProductCost))){// NOVO: Validação para newProductCost\nshowMessage(\"O valor e o custo do produto devem ser números!\",\"error\");return;}const productData={name:newProductName,value:parseFloat(newProductValue),cost:parseFloat(newProductCost)// NOVO: Salva o custo\n};try{// Referência ao documento com o ID fornecido pelo usuário\nconst productDocRef=doc(db,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/products\"),newProductId);const docSnap=await getDoc(productDocRef);// Verifica se o documento já existe\nif(docSnap.exists()){showMessage(\"ID de produto já existe! Escolha um ID único.\",\"error\");return;}// Usa setDoc para criar um documento com o ID fornecido pelo usuário\nawait setDoc(productDocRef,productData);showMessage(\"Produto adicionado com sucesso!\");setNewProductName('');setNewProductValue('');setNewProductCost('');// NOVO: Limpa o campo de custo\nsetNewProductId('');}catch(e){console.error(\"Erro ao adicionar produto: \",e);showMessage(\"Erro ao adicionar produto.\",\"error\");}};const handleEditProduct=product=>{setEditingProduct(product);setNewProductName(product.name);setNewProductValue(product.value.toString());setNewProductCost(product.cost?product.cost.toString():'');// NOVO: Carrega o custo\nsetNewProductId(product.id);// Keep the ID for display, but it's not editable\n};const handleUpdateProduct=async()=>{if(!editingProduct||!newProductName||!newProductValue||newProductCost===''){// NOVO: Validação para newProductCost\nshowMessage(\"Preencha todos os campos para atualizar!\",\"error\");return;}if(isNaN(parseFloat(newProductValue))||isNaN(parseFloat(newProductCost))){// NOVO: Validação para newProductCost\nshowMessage(\"O valor e o custo do produto devem ser números!\",\"error\");return;}const productRef=doc(db,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/products\"),editingProduct.id);try{await updateDoc(productRef,{name:newProductName,value:parseFloat(newProductValue),cost:parseFloat(newProductCost)// NOVO: Atualiza o custo\n});showMessage(\"Produto atualizado com sucesso!\");setEditingProduct(null);setNewProductName('');setNewProductValue('');setNewProductCost('');// NOVO: Limpa o campo de custo\nsetNewProductId('');}catch(e){console.error(\"Erro ao atualizar produto: \",e);showMessage(\"Erro ao atualizar produto.\",\"error\");}};const handleDeleteProduct=async productId=>{var _auth$currentUser;console.log(\"Tentando excluir produto com ID:\",productId);console.log(\"Usuário atual para exclusão (currentUser.username):\",currentUser.username);console.log(\"UID do usuário autenticado no Firebase (auth.currentUser?.uid):\",(_auth$currentUser=auth.currentUser)===null||_auth$currentUser===void 0?void 0:_auth$currentUser.uid);// Log do UID real do Firebase Auth\ntry{// O caminho para exclusão deve corresponder ao caminho usado para buscar/adicionar\nconst docRef=doc(db,\"artifacts/\".concat(appId,\"/users/\").concat(currentUser.username,\"/products\"),productId);console.log(\"Caminho do documento Firestore para exclusão:\",docRef.path);await deleteDoc(docRef);showMessage(\"Produto excluído com sucesso!\");}catch(e){console.error(\"Erro ao excluir produto:\",e);console.error(\"Código do erro Firestore:\",e.code);// Log do código de erro\nconsole.error(\"Mensagem do erro Firestore:\",e.message);// Log da mensagem de erro\nif(e.code==='permission-denied'){showMessage(\"Erro de permissão: Você não tem autorização para excluir este produto. Verifique as regras de segurança do Firestore.\",\"error\");}else{showMessage(\"Erro ao excluir produto.\",\"error\");}}};const cancelEdit=()=>{setEditingProduct(null);setNewProductName('');setNewProductValue('');setNewProductCost('');// NOVO: Limpa o campo de custo\nsetNewProductId('');};// Calculate weekly sales report\nconst getWeeklySales=()=>{const oneWeekAgo=new Date();oneWeekAgo.setDate(oneWeekAgo.getDate()-7);const weeklySales=sales.filter(sale=>{const saleDate=sale.timestamp.toDate();// Convert Firestore Timestamp to Date object\nreturn saleDate>=oneWeekAgo;});const salesByDay={};weeklySales.forEach(sale=>{const saleDate=sale.timestamp.toDate().toLocaleDateString('pt-BR');// NOVO: Soma o lucro em vez do total\nif(!salesByDay[saleDate]){salesByDay[saleDate]=0;}salesByDay[saleDate]+=sale.profit||sale.total-(sale.costOfGoodsSold||0);// Garante que o lucro seja calculado se não estiver salvo\n});// Sort by date for display\nconst sortedSales=Object.entries(salesByDay).sort((_ref,_ref2)=>{let[dateA]=_ref;let[dateB]=_ref2;const[dayA,monthA,yearA]=dateA.split('/').map(Number);const[dayB,monthB,yearB]=dateB.split('/').map(Number);const dateObjA=new Date(yearA,monthA-1,dayA);const dateObjB=new Date(yearB,monthB-1,dayB);return dateObjA-dateObjB;});return sortedSales;};// --- Funções de Autenticação com o Backend Flask ---\nconst handleLogin=async e=>{e.preventDefault();try{const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/login\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:loginUsername,password:loginPassword})});const data=await response.json();console.log(\"Dados recebidos do backend:\",data);if(response.ok){const firebaseToken=data.firebase_token;if(firebaseToken){try{await signInWithCustomToken(auth,firebaseToken);showMessage(\"Login bem-sucedido! Bem-vindo, \".concat(data.username,\".\"),'success');setIsLoggedIn(true);// Armazena os dados de design no currentUser\nsetCurrentUser({username:data.username,role:data.role,company_name:data.company_name,design:data.design// Armazena o objeto de design completo\n});setLoginPassword('');// Redireciona para a aba apropriada após o login\nif(data.role==='admin'){setActiveTab('gerenciar_empresas');}else{setActiveTab('caixa');}}catch(firebaseError){console.error(\"Erro ao autenticar no Firebase com token personalizado:\",firebaseError);showMessage(\"Erro ao conectar ao Firebase: \".concat(firebaseError.message),'error');setIsLoggedIn(false);setCurrentUser(null);}}else{showMessage(\"Erro: Token Firebase não recebido do backend.\",\"error\");console.error(\"Firebase token missing in Flask response. Full data:\",data);}}else{showMessage(\"Erro de login: \".concat(data.error||'Credenciais inválidas'),'error');}}catch(error){console.error('Erro ao conectar ao backend para login:',error);showMessage('Erro ao conectar ao servidor. Verifique se o backend está rodando.','error');}};const handleLogout=async()=>{// Resetar estados que controlam os listeners ANTES de deslogar do Firebase Auth\nsetIsLoggedIn(false);setCurrentUser(null);setLoginUsername('');setLoginPassword('');setCart([]);setProducts([]);setSales([]);setCompanies([]);setCompanyUsers([]);// Limpa usuários da empresa no logout\ntry{await auth.signOut();// Desloga do Firebase Auth\nshowMessage(\"Você foi desconectado.\",\"info\");setActiveTab('caixa');// Volta para a aba padrão após logout\n}catch(error){console.error(\"Erro ao deslogar do Firebase:\",error);showMessage(\"Erro ao desconectar.\",\"error\");}};// --- Funções de Gerenciamento de Empresas (para o admin principal) ---\nconst handleRegisterCompany=async e=>{e.preventDefault();if(!newCompanyUsername||!newCompanyPassword||!newCompanyName){showMessage(\"Preencha todos os campos para registrar a empresa!\",\"error\");return;}try{const response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/register_company\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:newCompanyUsername,password:newCompanyPassword,company_name:newCompanyName,design_theme:newCompanyDesignTheme,mercado_pago_access_token:newCompanyMercadoPagoAccessToken})});const data=await response.json();if(response.ok){showMessage(\"Empresa \\\"\".concat(data.company_name,\"\\\" (Usu\\xE1rio: \").concat(data.username,\") registrada com sucesso!\"),'success');setNewCompanyUsername('');setNewCompanyPassword('');setNewCompanyName('');setNewCompanyDesignTheme('default');setNewCompanyMercadoPagoAccessToken('');// Limpa o campo após o registro\n}else{showMessage(\"Erro ao registrar empresa: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(error){console.error('Erro ao conectar ao backend para registrar empresa:',error);showMessage('Erro ao conectar ao servidor para registrar empresa.','error');}};// Função para excluir uma empresa (login)\nconst handleDeleteCompany=async companyId=>{if(!window.confirm(\"Tem certeza que deseja excluir a empresa \".concat(companyId,\" e TODOS os seus dados (produtos, vendas, etc.)? Esta a\\xE7\\xE3o \\xE9 irrevers\\xEDvel!\"))){return;}try{const idToken=await auth.currentUser.getIdToken();// Obtém o ID Token do usuário logado (admin)\nconst response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/delete_company\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)// Envia o ID Token para autenticação no backend\n},body:JSON.stringify({company_username:companyId})});const data=await response.json();if(response.ok){showMessage(\"Empresa \\\"\".concat(companyId,\"\\\" exclu\\xEDda com sucesso!\"),'success');}else{showMessage(\"Erro ao excluir empresa: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(error){console.error('Erro ao conectar ao backend para excluir empresa:',error);showMessage('Erro ao conectar ao servidor para excluir empresa.','error');}};// --- Funções de Gerenciamento de Usuários da Empresa (para company_admin) ---\nconst handleAddCompanyUser=async e=>{e.preventDefault();if(!newCompanyUserUsername||!newCompanyUserPassword||!newCompanyUserRole){showMessage(\"Preencha todos os campos para adicionar o usuário!\",\"error\");return;}if(!currentUser||!currentUser.username){showMessage(\"Erro: Administrador da empresa não identificado.\",\"error\");return;}try{const idToken=await auth.currentUser.getIdToken();// Obtém o ID Token do company_admin logado\nconst response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/company_users/add\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)// Envia o ID Token para autenticação no backend\n},body:JSON.stringify({company_id:currentUser.username,// ID da empresa do admin logado\nusername:newCompanyUserUsername,password:newCompanyUserPassword,role:newCompanyUserRole})});const data=await response.json();if(response.ok){showMessage(\"Usu\\xE1rio \\\"\".concat(data.username,\"\\\" (\").concat(data.role,\") adicionado com sucesso!\"),'success');setNewCompanyUserUsername('');setNewCompanyUserPassword('');setNewCompanyUserRole('caixa');}else{showMessage(\"Erro ao adicionar usu\\xE1rio: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(e){console.error(\"Erro ao adicionar usuário da empresa: \",e);showMessage(\"Erro ao conectar ao servidor para adicionar usuário.\",\"error\");}};const handleEditCompanyUser=user=>{setEditingCompanyUser(user);setNewCompanyUserUsername(user.username);setNewCompanyUserRole(user.role);// Não carregamos a senha para edição por segurança\nsetNewCompanyUserPassword('');};const handleUpdateCompanyUser=async e=>{e.preventDefault();if(!editingCompanyUser||!newCompanyUserUsername||!newCompanyUserRole){showMessage(\"Preencha todos os campos para atualizar o usuário!\",\"error\");return;}if(!currentUser||!currentUser.username){showMessage(\"Erro: Administrador da empresa não identificado.\",\"error\");return;}try{const idToken=await auth.currentUser.getIdToken();// Obtém o ID Token do company_admin logado\nconst response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/company_users/update\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)},body:JSON.stringify({company_id:currentUser.username,user_id:editingCompanyUser.id,// O ID do documento do usuário no Firestore (que é o firebase_uid)\nusername:newCompanyUserUsername,password:newCompanyUserPassword||null,// Envia null se a senha não for alterada\nrole:newCompanyUserRole})});const data=await response.json();if(response.ok){showMessage(\"Usu\\xE1rio \\\"\".concat(data.username,\"\\\" atualizado com sucesso!\"),'success');setEditingCompanyUser(null);setNewCompanyUserUsername('');setNewCompanyUserPassword('');setNewCompanyUserRole('caixa');}else{showMessage(\"Erro ao atualizar usu\\xE1rio: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(e){console.error(\"Erro ao atualizar usuário da empresa: \",e);showMessage(\"Erro ao conectar ao servidor para atualizar usuário.\",\"error\");}};const handleDeleteCompanyUser=async userId=>{if(!window.confirm(\"Tem certeza que deseja excluir o usu\\xE1rio \".concat(userId,\"? Esta a\\xE7\\xE3o \\xE9 irrevers\\xEDvel!\"))){return;}if(!currentUser||!currentUser.username){showMessage(\"Erro: Administrador da empresa não identificado.\",\"error\");return;}console.log(\"Tentando excluir usuário da empresa com ID:\",userId);// NOVO LOG\ntry{const idToken=await auth.currentUser.getIdToken();// Obtém o ID Token do company_admin logado\nconst response=await fetch(\"\".concat(FLASK_BACKEND_URL,\"/company_users/delete\"),{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(idToken)},body:JSON.stringify({company_id:currentUser.username,user_id:userId// O ID do documento do usuário no Firestore (que é o firebase_uid)\n})});const data=await response.json();if(response.ok){showMessage(\"Usu\\xE1rio \\\"\".concat(userId,\"\\\" exclu\\xEDdo com sucesso!\"),'success');}else{showMessage(\"Erro ao excluir usu\\xE1rio: \".concat(data.error||'Erro desconhecido'),\"error\");}}catch(e){console.error(\"Erro ao excluir usuário da empresa:\",e);showMessage(\"Erro ao conectar ao servidor para excluir usuário.\",\"error\");}};const cancelEditCompanyUser=()=>{setEditingCompanyUser(null);setNewCompanyUserUsername('');setNewCompanyUserPassword('');setNewCompanyUserRole('caixa');};// Função para copiar a chave Pix para a área de transferência\nconst copyPixKeyToClipboard=key=>{// Usa document.execCommand('copy') por compatibilidade em iframes\nconst el=document.createElement('textarea');el.value=key;document.body.appendChild(el);el.select();try{document.execCommand('copy');showMessage(\"Chave Pix copiada!\",\"success\");}catch(err){console.error('Erro ao copiar a chave Pix:',err);showMessage(\"Falha ao copiar a chave Pix.\",\"error\");}document.body.removeChild(el);};// Filtrar produtos com base no termo de pesquisa\nconst filteredProducts=products.filter(product=>product.name.toLowerCase().includes(searchTerm.toLowerCase())||product.id.toLowerCase().includes(searchTerm.toLowerCase()));// Renderiza a tela de login se o usuário não estiver logado\nif(!isLoggedIn){return/*#__PURE__*/_jsxs(\"div\",{className:\"relative min-h-screen flex flex-col items-center justify-center overflow-hidden bg-gray-800\",children:[\" \",/*#__PURE__*/_jsx(\"video\",{autoPlay:true,loop:true,muted:true,playsInline:true,className:\"absolute z-0 w-full h-full object-cover\",src:\"https://videos.pexels.com/video-files/3752548/3752548-hd_1920_1080_24fps.mp4\"// URL do vídeo para a tela de login\n,onError:e=>console.error(\"Erro ao carregar o vídeo de fundo da tela de login:\",e),children:\"Seu navegador n\\xE3o suporta a tag de v\\xEDdeo.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-10 w-full h-full bg-black opacity-50\"}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed top-4 right-4 p-3 rounded-lg shadow-lg text-white z-50 transition-opacity duration-300 \".concat(message.type==='success'?'bg-green-500':'bg-red-500'),children:message.text}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative z-20 bg-white p-8 rounded-2xl shadow-xl w-full max-w-md\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold text-gray-800 mb-6 text-center\",children:\"Login\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLogin,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"loginUsername\",children:\"Nome de Usu\\xE1rio:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\",id:\"loginUsername\",type:\"text\",placeholder:\"Nome de Usu\\xE1rio\",value:loginUsername,onChange:e=>setLoginUsername(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 text-sm font-bold mb-2\",htmlFor:\"loginPassword\",children:\"Senha:\"}),/*#__PURE__*/_jsx(\"input\",{className:\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline\",id:\"loginPassword\",type:\"password\",placeholder:\"********\",value:loginPassword,onChange:e=>setLoginPassword(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"button\",{className:\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition-colors duration-200\",type:\"submit\",children:\"Login\"})})]})]})]});}// Renderiza o aplicativo principal se o usuário estiver logado\nconst currentDesign=(currentUser===null||currentUser===void 0?void 0:currentUser.design)||{};// Garante que currentDesign não é nulo\n// Determina se o vídeo de fundo da aba \"Gerenciar Empresas\" deve ser ativo\nconst showCompanyManagementVideo=isLoggedIn&&activeTab==='gerenciar_empresas'&&(currentUser===null||currentUser===void 0?void 0:currentUser.role)==='admin';// Define o estilo de fundo dinamicamente (cores/gradiente)\nconst backgroundClasses=currentDesign.dominant_color?\"\".concat(currentDesign.dominant_color)// Usa a cor dominante se definida\n:\"\".concat(currentDesign.gradient_from||'from-blue-50',\" \").concat(currentDesign.gradient_to||'to-indigo-100');// Volta para o gradiente se não houver cor dominante\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen p-4 \".concat(currentDesign.font_family||'font-sans',\" flex flex-col items-center relative\"),children:[showCompanyManagementVideo&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"video\",{autoPlay:true,loop:true,muted:true,playsInline:true,className:\"absolute z-0 w-full h-full object-cover top-0 left-0\",src:\"https://videos.pexels.com/video-files/30163656/12934691_1920_1080_30fps.mp4\"// URL do vídeo para a aba de gerenciamento de empresas\n,onError:e=>console.error(\"Erro ao carregar o vídeo de fundo da Gerenciar Empresas:\",e),children:\"Seu navegador n\\xE3o suporta a tag de v\\xEDdeo para o fundo de gerenciamento de empresas.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-10 w-full h-full bg-black opacity-50 top-0 left-0\"})]}),!showCompanyManagementVideo&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute z-0 w-full h-full top-0 left-0 \".concat(backgroundClasses)}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative z-20 w-full flex flex-col items-center\",children:[currentUser&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-4 left-4 bg-white p-2 rounded-lg shadow-md text-sm text-gray-700\",children:[\"Usu\\xE1rio Logado: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold\",children:currentUser.username}),\" (Fun\\xE7\\xE3o: \",currentUser.role,\")\",currentUser.company_name&&/*#__PURE__*/_jsxs(\"span\",{className:\"ml-2\",children:[\"Empresa: \",currentUser.company_name]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"ml-4 bg-red-500 hover:bg-red-600 text-white text-xs px-2 py-1 rounded-full transition-colors duration-200\",children:\"Sair\"})]}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed top-4 right-4 p-3 rounded-lg shadow-lg text-white z-50 transition-opacity duration-300 \".concat(message.type==='success'?currentDesign.success_color:currentDesign.error_color),children:message.text}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-4xl font-extrabold \".concat(currentDesign.text_color_strong||'text-gray-800',\" mb-8 mt-4 rounded-xl p-3 bg-white shadow-lg\"),children:\"Gerenciador de Caixa\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4 mb-8 bg-white p-2 rounded-full shadow-md\",children:[(currentUser.role==='company_admin'||currentUser.role==='gerente'||currentUser.role==='caixa')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('caixa'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='caixa'?\"\".concat(currentDesign.primary_button_bg,\" text-white shadow-lg\"):\"\".concat(currentDesign.secondary_button_bg,\" \").concat(currentDesign.secondary_button_text,\" \").concat(currentDesign.secondary_button_hover_bg)),children:\"Caixa\"}),(currentUser.role==='company_admin'||currentUser.role==='gerente')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('produtos'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='produtos'?\"\".concat(currentDesign.primary_button_bg,\" text-white shadow-lg\"):\"\".concat(currentDesign.secondary_button_bg,\" \").concat(currentDesign.secondary_button_text,\" \").concat(currentDesign.secondary_button_hover_bg)),children:\"Produtos\"}),(currentUser.role==='company_admin'||currentUser.role==='gerente')&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('relatorios'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='relatorios'?\"\".concat(currentDesign.primary_button_bg,\" text-white shadow-lg\"):\"\".concat(currentDesign.secondary_button_bg,\" \").concat(currentDesign.secondary_button_text,\" \").concat(currentDesign.secondary_button_hover_bg)),children:\"Relat\\xF3rios\"}),currentUser.role==='company_admin'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('gerenciar_usuarios'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='gerenciar_usuarios'?\"\".concat(currentDesign.primary_button_bg,\" text-white shadow-lg\"):\"\".concat(currentDesign.secondary_button_bg,\" \").concat(currentDesign.secondary_button_text,\" \").concat(currentDesign.secondary_button_hover_bg)),children:\"Gerenciar Usu\\xE1rios\"}),currentUser.role==='admin'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveTab('gerenciar_empresas'),className:\"px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 \".concat(activeTab==='gerenciar_empresas'?\"\".concat(currentDesign.primary_button_bg,\" text-white shadow-lg\"):\"\".concat(currentDesign.secondary_button_bg,\" \").concat(currentDesign.secondary_button_text,\" \").concat(currentDesign.secondary_button_hover_bg)),children:\"Gerenciar Empresas\"})]}),activeTab==='caixa'&&(currentUser.role==='company_admin'||currentUser.role==='gerente'||currentUser.role==='caixa')&&/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 lg:grid-cols-3 gap-8 w-full max-w-7xl\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-1 bg-white p-6 rounded-2xl shadow-xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mb-4 pb-2 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:\"Produtos Dispon\\xEDveis\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Pesquisar produto por nome ou ID...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),className:\"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:filteredProducts.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhum produto encontrado ou cadastrado.\"}):filteredProducts.map(product=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center bg-gray-50 p-3 mb-2 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold \".concat(currentDesign.text_color_strong||'text-gray-800'),children:[product.name,\" (ID: \",product.id,\")\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"\".concat(currentDesign.highlight_color||'text-blue-600',\" font-bold\"),children:[\"R$ \",product.value.toFixed(2)]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>addToCart(product),className:\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Adicionar\"})]},product.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"lg:col-span-2 bg-white p-6 rounded-2xl shadow-xl flex flex-col\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mb-4 pb-2 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:\"Carrinho de Compras\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-grow max-h-80 overflow-y-auto mb-4\",children:cart.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Carrinho vazio.\"}):cart.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center bg-gray-50 p-3 mb-2 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold \".concat(currentDesign.text_color_strong||'text-gray-800'),children:item.name}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600\",children:[\"R$ \",item.value.toFixed(2),\" x \",item.quantity]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>decreaseQuantity(item.id),className:\"bg-red-400 hover:bg-red-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold\",children:\"-\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-bold text-lg\",children:item.quantity}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>increaseQuantity(item.id),className:\"bg-green-400 hover:bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold\",children:\"+\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFromCart(item.id),className:\"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-full text-sm shadow-md\",children:\"Remover\"})]})]},item.id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-auto pt-4 border-t-2 \".concat(currentDesign.border_color||'border-blue-200'),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center text-2xl font-bold \".concat(currentDesign.text_color_strong||'text-gray-800',\" mb-4\"),children:[/*#__PURE__*/_jsx(\"span\",{children:\"Total:\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"R$ \",total.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"paymentMethod\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" text-lg font-semibold mb-2\"),children:\"M\\xE9todo de Pagamento:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"paymentMethod\",value:paymentMethod,onChange:e=>{setPaymentMethod(e.target.value);setPixQrCodeData(null);// Limpa os dados do Pix ao mudar o método\n},className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"Dinheiro\",children:\"Dinheiro\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Cartao\",children:\"Cart\\xE3o de Cr\\xE9dito/D\\xE9bito\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Pix\",children:\"Pix\"})]})]}),paymentMethod==='Dinheiro'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"paymentAmount\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" text-lg font-semibold mb-2\"),children:\"Valor Pago:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"paymentAmount\",value:paymentAmount,onChange:e=>setPaymentAmount(e.target.value),placeholder:\"R$ 0.00\",step:\"0.01\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg\"})]}),paymentMethod==='Pix'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200 text-yellow-800\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold\",children:\"Funcionalidade Pix:\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm\",children:\"Para gerar o QR Code Pix, o aplicativo far\\xE1 uma requisi\\xE7\\xE3o ao seu backend Flask.\"}),isLoadingPix?/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-center items-center py-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500\"}),/*#__PURE__*/_jsx(\"p\",{className:\"ml-3\",children:\"Gerando QR Code...\"})]}):pixQrCodeData?/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:pixQrCodeData.qr_code_base64||\"https://placehold.co/150x150/E0F2F7/000000?text=QR+Code+Pix\",alt:\"QR Code Pix\",className:\"mx-auto rounded-lg shadow-md w-64 h-64\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-sm text-gray-700\",children:\"Chave \\\"copia e cola\\\":\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center mt-1\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",readOnly:true,value:pixQrCodeData.copy_paste_key,className:\"flex-grow p-2 border border-gray-300 rounded-l-lg text-sm bg-gray-100\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>copyPixKeyToClipboard(pixQrCodeData.copy_paste_key),className:\"bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-r-lg text-sm\",children:\"Copiar\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-xs text-gray-600\",children:\"* Em um cen\\xE1rio real, a venda seria finalizada ap\\xF3s a confirma\\xE7\\xE3o do pagamento Pix via webhook.\"})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 text-center\",children:[/*#__PURE__*/_jsx(\"img\",{src:\"https://placehold.co/150x150/E0F2F7/000000?text=QR+Code+Pix\",alt:\"Placeholder QR Code Pix\",className:\"mx-auto rounded-lg shadow-md w-64 h-64\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-xs text-gray-600\",children:\"Clique em \\\"Finalizar Venda\\\" para gerar o QR Code.\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center text-xl \".concat(currentDesign.text_color_medium||'text-gray-700',\" mb-2\"),children:[/*#__PURE__*/_jsx(\"span\",{children:\"Diferen\\xE7a:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-red-600\",children:[\"R$ \",difference.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center text-xl \".concat(currentDesign.text_color_medium||'text-gray-700',\" mb-4\"),children:[/*#__PURE__*/_jsx(\"span\",{children:\"Troco:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-bold text-green-600\",children:[\"R$ \",change.toFixed(2)]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:finalizeSale,className:\"w-full \".concat(currentDesign.primary_button_bg||'bg-blue-600',\" \").concat(currentDesign.primary_button_hover_bg||'hover:bg-blue-700',\" text-white text-xl font-bold py-4 rounded-xl transition-all duration-300 shadow-lg transform hover:scale-105\"),children:\"Finalizar Venda\"})]})]})]}),activeTab==='produtos'&&(currentUser.role==='company_admin'||currentUser.role==='gerente')&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mb-6 pb-3 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:editingProduct?'Editar Produto':'Adicionar Novo Produto'}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newProductId\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"ID do Produto:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newProductId\",value:newProductId,onChange:e=>setNewProductId(e.target.value),placeholder:\"Ex: PROD001\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",disabled:!!editingProduct// Disable ID input when editing\n})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newProductName\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Nome do Produto:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newProductName\",value:newProductName,onChange:e=>setNewProductName(e.target.value),placeholder:\"Ex: Refrigerante Lata\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newProductValue\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Valor (R$):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"newProductValue\",value:newProductValue,onChange:e=>setNewProductValue(e.target.value),placeholder:\"Ex: 5.50\",step:\"0.01\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newProductCost\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Custo (R$):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"newProductCost\",value:newProductCost,onChange:e=>setNewProductCost(e.target.value),placeholder:\"Ex: 2.00\",step:\"0.01\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end space-x-4\",children:editingProduct?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleUpdateProduct,className:\"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Atualizar Produto\"}),/*#__PURE__*/_jsx(\"button\",{onClick:cancelEdit,className:\"bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Cancelar\"})]}):/*#__PURE__*/_jsx(\"button\",{onClick:handleAddProduct,className:\"\".concat(currentDesign.primary_button_bg||'bg-blue-600',\" \").concat(currentDesign.primary_button_hover_bg||'hover:bg-blue-700',\" text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\"),children:\"Adicionar Produto\"})}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mt-10 mb-4 pb-2 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:\"Lista de Produtos\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:products.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhum produto cadastrado.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-3\",children:products.map(product=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold \".concat(currentDesign.text_color_strong||'text-gray-800',\" text-lg\"),children:[\"Produto: \",product.name,\" (ID: \",product.id,\")\"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"\".concat(currentDesign.highlight_color||'text-blue-600',\" font-bold text-xl\"),children:[\"R$ \",product.value.toFixed(2)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[\"Custo: R$ \",product.cost?product.cost.toFixed(2):'0.00']})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEditProduct(product),className:\"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteProduct(product.id),className:\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Excluir\"})]})]},product.id))})})]}),activeTab==='relatorios'&&(currentUser.role==='company_admin'||currentUser.role==='gerente')&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mb-6 pb-3 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:\"Relat\\xF3rio de Lucro Semanal\"}),sales.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhuma venda registrada ainda.\"}):/*#__PURE__*/_jsxs(\"div\",{className:\"max-h-96 overflow-y-auto\",children:[/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white rounded-lg overflow-hidden shadow-md\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"\".concat(currentDesign.primary_button_bg||'bg-blue-500',\" text-white\"),children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Data\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Lucro Total\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:getWeeklySales().map(_ref3=>{let[date,profit]=_ref3;return/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 \".concat(currentDesign.text_color_strong||'text-gray-800'),children:date}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4 text-green-600 font-bold\",children:[\"R$ \",profit.toFixed(2)]})]},date);})})]}),getWeeklySales().length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 mt-4\",children:\"Nenhuma venda na \\xFAltima semana.\"})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mt-10 mb-4 pb-2 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:\"Todas as Vendas\"}),sales.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhuma venda registrada ainda.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"min-w-full bg-white rounded-lg overflow-hidden shadow-md\",children:[/*#__PURE__*/_jsx(\"thead\",{className:\"\".concat(currentDesign.primary_button_bg||'bg-blue-500',\" text-white\"),children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Data/Hora\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Itens\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Total\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Custo\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"Lucro\"}),/*#__PURE__*/_jsx(\"th\",{className:\"py-3 px-4 text-left text-sm font-semibold uppercase\",children:\"M\\xE9todo\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{className:\"divide-y divide-gray-200\",children:sales.map(sale=>/*#__PURE__*/_jsxs(\"tr\",{className:\"hover:bg-gray-50\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 \".concat(currentDesign.text_color_strong||'text-gray-800'),children:sale.timestamp.toDate().toLocaleString('pt-BR')}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 \".concat(currentDesign.text_color_medium||'text-gray-700'),children:sale.items.map(item=>/*#__PURE__*/_jsxs(\"p\",{children:[item.name,\" (x\",item.quantity,\")\"]},item.productId))}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4 text-green-600 font-bold\",children:[\"R$ \",sale.total.toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4 text-gray-600\",children:[\"R$ \",(sale.costOfGoodsSold||0).toFixed(2)]}),/*#__PURE__*/_jsxs(\"td\",{className:\"py-3 px-4 text-purple-600 font-bold\",children:[\"R$ \",(sale.profit||sale.total-(sale.costOfGoodsSold||0)).toFixed(2)]}),/*#__PURE__*/_jsx(\"td\",{className:\"py-3 px-4 \".concat(currentDesign.text_color_medium||'text-gray-700'),children:sale.paymentMethod})]},sale.id))})]})})]}),activeTab==='gerenciar_usuarios'&&currentUser.role==='company_admin'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mb-6 pb-3 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:editingCompanyUser?'Editar Usuário da Empresa':'Adicionar Novo Usuário da Empresa'}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:editingCompanyUser?handleUpdateCompanyUser:handleAddCompanyUser,className:\"space-y-4 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyUserUsername\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Nome de Usu\\xE1rio:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newCompanyUserUsername\",value:newCompanyUserUsername,onChange:e=>setNewCompanyUserUsername(e.target.value),placeholder:\"Ex: caixa01\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true,disabled:!!editingCompanyUser// Desabilita edição do username\n})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyUserPassword\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Senha:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"newCompanyUserPassword\",value:newCompanyUserPassword,onChange:e=>setNewCompanyUserPassword(e.target.value),placeholder:editingCompanyUser?\"Deixe em branco para manter a senha atual\":\"********\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:!editingCompanyUser// Senha é obrigatória apenas ao adicionar\n})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyUserRole\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Fun\\xE7\\xE3o:\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"newCompanyUserRole\",value:newCompanyUserRole,onChange:e=>setNewCompanyUserRole(e.target.value),className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"caixa\",children:\"Caixa\"}),/*#__PURE__*/_jsx(\"option\",{value:\"gerente\",children:\"Gerente\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end space-x-4\",children:editingCompanyUser?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Atualizar Usu\\xE1rio\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:cancelEditCompanyUser,className:\"bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Cancelar\"})]}):/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"\".concat(currentDesign.primary_button_bg||'bg-blue-600',\" \").concat(currentDesign.primary_button_hover_bg||'hover:bg-blue-700',\" text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\"),children:\"Adicionar Usu\\xE1rio\"})})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mt-10 mb-4 pb-2 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:\"Usu\\xE1rios da Empresa\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:companyUsers.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhum usu\\xE1rio cadastrado para esta empresa.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-3\",children:companyUsers.map(user=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold \".concat(currentDesign.text_color_strong||'text-gray-800',\" text-lg\"),children:[\"Usu\\xE1rio: \",user.username]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[\"Fun\\xE7\\xE3o: \",user.role]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleEditCompanyUser(user),className:\"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Editar\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteCompanyUser(user.id),className:\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Excluir\"})]})]},user.id))})})]}),activeTab==='gerenciar_empresas'&&currentUser.role==='admin'&&/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mb-6 pb-3 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:\"Registrar Nova Empresa\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleRegisterCompany,className:\"space-y-4 mb-8\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyUsername\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Nome de Usu\\xE1rio da Empresa (ID):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newCompanyUsername\",value:newCompanyUsername,onChange:e=>setNewCompanyUsername(e.target.value),placeholder:\"Ex: empresa_abc\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyPassword\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Senha da Empresa:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"newCompanyPassword\",value:newCompanyPassword,onChange:e=>setNewCompanyPassword(e.target.value),placeholder:\"********\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyName\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Nome Completo da Empresa:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newCompanyName\",value:newCompanyName,onChange:e=>setNewCompanyName(e.target.value),placeholder:\"Ex: ABC Com\\xE9rcio e Servi\\xE7os Ltda.\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyDesignTheme\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Tema de Design (Cores/Fontes):\"}),/*#__PURE__*/_jsxs(\"select\",{id:\"newCompanyDesignTheme\",value:newCompanyDesignTheme,onChange:e=>setNewCompanyDesignTheme(e.target.value),className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"default\",children:\"Padr\\xE3o\"}),/*#__PURE__*/_jsx(\"option\",{value:\"corporate\",children:\"Corporativo\"}),/*#__PURE__*/_jsx(\"option\",{value:\"vibrant\",children:\"Vibrante\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"newCompanyMercadoPagoAccessToken\",className:\"block \".concat(currentDesign.text_color_medium||'text-gray-700',\" font-semibold mb-2\"),children:\"Token de Acesso Mercado Pago:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"newCompanyMercadoPagoAccessToken\",value:newCompanyMercadoPagoAccessToken,onChange:e=>setNewCompanyMercadoPagoAccessToken(e.target.value),placeholder:\"Token MP (ex: APP_USR-xxxxxxxxxxxx)\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:handleRegisterCompany,className:\"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105\",children:\"Registrar Empresa\"})})]}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-2xl font-bold \".concat(currentDesign.text_color_medium||'text-gray-700',\" mt-10 mb-4 pb-2 border-b-2 \").concat(currentDesign.border_color||'border-blue-200'),children:\"Empresas Registradas\"}),/*#__PURE__*/_jsx(\"div\",{className:\"max-h-96 overflow-y-auto\",children:companies.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"Nenhuma empresa registrada ainda.\"}):/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-3\",children:companies.map(company=>/*#__PURE__*/_jsxs(\"li\",{className:\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-semibold \".concat(currentDesign.text_color_strong||'text-gray-800',\" text-lg\"),children:[\"Nome: \",company.company_name]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[\"Usu\\xE1rio (ID): \",company.id]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 text-sm\",children:[\"Tema: \",company.design_theme]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-3\",children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDeleteCompany(company.id),className:\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\",children:\"Excluir Empresa\"})})]},company.id))})})]})]})]});};export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","initializeApp","getAuth","signInWithCustomToken","onAuthStateChanged","getFirestore","collection","addDoc","getDocs","onSnapshot","doc","updateDoc","deleteDoc","query","where","setDoc","getDoc","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","db","auth","__app_id","initialAuthToken","__initial_auth_token","FLASK_BACKEND_URL","App","products","setProducts","cart","setCart","total","setTotal","paymentAmount","setPaymentAmount","change","setChange","difference","setDifference","paymentMethod","setPaymentMethod","sales","setSales","activeTab","setActiveTab","newProductName","setNewProductName","newProductValue","setNewProductValue","newProductCost","setNewProductCost","newProductId","setNewProductId","editingProduct","setEditingProduct","message","setMessage","isLoggedIn","setIsLoggedIn","currentUser","setCurrentUser","loginUsername","setLoginUsername","loginPassword","setLoginPassword","newCompanyUsername","setNewCompanyUsername","newCompanyPassword","setNewCompanyPassword","newCompanyName","setNewCompanyName","newCompanyDesignTheme","setNewCompanyDesignTheme","newCompanyMercadoPagoAccessToken","setNewCompanyMercadoPagoAccessToken","companies","setCompanies","pixQrCodeData","setPixQrCodeData","isLoadingPix","setIsLoadingPix","searchTerm","setSearchTerm","companyUsers","setCompanyUsers","newCompanyUserUsername","setNewCompanyUserUsername","newCompanyUserPassword","setNewCompanyUserPassword","newCompanyUserRole","setNewCompanyUserRole","editingCompanyUser","setEditingCompanyUser","messageTimeoutRef","showMessage","msg","type","arguments","length","undefined","text","current","clearTimeout","setTimeout","unsubscribe","user","uid","username","console","log","warn","unsubscribeProducts","role","productsCollectionRef","concat","snapshot","productsData","docs","map","_objectSpread","id","data","error","unsubscribeSales","salesCollectionRef","salesData","unsubscribeCompanyUsers","companyUsersCollectionRef","path","usersData","companiesCollectionRef","q","unsubscribeCompanies","companiesData","newTotal","reduce","sum","item","value","quantity","paid","parseFloat","addToCart","product","existingItem","find","name","removeFromCart","productId","filter","increaseQuantity","decreaseQuantity","finalizeSale","response","fetch","method","headers","body","JSON","stringify","amount","toFixed","description","company_username","json","ok","qr_code_base64","startsWith","costOfGoodsSold","cost","saleData","items","profit","timestamp","Date","userId","e","handleAddProduct","isNaN","productData","productDocRef","docSnap","exists","handleEditProduct","toString","handleUpdateProduct","productRef","handleDeleteProduct","_auth$currentUser","docRef","code","cancelEdit","getWeeklySales","oneWeekAgo","setDate","getDate","weeklySales","sale","saleDate","toDate","salesByDay","forEach","toLocaleDateString","sortedSales","Object","entries","sort","_ref","_ref2","dateA","dateB","dayA","monthA","yearA","split","Number","dayB","monthB","yearB","dateObjA","dateObjB","handleLogin","preventDefault","password","firebaseToken","firebase_token","company_name","design","firebaseError","handleLogout","signOut","handleRegisterCompany","design_theme","mercado_pago_access_token","handleDeleteCompany","companyId","window","confirm","idToken","getIdToken","handleAddCompanyUser","company_id","handleEditCompanyUser","handleUpdateCompanyUser","user_id","handleDeleteCompanyUser","cancelEditCompanyUser","copyPixKeyToClipboard","key","el","document","createElement","appendChild","select","execCommand","err","removeChild","filteredProducts","toLowerCase","includes","className","children","autoPlay","loop","muted","playsInline","src","onError","onSubmit","htmlFor","placeholder","onChange","target","required","currentDesign","showCompanyManagementVideo","backgroundClasses","dominant_color","gradient_from","gradient_to","font_family","onClick","success_color","error_color","text_color_strong","primary_button_bg","secondary_button_bg","secondary_button_text","secondary_button_hover_bg","text_color_medium","border_color","highlight_color","step","alt","readOnly","copy_paste_key","primary_button_hover_bg","disabled","_ref3","date","toLocaleString","company"],"sources":["C:/Users/willi/OneDrive/Desktop/projetos/caixa/meu-app-de-caixa/src/App.js"],"sourcesContent":["/* global __app_id, __initial_auth_token */\nimport React, { useState, useEffect, useRef } from 'react';\nimport { initializeApp } from 'firebase/app';\nimport { getAuth, signInWithCustomToken, onAuthStateChanged } from 'firebase/auth';\nimport { getFirestore, collection, addDoc, getDocs, onSnapshot, doc, updateDoc, deleteDoc, query, where, setDoc, getDoc } from 'firebase/firestore'; // Adicionado setDoc e getDoc\n// Removido: import { getStorage, ref, uploadBytes, getDownloadURL } from 'firebase/storage'; // Importa o Firebase Storage\n\n// Firebase configuration and initialization\n// Your specific Firebase project configuration is now hardcoded here for local development.\nconst firebaseConfig = {\n    apiKey: \"AIzaSyDNIJRlw0mJP349owctGbO58VZWGa0LtQs\",\n    authDomain: \"caixa-1bd0c.firebaseapp.com\",\n    projectId: \"caixa-1bd0c\",\n    storageBucket: \"caixa-1bd0c.firebaseastorage.app\",\n    messagingSenderId: \"651091159828\",\n    appId: \"1:651091159828:web:1043424c00f4e71bf97001\",\n    measurementId: \"G-4NJ0F95DVJ\"\n};\n\nconst app = initializeApp(firebaseConfig);\nconst db = getFirestore(app);\nconst auth = getAuth(app);\n// Removido: const storage = getStorage(app); // Inicializa o Firebase Storage\n\n// Global variables for app ID and initial auth token (from Canvas environment)\nconst appId = typeof __app_id !== 'undefined' ? __app_id : 'local-app-id';\nconst initialAuthToken = typeof __initial_auth_token !== 'undefined' ? initialAuthToken : null;\n\n// URL base do seu backend Flask\nconst FLASK_BACKEND_URL = 'http://127.0.0.1:5000';\n\n// Main App Component\nconst App = () => {\n    const [products, setProducts] = useState([]);\n    const [cart, setCart] = useState([]);\n    const [total, setTotal] = useState(0);\n    const [paymentAmount, setPaymentAmount] = useState('');\n    const [change, setChange] = useState(0);\n    const [difference, setDifference] = useState(0);\n    const [paymentMethod, setPaymentMethod] = useState('Dinheiro');\n    const [sales, setSales] = useState([]);\n    // Atualizado: 'caixa', 'produtos', 'relatorios', 'gerenciar_empresas', 'gerenciar_usuarios'\n    const [activeTab, setActiveTab] = useState('caixa');\n    const [newProductName, setNewProductName] = useState('');\n    const [newProductValue, setNewProductValue] = useState('');\n    const [newProductCost, setNewProductCost] = useState('');\n    const [newProductId, setNewProductId] = useState('');\n    const [editingProduct, setEditingProduct] = useState(null);\n    const [message, setMessage] = useState('');\n\n    // Estados para autenticação via Flask backend\n    const [isLoggedIn, setIsLoggedIn] = useState(false);\n    const [currentUser, setCurrentUser] = useState(null); // Armazena { username, role, company_name, design }\n    const [loginUsername, setLoginUsername] = useState('');\n    const [loginPassword, setLoginPassword] = useState('');\n\n    // Estados para Gerenciar Empresas (para o admin principal)\n    const [newCompanyUsername, setNewCompanyUsername] = useState('');\n    const [newCompanyPassword, setNewCompanyPassword] = useState('');\n    const [newCompanyName, setNewCompanyName] = useState('');\n    const [newCompanyDesignTheme, setNewCompanyDesignTheme] = useState('default');\n    const [newCompanyMercadoPagoAccessToken, setNewCompanyMercadoPagoAccessToken] = useState('');\n    const [companies, setCompanies] = useState([]);\n\n    // Estados para a funcionalidade Pix\n    const [pixQrCodeData, setPixQrCodeData] = useState(null);\n    const [isLoadingPix, setIsLoadingPix] = useState(false);\n\n    // Estado para o termo de pesquisa de produtos\n    const [searchTerm, setSearchTerm] = useState('');\n\n    // NOVOS ESTADOS para Gerenciar Usuários da Empresa (para company_admin)\n    const [companyUsers, setCompanyUsers] = useState([]); // Lista de usuários da empresa\n    const [newCompanyUserUsername, setNewCompanyUserUsername] = useState('');\n    const [newCompanyUserPassword, setNewCompanyUserPassword] = useState('');\n    const [newCompanyUserRole, setNewCompanyUserRole] = useState('caixa'); // 'caixa', 'gerente'\n    const [editingCompanyUser, setEditingCompanyUser] = useState(null);\n\n    const messageTimeoutRef = useRef(null);\n\n    // Function to display messages\n    const showMessage = (msg, type = 'success') => {\n        setMessage({ text: msg, type });\n        if (messageTimeoutRef.current) {\n            clearTimeout(messageTimeoutRef.current);\n        }\n        messageTimeoutRef.current = setTimeout(() => {\n            setMessage('');\n        }, 3000);\n    };\n\n    // Firebase Authentication (agora usa o token personalizado do Flask)\n    useEffect(() => {\n        const unsubscribe = onAuthStateChanged(auth, (user) => {\n            if (user && isLoggedIn && currentUser && user.uid === currentUser.username) {\n                console.log(\"Firebase Auth state changed: User is logged in with UID:\", user.uid);\n            } else if (!user && isLoggedIn) {\n                console.warn(\"Firebase Auth state changed: User logged in via Flask, but Firebase Auth is not.\");\n            } else if (user && !isLoggedIn) {\n                console.warn(\"Firebase Auth state changed: User logged in via Firebase, but not via Flask. (No auto-logout)\");\n            }\n        });\n        return () => unsubscribe();\n    }, [isLoggedIn, currentUser]);\n\n    // Firestore Listeners for Products, Sales, and Company Users (dependem do currentUser do Flask)\n    useEffect(() => {\n        if (!isLoggedIn || !currentUser || !currentUser.username) {\n            setProducts([]);\n            setSales([]);\n            setCompanyUsers([]); // Limpa usuários da empresa também\n            return;\n        }\n\n        console.log(\"Attempting to fetch Firestore data for user:\", currentUser.username);\n\n        // Products Listener (para company_admin e gerente)\n        let unsubscribeProducts;\n        if (currentUser.role === 'company_admin' || currentUser.role === 'gerente') {\n            const productsCollectionRef = collection(db, `artifacts/${appId}/users/${currentUser.username}/products`);\n            unsubscribeProducts = onSnapshot(productsCollectionRef, (snapshot) => {\n                const productsData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n                setProducts(productsData);\n                console.log(\"Produtos carregados com sucesso!\");\n            }, (error) => {\n                console.error(\"Erro ao carregar produtos:\", error);\n                showMessage(\"Erro ao carregar produtos do Firestore. Verifique as permissões.\", \"error\");\n            });\n        } else {\n            setProducts([]); // Limpa se não tiver permissão\n        }\n\n\n        // Sales Listener (para company_admin e gerente)\n        let unsubscribeSales;\n        if (currentUser.role === 'company_admin' || currentUser.role === 'gerente') {\n            const salesCollectionRef = collection(db, `artifacts/${appId}/users/${currentUser.username}/sales`);\n            unsubscribeSales = onSnapshot(salesCollectionRef, (snapshot) => {\n                const salesData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n                setSales(salesData);\n                console.log(\"Vendas carregadas com sucesso!\");\n            }, (error) => {\n                console.error(\"Erro ao carregar vendas:\", error);\n                showMessage(\"Erro ao carregar vendas do Firestore. Verifique as permissões.\", \"error\");\n            });\n        } else {\n            setSales([]); // Limpa se não tiver permissão\n        }\n\n\n        // Company Users Listener (APENAS para company_admin)\n        let unsubscribeCompanyUsers;\n        if (currentUser.role === 'company_admin') {\n            const companyUsersCollectionRef = collection(db, `artifacts/${appId}/users/${currentUser.username}/company_users`);\n            console.log(\"Firestore Company Users Listener Path:\", companyUsersCollectionRef.path); // NOVO LOG\n            unsubscribeCompanyUsers = onSnapshot(companyUsersCollectionRef, (snapshot) => {\n                const usersData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n                setCompanyUsers(usersData);\n                console.log(\"Usuários da empresa carregados com sucesso!\", usersData); // NOVO LOG\n            }, (error) => {\n                console.error(\"Erro ao carregar usuários da empresa:\", error);\n                showMessage(\"Erro ao carregar usuários da empresa do Firestore. Verifique as permissões.\", \"error\");\n            });\n        } else {\n            setCompanyUsers([]); // Limpa se não tiver permissão\n        }\n\n\n        return () => {\n            if (unsubscribeProducts) unsubscribeProducts();\n            if (unsubscribeSales) unsubscribeSales();\n            if (unsubscribeCompanyUsers) unsubscribeCompanyUsers();\n            console.log(\"Firestore listeners for Products, Sales, and Company Users unsubscribed.\");\n        };\n    }, [isLoggedIn, currentUser, appId]);\n\n    // Listener para carregar a lista de empresas (apenas para admin principal)\n    useEffect(() => {\n        if (!isLoggedIn || !currentUser || currentUser.role !== 'admin') {\n            setCompanies([]);\n            return;\n        }\n\n        const companiesCollectionRef = collection(db, `artifacts/${appId}/users`);\n        const q = query(companiesCollectionRef, where(\"role\", \"==\", \"company_admin\"));\n\n        const unsubscribeCompanies = onSnapshot(q, (snapshot) => {\n            const companiesData = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\n            setCompanies(companiesData);\n            console.log(\"Empresas carregadas com sucesso!\");\n        }, (error) => {\n            console.error(\"Erro ao carregar empresas:\", error);\n            showMessage(\"Erro ao carregar empresas do Firestore. Verifique as permissões.\", \"error\");\n        });\n\n        return () => {\n            unsubscribeCompanies();\n            console.log(\"Firestore listener for Companies unsubscribed.\");\n        };\n    }, [isLoggedIn, currentUser, appId]);\n\n\n    // Calculate total whenever cart changes\n    useEffect(() => {\n        const newTotal = cart.reduce((sum, item) => sum + (item.value * item.quantity), 0);\n        setTotal(newTotal);\n    }, [cart]);\n\n    // Calculate change/difference whenever total or payment amount changes\n    useEffect(() => {\n        const paid = parseFloat(paymentAmount) || 0;\n        if (paid >= total) {\n            setChange(paid - total);\n            setDifference(0);\n        } else {\n            setChange(0);\n            setDifference(total - paid);\n        }\n    }, [total, paymentAmount]);\n\n    // Add product to cart\n    const addToCart = (product) => {\n        const existingItem = cart.find(item => item.id === product.id);\n        if (existingItem) {\n            setCart(cart.map(item =>\n                item.id === product.id ? { ...item, quantity: item.quantity + 1 } : item\n            ));\n        } else {\n            setCart([...cart, { ...product, quantity: 1 }]);\n        }\n        showMessage(`${product.name} adicionado ao carrinho!`);\n    };\n\n    // Remove product from cart\n    const removeFromCart = (productId) => {\n        setCart(cart.filter(item => item.id !== productId));\n        showMessage(\"Item removido do carrinho.\", \"info\");\n    };\n\n    // Increase quantity in cart\n    const increaseQuantity = (productId) => {\n        setCart(cart.map(item =>\n            item.id === productId ? { ...item, quantity: item.quantity + 1 } : item\n        ));\n    };\n\n    // Decrease quantity in cart\n    const decreaseQuantity = (productId) => {\n        setCart(cart.map(item =>\n            item.id === productId && item.quantity > 1 ? { ...item, quantity: item.quantity - 1 } : item\n        ).filter(item => item.quantity > 0)); // Remove if quantity becomes 0\n    };\n\n    // Finalize sale\n    const finalizeSale = async () => {\n        if (cart.length === 0) {\n            showMessage(\"O carrinho está vazio!\", \"error\");\n            return;\n        }\n\n        if (paymentMethod === 'Dinheiro') {\n            if (parseFloat(paymentAmount) < total) {\n                showMessage(\"Valor pago insuficiente!\", \"error\");\n                return;\n            }\n        } else if (paymentMethod === 'Pix') {\n            setIsLoadingPix(true);\n            setPixQrCodeData(null); // Limpa dados Pix anteriores\n            try {\n                // Certifica-se de que currentUser e currentUser.username existem\n                if (!currentUser || !currentUser.username) {\n                    showMessage(\"Erro: Usuário da empresa não identificado para gerar Pix.\", \"error\");\n                    setIsLoadingPix(false);\n                    return;\n                }\n\n                const response = await fetch(`${FLASK_BACKEND_URL}/pix/generate`, {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                    },\n                    body: JSON.stringify({\n                        amount: total.toFixed(2),\n                        description: \"Pagamento de Venda\",\n                        company_username: currentUser.username // Envia o username da empresa logada\n                    }),\n                });\n\n                const data = await response.json();\n                console.log(\"Dados Pix recebidos do backend:\", data); // Log para inspecionar os dados\n\n                if (response.ok) {\n                    // Adiciona o prefixo data:image/png;base64, se ainda não tiver\n                    if (data.qr_code_base64 && !data.qr_code_base64.startsWith('data:image/png;base64,')) {\n                        data.qr_code_base64 = 'data:image/png;base64,' + data.qr_code_base64;\n                    }\n                    setPixQrCodeData(data);\n                    showMessage(\"QR Code Pix gerado com sucesso!\", \"success\");\n                    // Não finaliza a venda no Firestore aqui, espera a confirmação do pagamento Pix\n                    // Em um app real, você teria um webhook para confirmar o pagamento\n                } else {\n                    showMessage(`Erro ao gerar Pix: ${data.error || 'Erro desconhecido'}`, \"error\");\n                }\n            } catch (error) {\n                console.error('Erro ao gerar Pix:', error);\n                showMessage('Erro ao conectar ao servidor para gerar Pix.', 'error');\n            } finally {\n                setIsLoadingPix(false);\n            }\n            return; // Retorna para que a venda não seja finalizada no Firestore ainda\n        }\n\n        // Lógica para finalizar a venda no Firestore (para Dinheiro e Cartão)\n        // NOVO: Calcular o custo total dos produtos vendidos (CPV)\n        const costOfGoodsSold = cart.reduce((sum, item) => sum + ((item.cost || 0) * item.quantity), 0);\n\n        const saleData = {\n            items: cart.map(item => ({\n                productId: item.id,\n                name: item.name,\n                value: item.value,\n                cost: item.cost || 0, // Garante que o custo seja salvo\n                quantity: item.quantity\n            })),\n            total: total,\n            costOfGoodsSold: costOfGoodsSold, // NOVO: Salva o CPV\n            profit: total - costOfGoodsSold, // NOVO: Salva o lucro por venda\n            paymentMethod: paymentMethod,\n            paymentAmount: parseFloat(paymentAmount) || 0,\n            change: change,\n            timestamp: new Date(),\n            userId: currentUser.username // Usa o username do Flask como userId para o Firestore\n        };\n\n        try {\n            await addDoc(collection(db, `artifacts/${appId}/users/${currentUser.username}/sales`), saleData);\n            showMessage(\"Venda finalizada com sucesso!\");\n            setCart([]);\n            setPaymentAmount('');\n            setChange(0);\n            setDifference(0);\n            setPaymentMethod('Dinheiro');\n            setPixQrCodeData(null); // Limpa dados Pix se a venda for finalizada por outro método\n        } catch (e) {\n            console.error(\"Erro ao adicionar documento: \", e);\n            showMessage(\"Erro ao finalizar venda.\", \"error\");\n        }\n    };\n\n    // Product Management Functions\n    const handleAddProduct = async () => {\n        if (!newProductName || !newProductValue || !newProductId || newProductCost === '') { // NOVO: Validação para newProductCost\n            showMessage(\"Preencha todos os campos do produto!\", \"error\");\n            return;\n        }\n        if (isNaN(parseFloat(newProductValue)) || isNaN(parseFloat(newProductCost))) { // NOVO: Validação para newProductCost\n            showMessage(\"O valor e o custo do produto devem ser números!\", \"error\");\n            return;\n        }\n\n        const productData = {\n            name: newProductName,\n            value: parseFloat(newProductValue),\n            cost: parseFloat(newProductCost) // NOVO: Salva o custo\n        };\n\n        try {\n            // Referência ao documento com o ID fornecido pelo usuário\n            const productDocRef = doc(db, `artifacts/${appId}/users/${currentUser.username}/products`, newProductId);\n            const docSnap = await getDoc(productDocRef); // Verifica se o documento já existe\n\n            if (docSnap.exists()) {\n                showMessage(\"ID de produto já existe! Escolha um ID único.\", \"error\");\n                return;\n            }\n\n            // Usa setDoc para criar um documento com o ID fornecido pelo usuário\n            await setDoc(productDocRef, productData);\n            showMessage(\"Produto adicionado com sucesso!\");\n            setNewProductName('');\n            setNewProductValue('');\n            setNewProductCost(''); // NOVO: Limpa o campo de custo\n            setNewProductId('');\n        } catch (e) {\n            console.error(\"Erro ao adicionar produto: \", e);\n            showMessage(\"Erro ao adicionar produto.\", \"error\");\n        }\n    };\n\n    const handleEditProduct = (product) => {\n        setEditingProduct(product);\n        setNewProductName(product.name);\n        setNewProductValue(product.value.toString());\n        setNewProductCost(product.cost ? product.cost.toString() : ''); // NOVO: Carrega o custo\n        setNewProductId(product.id); // Keep the ID for display, but it's not editable\n    };\n\n    const handleUpdateProduct = async () => {\n        if (!editingProduct || !newProductName || !newProductValue || newProductCost === '') { // NOVO: Validação para newProductCost\n            showMessage(\"Preencha todos os campos para atualizar!\", \"error\");\n            return;\n        }\n        if (isNaN(parseFloat(newProductValue)) || isNaN(parseFloat(newProductCost))) { // NOVO: Validação para newProductCost\n            showMessage(\"O valor e o custo do produto devem ser números!\", \"error\");\n            return;\n        }\n\n        const productRef = doc(db, `artifacts/${appId}/users/${currentUser.username}/products`, editingProduct.id);\n        try {\n            await updateDoc(productRef, {\n                name: newProductName,\n                value: parseFloat(newProductValue),\n                cost: parseFloat(newProductCost) // NOVO: Atualiza o custo\n            });\n            showMessage(\"Produto atualizado com sucesso!\");\n            setEditingProduct(null);\n            setNewProductName('');\n            setNewProductValue('');\n            setNewProductCost(''); // NOVO: Limpa o campo de custo\n            setNewProductId('');\n        } catch (e) {\n            console.error(\"Erro ao atualizar produto: \", e);\n            showMessage(\"Erro ao atualizar produto.\", \"error\");\n        }\n    };\n\n    const handleDeleteProduct = async (productId) => {\n        console.log(\"Tentando excluir produto com ID:\", productId);\n        console.log(\"Usuário atual para exclusão (currentUser.username):\", currentUser.username);\n        console.log(\"UID do usuário autenticado no Firebase (auth.currentUser?.uid):\", auth.currentUser?.uid); // Log do UID real do Firebase Auth\n        try {\n            // O caminho para exclusão deve corresponder ao caminho usado para buscar/adicionar\n            const docRef = doc(db, `artifacts/${appId}/users/${currentUser.username}/products`, productId);\n            console.log(\"Caminho do documento Firestore para exclusão:\", docRef.path);\n\n            await deleteDoc(docRef);\n            showMessage(\"Produto excluído com sucesso!\");\n        } catch (e) {\n            console.error(\"Erro ao excluir produto:\", e);\n            console.error(\"Código do erro Firestore:\", e.code); // Log do código de erro\n            console.error(\"Mensagem do erro Firestore:\", e.message); // Log da mensagem de erro\n            if (e.code === 'permission-denied') {\n                showMessage(\"Erro de permissão: Você não tem autorização para excluir este produto. Verifique as regras de segurança do Firestore.\", \"error\");\n            } else {\n                showMessage(\"Erro ao excluir produto.\", \"error\");\n            }\n        }\n    };\n\n    const cancelEdit = () => {\n        setEditingProduct(null);\n        setNewProductName('');\n        setNewProductValue('');\n        setNewProductCost(''); // NOVO: Limpa o campo de custo\n        setNewProductId('');\n    };\n\n    // Calculate weekly sales report\n    const getWeeklySales = () => {\n        const oneWeekAgo = new Date();\n        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);\n\n        const weeklySales = sales.filter(sale => {\n            const saleDate = sale.timestamp.toDate(); // Convert Firestore Timestamp to Date object\n            return saleDate >= oneWeekAgo;\n        });\n\n        const salesByDay = {};\n        weeklySales.forEach(sale => {\n            const saleDate = sale.timestamp.toDate().toLocaleDateString('pt-BR');\n            // NOVO: Soma o lucro em vez do total\n            if (!salesByDay[saleDate]) {\n                salesByDay[saleDate] = 0;\n            }\n            salesByDay[saleDate] += sale.profit || (sale.total - (sale.costOfGoodsSold || 0)); // Garante que o lucro seja calculado se não estiver salvo\n        });\n\n        // Sort by date for display\n        const sortedSales = Object.entries(salesByDay).sort(([dateA], [dateB]) => {\n            const [dayA, monthA, yearA] = dateA.split('/').map(Number);\n            const [dayB, monthB, yearB] = dateB.split('/').map(Number);\n            const dateObjA = new Date(yearA, monthA - 1, dayA);\n            const dateObjB = new Date(yearB, monthB - 1, dayB);\n            return dateObjA - dateObjB;\n        });\n\n        return sortedSales;\n    };\n\n    // --- Funções de Autenticação com o Backend Flask ---\n    const handleLogin = async (e) => {\n        e.preventDefault();\n        try {\n            const response = await fetch(`${FLASK_BACKEND_URL}/login`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ username: loginUsername, password: loginPassword }),\n            });\n\n            const data = await response.json();\n            console.log(\"Dados recebidos do backend:\", data);\n\n            if (response.ok) {\n                const firebaseToken = data.firebase_token;\n                if (firebaseToken) {\n                    try {\n                        await signInWithCustomToken(auth, firebaseToken);\n                        showMessage(`Login bem-sucedido! Bem-vindo, ${data.username}.`, 'success');\n                        setIsLoggedIn(true);\n                        // Armazena os dados de design no currentUser\n                        setCurrentUser({\n                            username: data.username,\n                            role: data.role,\n                            company_name: data.company_name,\n                            design: data.design // Armazena o objeto de design completo\n                        });\n                        setLoginPassword('');\n                        // Redireciona para a aba apropriada após o login\n                        if (data.role === 'admin') {\n                            setActiveTab('gerenciar_empresas');\n                        } else {\n                            setActiveTab('caixa');\n                        }\n                    } catch (firebaseError) {\n                        console.error(\"Erro ao autenticar no Firebase com token personalizado:\", firebaseError);\n                        showMessage(`Erro ao conectar ao Firebase: ${firebaseError.message}`, 'error');\n                        setIsLoggedIn(false);\n                        setCurrentUser(null);\n                    }\n                } else {\n                    showMessage(\"Erro: Token Firebase não recebido do backend.\", \"error\");\n                    console.error(\"Firebase token missing in Flask response. Full data:\", data);\n                }\n            } else {\n                showMessage(`Erro de login: ${data.error || 'Credenciais inválidas'}`, 'error');\n            }\n        } catch (error) {\n            console.error('Erro ao conectar ao backend para login:', error);\n            showMessage('Erro ao conectar ao servidor. Verifique se o backend está rodando.', 'error');\n        }\n    };\n\n    const handleLogout = async () => {\n        // Resetar estados que controlam os listeners ANTES de deslogar do Firebase Auth\n        setIsLoggedIn(false);\n        setCurrentUser(null);\n        setLoginUsername('');\n        setLoginPassword('');\n        setCart([]);\n        setProducts([]);\n        setSales([]);\n        setCompanies([]);\n        setCompanyUsers([]); // Limpa usuários da empresa no logout\n\n        try {\n            await auth.signOut(); // Desloga do Firebase Auth\n            showMessage(\"Você foi desconectado.\", \"info\");\n            setActiveTab('caixa'); // Volta para a aba padrão após logout\n        } catch (error) {\n            console.error(\"Erro ao deslogar do Firebase:\", error);\n            showMessage(\"Erro ao desconectar.\", \"error\");\n        }\n    };\n\n    // --- Funções de Gerenciamento de Empresas (para o admin principal) ---\n    const handleRegisterCompany = async (e) => {\n        e.preventDefault();\n        if (!newCompanyUsername || !newCompanyPassword || !newCompanyName) {\n            showMessage(\"Preencha todos os campos para registrar a empresa!\", \"error\");\n            return;\n        }\n\n        try {\n            const response = await fetch(`${FLASK_BACKEND_URL}/register_company`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    username: newCompanyUsername,\n                    password: newCompanyPassword,\n                    company_name: newCompanyName,\n                    design_theme: newCompanyDesignTheme,\n                    mercado_pago_access_token: newCompanyMercadoPagoAccessToken,\n                }),\n            });\n\n            const data = await response.json();\n\n            if (response.ok) {\n                showMessage(`Empresa \"${data.company_name}\" (Usuário: ${data.username}) registrada com sucesso!`, 'success');\n                setNewCompanyUsername('');\n                setNewCompanyPassword('');\n                setNewCompanyName('');\n                setNewCompanyDesignTheme('default');\n                setNewCompanyMercadoPagoAccessToken(''); // Limpa o campo após o registro\n            } else {\n                showMessage(`Erro ao registrar empresa: ${data.error || 'Erro desconhecido'}`, \"error\");\n            }\n        } catch (error) {\n            console.error('Erro ao conectar ao backend para registrar empresa:', error);\n            showMessage('Erro ao conectar ao servidor para registrar empresa.', 'error');\n        }\n    };\n\n    // Função para excluir uma empresa (login)\n    const handleDeleteCompany = async (companyId) => {\n        if (!window.confirm(`Tem certeza que deseja excluir a empresa ${companyId} e TODOS os seus dados (produtos, vendas, etc.)? Esta ação é irreversível!`)) {\n            return;\n        }\n\n        try {\n            const idToken = await auth.currentUser.getIdToken(); // Obtém o ID Token do usuário logado (admin)\n            const response = await fetch(`${FLASK_BACKEND_URL}/delete_company`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${idToken}` // Envia o ID Token para autenticação no backend\n                },\n                body: JSON.stringify({ company_username: companyId }),\n            });\n\n            const data = await response.json();\n\n            if (response.ok) {\n                showMessage(`Empresa \"${companyId}\" excluída com sucesso!`, 'success');\n            } else {\n                showMessage(`Erro ao excluir empresa: ${data.error || 'Erro desconhecido'}`, \"error\");\n            }\n        } catch (error) {\n            console.error('Erro ao conectar ao backend para excluir empresa:', error);\n            showMessage('Erro ao conectar ao servidor para excluir empresa.', 'error');\n        }\n    };\n\n    // --- Funções de Gerenciamento de Usuários da Empresa (para company_admin) ---\n    const handleAddCompanyUser = async (e) => {\n        e.preventDefault();\n        if (!newCompanyUserUsername || !newCompanyUserPassword || !newCompanyUserRole) {\n            showMessage(\"Preencha todos os campos para adicionar o usuário!\", \"error\");\n            return;\n        }\n        if (!currentUser || !currentUser.username) {\n            showMessage(\"Erro: Administrador da empresa não identificado.\", \"error\");\n            return;\n        }\n\n        try {\n            const idToken = await auth.currentUser.getIdToken(); // Obtém o ID Token do company_admin logado\n            const response = await fetch(`${FLASK_BACKEND_URL}/company_users/add`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${idToken}` // Envia o ID Token para autenticação no backend\n                },\n                body: JSON.stringify({\n                    company_id: currentUser.username, // ID da empresa do admin logado\n                    username: newCompanyUserUsername,\n                    password: newCompanyUserPassword,\n                    role: newCompanyUserRole\n                }),\n            });\n\n            const data = await response.json();\n\n            if (response.ok) {\n                showMessage(`Usuário \"${data.username}\" (${data.role}) adicionado com sucesso!`, 'success');\n                setNewCompanyUserUsername('');\n                setNewCompanyUserPassword('');\n                setNewCompanyUserRole('caixa');\n            } else {\n                showMessage(`Erro ao adicionar usuário: ${data.error || 'Erro desconhecido'}`, \"error\");\n            }\n        } catch (e) {\n            console.error(\"Erro ao adicionar usuário da empresa: \", e);\n            showMessage(\"Erro ao conectar ao servidor para adicionar usuário.\", \"error\");\n        }\n    };\n\n    const handleEditCompanyUser = (user) => {\n        setEditingCompanyUser(user);\n        setNewCompanyUserUsername(user.username);\n        setNewCompanyUserRole(user.role);\n        // Não carregamos a senha para edição por segurança\n        setNewCompanyUserPassword('');\n    };\n\n    const handleUpdateCompanyUser = async (e) => {\n        e.preventDefault();\n        if (!editingCompanyUser || !newCompanyUserUsername || !newCompanyUserRole) {\n            showMessage(\"Preencha todos os campos para atualizar o usuário!\", \"error\");\n            return;\n        }\n        if (!currentUser || !currentUser.username) {\n            showMessage(\"Erro: Administrador da empresa não identificado.\", \"error\");\n            return;\n        }\n\n        try {\n            const idToken = await auth.currentUser.getIdToken(); // Obtém o ID Token do company_admin logado\n            const response = await fetch(`${FLASK_BACKEND_URL}/company_users/update`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${idToken}`\n                },\n                body: JSON.stringify({\n                    company_id: currentUser.username,\n                    user_id: editingCompanyUser.id, // O ID do documento do usuário no Firestore (que é o firebase_uid)\n                    username: newCompanyUserUsername,\n                    password: newCompanyUserPassword || null, // Envia null se a senha não for alterada\n                    role: newCompanyUserRole\n                }),\n            });\n\n            const data = await response.json();\n\n            if (response.ok) {\n                showMessage(`Usuário \"${data.username}\" atualizado com sucesso!`, 'success');\n                setEditingCompanyUser(null);\n                setNewCompanyUserUsername('');\n                setNewCompanyUserPassword('');\n                setNewCompanyUserRole('caixa');\n            } else {\n                showMessage(`Erro ao atualizar usuário: ${data.error || 'Erro desconhecido'}`, \"error\");\n            }\n        } catch (e) {\n            console.error(\"Erro ao atualizar usuário da empresa: \", e);\n            showMessage(\"Erro ao conectar ao servidor para atualizar usuário.\", \"error\");\n        }\n    };\n\n    const handleDeleteCompanyUser = async (userId) => {\n        if (!window.confirm(`Tem certeza que deseja excluir o usuário ${userId}? Esta ação é irreversível!`)) {\n            return;\n        }\n        if (!currentUser || !currentUser.username) {\n            showMessage(\"Erro: Administrador da empresa não identificado.\", \"error\");\n            return;\n        }\n\n        console.log(\"Tentando excluir usuário da empresa com ID:\", userId); // NOVO LOG\n\n        try {\n            const idToken = await auth.currentUser.getIdToken(); // Obtém o ID Token do company_admin logado\n            const response = await fetch(`${FLASK_BACKEND_URL}/company_users/delete`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization': `Bearer ${idToken}`\n                },\n                body: JSON.stringify({\n                    company_id: currentUser.username,\n                    user_id: userId // O ID do documento do usuário no Firestore (que é o firebase_uid)\n                }),\n            });\n\n            const data = await response.json();\n\n            if (response.ok) {\n                showMessage(`Usuário \"${userId}\" excluído com sucesso!`, 'success');\n            } else {\n                showMessage(`Erro ao excluir usuário: ${data.error || 'Erro desconhecido'}`, \"error\");\n            }\n        } catch (e) {\n            console.error(\"Erro ao excluir usuário da empresa:\", e);\n            showMessage(\"Erro ao conectar ao servidor para excluir usuário.\", \"error\");\n        }\n    };\n\n    const cancelEditCompanyUser = () => {\n        setEditingCompanyUser(null);\n        setNewCompanyUserUsername('');\n        setNewCompanyUserPassword('');\n        setNewCompanyUserRole('caixa');\n    };\n\n\n    // Função para copiar a chave Pix para a área de transferência\n    const copyPixKeyToClipboard = (key) => {\n        // Usa document.execCommand('copy') por compatibilidade em iframes\n        const el = document.createElement('textarea');\n        el.value = key;\n        document.body.appendChild(el);\n        el.select();\n        try {\n            document.execCommand('copy');\n            showMessage(\"Chave Pix copiada!\", \"success\");\n        } catch (err) {\n            console.error('Erro ao copiar a chave Pix:', err);\n            showMessage(\"Falha ao copiar a chave Pix.\", \"error\");\n        }\n        document.body.removeChild(el);\n    };\n\n    // Filtrar produtos com base no termo de pesquisa\n    const filteredProducts = products.filter(product =>\n        product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n        product.id.toLowerCase().includes(searchTerm.toLowerCase())\n    );\n\n\n    // Renderiza a tela de login se o usuário não estiver logado\n    if (!isLoggedIn) {\n        return (\n            <div className=\"relative min-h-screen flex flex-col items-center justify-center overflow-hidden bg-gray-800\"> {/* Adicionado bg-gray-800 como fallback */}\n                {/* Video de Fundo para a tela de login */}\n                <video\n                    autoPlay\n                    loop\n                    muted\n                    playsInline\n                    className=\"absolute z-0 w-full h-full object-cover\"\n                    src=\"https://videos.pexels.com/video-files/3752548/3752548-hd_1920_1080_24fps.mp4\" // URL do vídeo para a tela de login\n                    onError={(e) => console.error(\"Erro ao carregar o vídeo de fundo da tela de login:\", e)}\n                >\n                    Seu navegador não suporta a tag de vídeo.\n                </video>\n\n                {/* Overlay para legibilidade */}\n                <div className=\"absolute z-10 w-full h-full bg-black opacity-50\"></div>\n\n                {message && (\n                    <div className={`fixed top-4 right-4 p-3 rounded-lg shadow-lg text-white z-50 transition-opacity duration-300 ${message.type === 'success' ? 'bg-green-500' : 'bg-red-500'}`}>\n                        {message.text}\n                    </div>\n                )}\n                <div className=\"relative z-20 bg-white p-8 rounded-2xl shadow-xl w-full max-w-md\">\n                    <h2 className=\"text-3xl font-bold text-gray-800 mb-6 text-center\">\n                        Login\n                    </h2>\n                    <form onSubmit={handleLogin}>\n                        <div className=\"mb-4\">\n                            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"loginUsername\">\n                                Nome de Usuário:\n                            </label>\n                            <input\n                                className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline\"\n                                id=\"loginUsername\"\n                                type=\"text\"\n                                placeholder=\"Nome de Usuário\"\n                                value={loginUsername}\n                                onChange={(e) => setLoginUsername(e.target.value)}\n                                required\n                            />\n                        </div>\n                        <div className=\"mb-6\">\n                            <label className=\"block text-gray-700 text-sm font-bold mb-2\" htmlFor=\"loginPassword\">\n                                Senha:\n                            </label>\n                            <input\n                                className=\"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline\"\n                                id=\"loginPassword\"\n                                type=\"password\"\n                                placeholder=\"********\"\n                                value={loginPassword}\n                                onChange={(e) => setLoginPassword(e.target.value)}\n                                required\n                            />\n                        </div>\n                        <div className=\"flex items-center justify-center\">\n                            <button\n                                className=\"bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline transition-colors duration-200\"\n                                type=\"submit\"\n                            >\n                                Login\n                            </button>\n                        </div>\n                    </form>\n                </div>\n            </div>\n        );\n    }\n\n    // Renderiza o aplicativo principal se o usuário estiver logado\n    const currentDesign = currentUser?.design || {}; // Garante que currentDesign não é nulo\n\n    // Determina se o vídeo de fundo da aba \"Gerenciar Empresas\" deve ser ativo\n    const showCompanyManagementVideo = isLoggedIn && activeTab === 'gerenciar_empresas' && currentUser?.role === 'admin';\n\n    // Define o estilo de fundo dinamicamente (cores/gradiente)\n    const backgroundClasses = currentDesign.dominant_color\n        ? `${currentDesign.dominant_color}` // Usa a cor dominante se definida\n        : `${currentDesign.gradient_from || 'from-blue-50'} ${currentDesign.gradient_to || 'to-indigo-100'}`; // Volta para o gradiente se não houver cor dominante\n\n    return (\n        <div\n            className={`min-h-screen p-4 ${currentDesign.font_family || 'font-sans'} flex flex-col items-center relative`}\n        >\n            {/* Vídeo de Fundo Condicional para a aba \"Gerenciar Empresas\" */}\n            {showCompanyManagementVideo && (\n                <>\n                    <video\n                        autoPlay\n                        loop\n                        muted\n                        playsInline\n                        className=\"absolute z-0 w-full h-full object-cover top-0 left-0\"\n                        src=\"https://videos.pexels.com/video-files/30163656/12934691_1920_1080_30fps.mp4\" // URL do vídeo para a aba de gerenciamento de empresas\n                        onError={(e) => console.error(\"Erro ao carregar o vídeo de fundo da Gerenciar Empresas:\", e)}\n                    >\n                        Seu navegador não suporta a tag de vídeo para o fundo de gerenciamento de empresas.\n                    </video>\n                    {/* Overlay para legibilidade sobre o vídeo de fundo */}\n                    <div className=\"absolute z-10 w-full h-full bg-black opacity-50 top-0 left-0\"></div>\n                </>\n            )}\n\n            {/* Fundo de cor/gradiente condicional para outras abas */}\n            {!showCompanyManagementVideo && (\n                <div className={`absolute z-0 w-full h-full top-0 left-0 ${backgroundClasses}`}></div>\n            )}\n\n            {/* Todo o conteúdo da aplicação com um z-index maior para ficar acima do fundo */}\n            <div className=\"relative z-20 w-full flex flex-col items-center\">\n                {/* User ID Display */}\n                {currentUser && (\n                    <div className=\"absolute top-4 left-4 bg-white p-2 rounded-lg shadow-md text-sm text-gray-700\">\n                        Usuário Logado: <span className=\"font-semibold\">{currentUser.username}</span> (Função: {currentUser.role})\n                        {currentUser.company_name && (\n                            <span className=\"ml-2\">Empresa: {currentUser.company_name}</span>\n                        )}\n                        <button\n                            onClick={handleLogout}\n                            className=\"ml-4 bg-red-500 hover:bg-red-600 text-white text-xs px-2 py-1 rounded-full transition-colors duration-200\"\n                        >\n                            Sair\n                        </button>\n                    </div>\n                )}\n\n                {/* Message Box */}\n                {message && (\n                    <div className={`fixed top-4 right-4 p-3 rounded-lg shadow-lg text-white z-50 transition-opacity duration-300 ${message.type === 'success' ? currentDesign.success_color : currentDesign.error_color}`}>\n                        {message.text}\n                    </div>\n                )}\n\n                <h1 className={`text-4xl font-extrabold ${currentDesign.text_color_strong || 'text-gray-800'} mb-8 mt-4 rounded-xl p-3 bg-white shadow-lg`}>\n                    Gerenciador de Caixa\n                </h1>\n\n                {/* Navigation Tabs */}\n                <div className=\"flex space-x-4 mb-8 bg-white p-2 rounded-full shadow-md\">\n                    {/* Aba Caixa - Visível para company_admin, gerente, caixa */}\n                    {(currentUser.role === 'company_admin' || currentUser.role === 'gerente' || currentUser.role === 'caixa') && (\n                        <button\n                            onClick={() => setActiveTab('caixa')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'caixa' ? `${currentDesign.primary_button_bg} text-white shadow-lg` : `${currentDesign.secondary_button_bg} ${currentDesign.secondary_button_text} ${currentDesign.secondary_button_hover_bg}`}`}\n                        >\n                            Caixa\n                        </button>\n                    )}\n                    {/* Aba Produtos - Visível para company_admin e gerente */}\n                    {(currentUser.role === 'company_admin' || currentUser.role === 'gerente') && (\n                        <button\n                            onClick={() => setActiveTab('produtos')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'produtos' ? `${currentDesign.primary_button_bg} text-white shadow-lg` : `${currentDesign.secondary_button_bg} ${currentDesign.secondary_button_text} ${currentDesign.secondary_button_hover_bg}`}`}\n                        >\n                            Produtos\n                        </button>\n                    )}\n                    {/* Aba Relatórios - Visível para company_admin e gerente */}\n                    {(currentUser.role === 'company_admin' || currentUser.role === 'gerente') && (\n                        <button\n                            onClick={() => setActiveTab('relatorios')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'relatorios' ? `${currentDesign.primary_button_bg} text-white shadow-lg` : `${currentDesign.secondary_button_bg} ${currentDesign.secondary_button_text} ${currentDesign.secondary_button_hover_bg}`}`}\n                        >\n                            Relatórios\n                        </button>\n                    )}\n                    {/* Aba Gerenciar Usuários - Visível APENAS para company_admin */}\n                    {currentUser.role === 'company_admin' && (\n                        <button\n                            onClick={() => setActiveTab('gerenciar_usuarios')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'gerenciar_usuarios' ? `${currentDesign.primary_button_bg} text-white shadow-lg` : `${currentDesign.secondary_button_bg} ${currentDesign.secondary_button_text} ${currentDesign.secondary_button_hover_bg}`}`}\n                        >\n                            Gerenciar Usuários\n                        </button>\n                    )}\n                    {/* Aba Gerenciar Empresas - Visível APENAS para admin principal */}\n                    {currentUser.role === 'admin' && (\n                        <button\n                            onClick={() => setActiveTab('gerenciar_empresas')}\n                            className={`px-6 py-3 rounded-full text-lg font-medium transition-all duration-300 ${activeTab === 'gerenciar_empresas' ? `${currentDesign.primary_button_bg} text-white shadow-lg` : `${currentDesign.secondary_button_bg} ${currentDesign.secondary_button_text} ${currentDesign.secondary_button_hover_bg}`}`}\n                        >\n                            Gerenciar Empresas\n                        </button>\n                    )}\n                </div>\n\n                {/* Caixa Tab Content (Visível para company_admin, gerente, caixa) */}\n                {(activeTab === 'caixa' && (currentUser.role === 'company_admin' || currentUser.role === 'gerente' || currentUser.role === 'caixa')) && (\n                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8 w-full max-w-7xl\">\n                        {/* Products List */}\n                        <div className=\"lg:col-span-1 bg-white p-6 rounded-2xl shadow-xl\">\n                            <h2 className={`text-2xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mb-4 pb-2 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                                Produtos Disponíveis\n                            </h2>\n                            {/* Barra de Pesquisa */}\n                            <div className=\"mb-4\">\n                                <input\n                                    type=\"text\"\n                                    placeholder=\"Pesquisar produto por nome ou ID...\"\n                                    value={searchTerm}\n                                    onChange={(e) => setSearchTerm(e.target.value)}\n                                    className=\"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                            <div className=\"max-h-96 overflow-y-auto\">\n                                {filteredProducts.length === 0 ? (\n                                    <p className=\"text-gray-500\">Nenhum produto encontrado ou cadastrado.</p>\n                                ) : (\n                                    filteredProducts.map(product => (\n                                        <div key={product.id} className=\"flex justify-between items-center bg-gray-50 p-3 mb-2 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${currentDesign.text_color_strong || 'text-gray-800'}`}>{product.name} (ID: {product.id})</p>\n                                                <p className={`${currentDesign.highlight_color || 'text-blue-600'} font-bold`}>R$ {product.value.toFixed(2)}</p>\n                                            </div>\n                                            <button\n                                                onClick={() => addToCart(product)}\n                                                className={`bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md`}\n                                            >\n                                                Adicionar\n                                            </button>\n                                        </div>\n                                    ))\n                                )}\n                            </div>\n                        </div>\n\n                        {/* Cart and Payment */}\n                        <div className=\"lg:col-span-2 bg-white p-6 rounded-2xl shadow-xl flex flex-col\">\n                            <h2 className={`text-2xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mb-4 pb-2 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                                Carrinho de Compras\n                            </h2>\n                            <div className=\"flex-grow max-h-80 overflow-y-auto mb-4\">\n                                {cart.length === 0 ? (\n                                    <p className=\"text-gray-500\">Carrinho vazio.</p>\n                                ) : (\n                                    cart.map(item => (\n                                        <div key={item.id} className=\"flex justify-between items-center bg-gray-50 p-3 mb-2 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${currentDesign.text_color_strong || 'text-gray-800'}`}>{item.name}</p>\n                                                <p className=\"text-gray-600\">R$ {item.value.toFixed(2)} x {item.quantity}</p>\n                                            </div>\n                                            <div className=\"flex items-center space-x-2\">\n                                                <button\n                                                    onClick={() => decreaseQuantity(item.id)}\n                                                    className=\"bg-red-400 hover:bg-red-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold\"\n                                                >\n                                                    -\n                                                </button>\n                                                <span className=\"font-bold text-lg\">{item.quantity}</span>\n                                                <button\n                                                    onClick={() => increaseQuantity(item.id)}\n                                                    className=\"bg-green-400 hover:bg-green-500 text-white w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold\"\n                                                >\n                                                    +\n                                                </button>\n                                                <button\n                                                    onClick={() => removeFromCart(item.id)}\n                                                    className=\"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-full text-sm shadow-md\"\n                                                >\n                                                    Remover\n                                                </button>\n                                            </div>\n                                        </div>\n                                    ))\n                                )}\n                            </div>\n\n                            <div className={`mt-auto pt-4 border-t-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                                <div className={`flex justify-between items-center text-2xl font-bold ${currentDesign.text_color_strong || 'text-gray-800'} mb-4`}>\n                                    <span>Total:</span>\n                                    <span>R$ {total.toFixed(2)}</span>\n                                </div>\n\n                                <div className=\"mb-4\">\n                                    <label htmlFor=\"paymentMethod\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} text-lg font-semibold mb-2`}>Método de Pagamento:</label>\n                                    <select\n                                        id=\"paymentMethod\"\n                                        value={paymentMethod}\n                                        onChange={(e) => {\n                                            setPaymentMethod(e.target.value);\n                                            setPixQrCodeData(null); // Limpa os dados do Pix ao mudar o método\n                                        }}\n                                        className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg\"\n                                    >\n                                        <option value=\"Dinheiro\">Dinheiro</option>\n                                        <option value=\"Cartao\">Cartão de Crédito/Débito</option>\n                                        <option value=\"Pix\">Pix</option>\n                                    </select>\n                                </div>\n\n                                {paymentMethod === 'Dinheiro' && (\n                                    <div className=\"mb-4\">\n                                        <label htmlFor=\"paymentAmount\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} text-lg font-semibold mb-2`}>Valor Pago:</label>\n                                        <input\n                                            type=\"number\"\n                                            id=\"paymentAmount\"\n                                            value={paymentAmount}\n                                            onChange={(e) => setPaymentAmount(e.target.value)}\n                                            placeholder=\"R$ 0.00\"\n                                            step=\"0.01\"\n                                            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500 text-lg\"\n                                        />\n                                    </div>\n                                )}\n\n                                {paymentMethod === 'Pix' && (\n                                    <div className=\"mb-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200 text-yellow-800\">\n                                        <p className=\"font-semibold\">Funcionalidade Pix:</p>\n                                        <p className=\"text-sm\">\n                                            Para gerar o QR Code Pix, o aplicativo fará uma requisição ao seu backend Flask.\n                                        </p>\n                                        {isLoadingPix ? (\n                                            <div className=\"flex justify-center items-center py-4\">\n                                                <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-500\"></div>\n                                                <p className=\"ml-3\">Gerando QR Code...</p>\n                                            </div>\n                                        ) : pixQrCodeData ? (\n                                            <div className=\"mt-3 text-center\">\n                                                {/* Imagem do QR Code (usando base64 do backend) */}\n                                                <img\n                                                    src={pixQrCodeData.qr_code_base64 || `https://placehold.co/150x150/E0F2F7/000000?text=QR+Code+Pix`}\n                                                    alt=\"QR Code Pix\"\n                                                    className=\"mx-auto rounded-lg shadow-md w-64 h-64\"\n                                                />\n                                                <p className=\"mt-2 text-sm text-gray-700\">\n                                                    Chave \"copia e cola\":\n                                                </p>\n                                                <div className=\"flex items-center justify-center mt-1\">\n                                                    <input\n                                                        type=\"text\"\n                                                        readOnly\n                                                        value={pixQrCodeData.copy_paste_key}\n                                                        className=\"flex-grow p-2 border border-gray-300 rounded-l-lg text-sm bg-gray-100\"\n                                                    />\n                                                    <button\n                                                        onClick={() => copyPixKeyToClipboard(pixQrCodeData.copy_paste_key)}\n                                                        className=\"bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-r-lg text-sm\"\n                                                    >\n                                                        Copiar\n                                                    </button>\n                                                </div>\n                                                <p className=\"mt-2 text-xs text-gray-600\">\n                                                    * Em um cenário real, a venda seria finalizada após a confirmação do pagamento Pix via webhook.\n                                                </p>\n                                            </div>\n                                        ) : (\n                                            <div className=\"mt-3 text-center\">\n                                                {/* Placeholder para o QR Code antes de gerar */}\n                                                <img\n                                                    src=\"https://placehold.co/150x150/E0F2F7/000000?text=QR+Code+Pix\"\n                                                    alt=\"Placeholder QR Code Pix\"\n                                                    className=\"mx-auto rounded-lg shadow-md w-64 h-64\"\n                                                />\n                                                <p className=\"mt-2 text-xs text-gray-600\">\n                                                    Clique em \"Finalizar Venda\" para gerar o QR Code.\n                                                </p>\n                                            </div>\n                                        )}\n                                    </div>\n                                )}\n\n                                <div className={`flex justify-between items-center text-xl ${currentDesign.text_color_medium || 'text-gray-700'} mb-2`}>\n                                    <span>Diferença:</span>\n                                    <span className=\"font-bold text-red-600\">R$ {difference.toFixed(2)}</span>\n                                </div>\n                                <div className={`flex justify-between items-center text-xl ${currentDesign.text_color_medium || 'text-gray-700'} mb-4`}>\n                                    <span>Troco:</span>\n                                    <span className=\"font-bold text-green-600\">R$ {change.toFixed(2)}</span>\n                                </div>\n\n                                <button\n                                    onClick={finalizeSale}\n                                    className={`w-full ${currentDesign.primary_button_bg || 'bg-blue-600'} ${currentDesign.primary_button_hover_bg || 'hover:bg-blue-700'} text-white text-xl font-bold py-4 rounded-xl transition-all duration-300 shadow-lg transform hover:scale-105`}\n                                >\n                                    Finalizar Venda\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                )}\n\n                {/* Products Tab Content (Visível para company_admin e gerente) */}\n                {(activeTab === 'produtos' && (currentUser.role === 'company_admin' || currentUser.role === 'gerente')) && (\n                    <div className=\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\">\n                        <h2 className={`text-3xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mb-6 pb-3 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                            {editingProduct ? 'Editar Produto' : 'Adicionar Novo Produto'}\n                        </h2>\n                        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n                            <div>\n                                <label htmlFor=\"newProductId\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>ID do Produto:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newProductId\"\n                                    value={newProductId}\n                                    onChange={(e) => setNewProductId(e.target.value)}\n                                    placeholder=\"Ex: PROD001\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    disabled={!!editingProduct} // Disable ID input when editing\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newProductName\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Nome do Produto:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newProductName\"\n                                    value={newProductName}\n                                    onChange={(e) => setNewProductName(e.target.value)}\n                                    placeholder=\"Ex: Refrigerante Lata\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newProductValue\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Valor (R$):</label>\n                                <input\n                                    type=\"number\"\n                                    id=\"newProductValue\"\n                                    value={newProductValue}\n                                    onChange={(e) => setNewProductValue(e.target.value)}\n                                    placeholder=\"Ex: 5.50\"\n                                    step=\"0.01\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                            {/* Campo para o Custo do Produto */}\n                            <div>\n                                <label htmlFor=\"newProductCost\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Custo (R$):</label>\n                                <input\n                                    type=\"number\"\n                                    id=\"newProductCost\"\n                                    value={newProductCost}\n                                    onChange={(e) => setNewProductCost(e.target.value)}\n                                    placeholder=\"Ex: 2.00\"\n                                    step=\"0.01\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                        </div>\n                        <div className=\"flex justify-end space-x-4\">\n                            {editingProduct ? (\n                                <>\n                                    <button\n                                        onClick={handleUpdateProduct}\n                                        className={`bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                    >\n                                        Atualizar Produto\n                                    </button>\n                                    <button\n                                        onClick={cancelEdit}\n                                        className={`bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                    >\n                                        Cancelar\n                                    </button>\n                                </>\n                            ) : (\n                                <button\n                                    onClick={handleAddProduct}\n                                    className={`${currentDesign.primary_button_bg || 'bg-blue-600'} ${currentDesign.primary_button_hover_bg || 'hover:bg-blue-700'} text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                >\n                                    Adicionar Produto\n                                </button>\n                            )}\n                        </div>\n\n                        <h3 className={`text-2xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mt-10 mb-4 pb-2 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                            Lista de Produtos\n                        </h3>\n                        <div className=\"max-h-96 overflow-y-auto\">\n                            {products.length === 0 ? (\n                                <p className=\"text-gray-500\">Nenhum produto cadastrado.</p>\n                            ) : (\n                                <ul className=\"space-y-3\">\n                                    {products.map(product => (\n                                        <li key={product.id} className=\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${currentDesign.text_color_strong || 'text-gray-800'} text-lg`}>Produto: {product.name} (ID: {product.id})</p>\n                                                <p className={`${currentDesign.highlight_color || 'text-blue-600'} font-bold text-xl`}>R$ {product.value.toFixed(2)}</p>\n                                                <p className=\"text-gray-600 text-sm\">Custo: R$ {product.cost ? product.cost.toFixed(2) : '0.00'}</p>\n                                            </div>\n                                            <div className=\"flex space-x-3\">\n                                                <button\n                                                    onClick={() => handleEditProduct(product)}\n                                                    className=\"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Editar\n                                                </button>\n                                                <button\n                                                    onClick={() => handleDeleteProduct(product.id)}\n                                                    className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Excluir\n                                                </button>\n                                            </div>\n                                        </li>\n                                    ))}\n                                </ul>\n                            )}\n                        </div>\n                    </div>\n                )}\n\n                {/* Reports Tab Content (Visível para company_admin e gerente) */}\n                {(activeTab === 'relatorios' && (currentUser.role === 'company_admin' || currentUser.role === 'gerente')) && (\n                    <div className=\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\">\n                        <h2 className={`text-3xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mb-6 pb-3 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                            Relatório de Lucro Semanal\n                        </h2>\n                        {sales.length === 0 ? (\n                            <p className=\"text-gray-500\">Nenhuma venda registrada ainda.</p>\n                        ) : (\n                            <div className=\"max-h-96 overflow-y-auto\">\n                                <table className=\"min-w-full bg-white rounded-lg overflow-hidden shadow-md\">\n                                    <thead className={`${currentDesign.primary_button_bg || 'bg-blue-500'} text-white`}>\n                                        <tr>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Data</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Lucro Total</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody className=\"divide-y divide-gray-200\">\n                                        {getWeeklySales().map(([date, profit]) => (\n                                            <tr key={date} className=\"hover:bg-gray-50\">\n                                                <td className={`py-3 px-4 ${currentDesign.text_color_strong || 'text-gray-800'}`}>\n                                                    {date}\n                                                </td>\n                                                <td className=\"py-3 px-4 text-green-600 font-bold\">R$ {profit.toFixed(2)}</td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                                {getWeeklySales().length === 0 && (\n                                    <p className=\"text-gray-500 mt-4\">Nenhuma venda na última semana.</p>\n                                )}\n                            </div>\n                        )}\n\n                        <h3 className={`text-2xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mt-10 mb-4 pb-2 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                            Todas as Vendas\n                        </h3>\n                        {sales.length === 0 ? (\n                            <p className=\"text-gray-500\">Nenhuma venda registrada ainda.</p>\n                        ) : (\n                            <div className=\"max-h-96 overflow-y-auto\">\n                                <table className=\"min-w-full bg-white rounded-lg overflow-hidden shadow-md\">\n                                    <thead className={`${currentDesign.primary_button_bg || 'bg-blue-500'} text-white`}>\n                                        <tr>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Data/Hora</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Itens</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Total</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Custo</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Lucro</th>\n                                            <th className=\"py-3 px-4 text-left text-sm font-semibold uppercase\">Método</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody className=\"divide-y divide-gray-200\">\n                                        {sales.map(sale => (\n                                            <tr key={sale.id} className=\"hover:bg-gray-50\">\n                                                <td className={`py-3 px-4 ${currentDesign.text_color_strong || 'text-gray-800'}`}>\n                                                    {sale.timestamp.toDate().toLocaleString('pt-BR')}\n                                                </td>\n                                                <td className={`py-3 px-4 ${currentDesign.text_color_medium || 'text-gray-700'}`}>\n                                                    {sale.items.map(item => (\n                                                        <p key={item.productId}>{item.name} (x{item.quantity})</p>\n                                                    ))}\n                                                </td>\n                                                <td className=\"py-3 px-4 text-green-600 font-bold\">R$ {sale.total.toFixed(2)}</td>\n                                                <td className=\"py-3 px-4 text-gray-600\">R$ {(sale.costOfGoodsSold || 0).toFixed(2)}</td>\n                                                <td className=\"py-3 px-4 text-purple-600 font-bold\">R$ {(sale.profit || (sale.total - (sale.costOfGoodsSold || 0))).toFixed(2)}</td>\n                                                <td className={`py-3 px-4 ${currentDesign.text_color_medium || 'text-gray-700'}`}>{sale.paymentMethod}</td>\n                                            </tr>\n                                        ))}\n                                    </tbody>\n                                </table>\n                            </div>\n                        )}\n                    </div>\n                )}\n\n                {/* Gerenciar Usuários Tab Content (Visível APENAS para company_admin) */}\n                {activeTab === 'gerenciar_usuarios' && currentUser.role === 'company_admin' && (\n                    <div className=\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\">\n                        <h2 className={`text-3xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mb-6 pb-3 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                            {editingCompanyUser ? 'Editar Usuário da Empresa' : 'Adicionar Novo Usuário da Empresa'}\n                        </h2>\n                        <form onSubmit={editingCompanyUser ? handleUpdateCompanyUser : handleAddCompanyUser} className=\"space-y-4 mb-8\">\n                            <div>\n                                <label htmlFor=\"newCompanyUserUsername\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Nome de Usuário:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newCompanyUserUsername\"\n                                    value={newCompanyUserUsername}\n                                    onChange={(e) => setNewCompanyUserUsername(e.target.value)}\n                                    placeholder=\"Ex: caixa01\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                    disabled={!!editingCompanyUser} // Desabilita edição do username\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyUserPassword\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Senha:</label>\n                                <input\n                                    type=\"password\"\n                                    id=\"newCompanyUserPassword\"\n                                    value={newCompanyUserPassword}\n                                    onChange={(e) => setNewCompanyUserPassword(e.target.value)}\n                                    placeholder={editingCompanyUser ? \"Deixe em branco para manter a senha atual\" : \"********\"}\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required={!editingCompanyUser} // Senha é obrigatória apenas ao adicionar\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyUserRole\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Função:</label>\n                                <select\n                                    id=\"newCompanyUserRole\"\n                                    value={newCompanyUserRole}\n                                    onChange={(e) => setNewCompanyUserRole(e.target.value)}\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                >\n                                    <option value=\"caixa\">Caixa</option>\n                                    <option value=\"gerente\">Gerente</option>\n                                    {/* O company_admin não pode criar outro company_admin */}\n                                </select>\n                            </div>\n                            <div className=\"flex justify-end space-x-4\">\n                                {editingCompanyUser ? (\n                                    <>\n                                        <button\n                                            type=\"submit\"\n                                            className={`bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                        >\n                                            Atualizar Usuário\n                                        </button>\n                                        <button\n                                            type=\"button\"\n                                            onClick={cancelEditCompanyUser}\n                                            className={`bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                        >\n                                            Cancelar\n                                        </button>\n                                    </>\n                                ) : (\n                                    <button\n                                        type=\"submit\"\n                                        className={`${currentDesign.primary_button_bg || 'bg-blue-600'} ${currentDesign.primary_button_hover_bg || 'hover:bg-blue-700'} text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                    >\n                                        Adicionar Usuário\n                                    </button>\n                                )}\n                            </div>\n                        </form>\n\n                        <h3 className={`text-2xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mt-10 mb-4 pb-2 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                            Usuários da Empresa\n                        </h3>\n                        <div className=\"max-h-96 overflow-y-auto\">\n                            {companyUsers.length === 0 ? (\n                                <p className=\"text-gray-500\">Nenhum usuário cadastrado para esta empresa.</p>\n                            ) : (\n                                <ul className=\"space-y-3\">\n                                    {companyUsers.map(user => (\n                                        <li key={user.id} className=\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${currentDesign.text_color_strong || 'text-gray-800'} text-lg`}>Usuário: {user.username}</p>\n                                                <p className=\"text-gray-600 text-sm\">Função: {user.role}</p>\n                                                {/* Opcional: Mostrar o firebase_uid para depuração */}\n                                                {/* <p className=\"text-gray-400 text-xs\">UID: {user.firebase_uid}</p> */}\n                                            </div>\n                                            <div className=\"flex space-x-3\">\n                                                <button\n                                                    onClick={() => handleEditCompanyUser(user)}\n                                                    className=\"bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Editar\n                                                </button>\n                                                <button\n                                                    onClick={() => handleDeleteCompanyUser(user.id)}\n                                                    className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Excluir\n                                                </button>\n                                            </div>\n                                        </li>\n                                    ))}\n                                </ul>\n                            )}\n                        </div>\n                    </div>\n                )}\n\n                {/* Gerenciar Empresas Tab Content (Visível APENAS para admin principal) */}\n                {activeTab === 'gerenciar_empresas' && currentUser.role === 'admin' && (\n                    <div className=\"bg-white p-8 rounded-2xl shadow-xl w-full max-w-4xl\">\n                        <h2 className={`text-3xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mb-6 pb-3 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                            Registrar Nova Empresa\n                        </h2>\n                        <form onSubmit={handleRegisterCompany} className=\"space-y-4 mb-8\">\n                            <div>\n                                <label htmlFor=\"newCompanyUsername\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Nome de Usuário da Empresa (ID):</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newCompanyUsername\"\n                                    value={newCompanyUsername}\n                                    onChange={(e) => setNewCompanyUsername(e.target.value)}\n                                    placeholder=\"Ex: empresa_abc\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyPassword\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Senha da Empresa:</label>\n                                <input\n                                    type=\"password\"\n                                    id=\"newCompanyPassword\"\n                                    value={newCompanyPassword}\n                                    onChange={(e) => setNewCompanyPassword(e.target.value)}\n                                    placeholder=\"********\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyName\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Nome Completo da Empresa:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newCompanyName\"\n                                    value={newCompanyName}\n                                    onChange={(e) => setNewCompanyName(e.target.value)}\n                                    placeholder=\"Ex: ABC Comércio e Serviços Ltda.\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                    required\n                                />\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyDesignTheme\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Tema de Design (Cores/Fontes):</label>\n                                <select\n                                    id=\"newCompanyDesignTheme\"\n                                    value={newCompanyDesignTheme}\n                                    onChange={(e) => setNewCompanyDesignTheme(e.target.value)}\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                >\n                                    <option value=\"default\">Padrão</option>\n                                    <option value=\"corporate\">Corporativo</option>\n                                    <option value=\"vibrant\">Vibrante</option>\n                                </select>\n                            </div>\n                            <div>\n                                <label htmlFor=\"newCompanyMercadoPagoAccessToken\" className={`block ${currentDesign.text_color_medium || 'text-gray-700'} font-semibold mb-2`}>Token de Acesso Mercado Pago:</label>\n                                <input\n                                    type=\"text\"\n                                    id=\"newCompanyMercadoPagoAccessToken\"\n                                    value={newCompanyMercadoPagoAccessToken}\n                                    onChange={(e) => setNewCompanyMercadoPagoAccessToken(e.target.value)}\n                                    placeholder=\"Token MP (ex: APP_USR-xxxxxxxxxxxx)\"\n                                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500\"\n                                />\n                            </div>\n                            <div className=\"flex justify-end\">\n                                <button\n                                    type=\"submit\"\n                                    onClick={handleRegisterCompany}\n                                    className={`bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-xl font-bold transition-all duration-300 shadow-md transform hover:scale-105`}\n                                >\n                                    Registrar Empresa\n                                </button>\n                            </div>\n                        </form>\n\n                        <h3 className={`text-2xl font-bold ${currentDesign.text_color_medium || 'text-gray-700'} mt-10 mb-4 pb-2 border-b-2 ${currentDesign.border_color || 'border-blue-200'}`}>\n                            Empresas Registradas\n                        </h3>\n                        <div className=\"max-h-96 overflow-y-auto\">\n                            {companies.length === 0 ? (\n                                <p className=\"text-gray-500\">Nenhuma empresa registrada ainda.</p>\n                            ) : (\n                                <ul className=\"space-y-3\">\n                                    {companies.map(company => (\n                                        <li key={company.id} className=\"flex justify-between items-center bg-gray-50 p-4 rounded-lg shadow-sm\">\n                                            <div>\n                                                <p className={`font-semibold ${currentDesign.text_color_strong || 'text-gray-800'} text-lg`}>Nome: {company.company_name}</p>\n                                                <p className=\"text-gray-600 text-sm\">Usuário (ID): {company.id}</p>\n                                                <p className=\"text-gray-600 text-sm\">Tema: {company.design_theme}</p>\n                                            </div>\n                                            <div className=\"flex space-x-3\">\n                                                <button\n                                                    onClick={() => handleDeleteCompany(company.id)}\n                                                    className=\"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-full transition-colors duration-200 shadow-md\"\n                                                >\n                                                    Excluir Empresa\n                                                </button>\n                                            </div>\n                                        </li>\n                                    ))}\n                                </ul>\n                            )}\n                        </div>\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n};\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}